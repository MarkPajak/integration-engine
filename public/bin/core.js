!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.async=global.async||{})}(this,function(exports){"use strict";function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function overRest$1(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}function identity(value){return value}function rest(func,start){return overRest$1(func,start,identity)}function applyEach$1(eachfn){return rest(function(fns,args){var go=initialParams(function(args,callback){var that=this;return eachfn(fns,function(fn,cb){fn.apply(that,args.concat(cb))},callback)});return args.length?go.apply(this,args):go})}function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag$1]=tag:delete value[symToStringTag$1]),result}function objectToString(value){return nativeObjectToString$1.call(value)}function baseGetTag(value){return null==value?void 0===value?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function noop(){}function once(fn){return function(){if(null!==fn){var callFn=fn;fn=null,callFn.apply(this,arguments)}}}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function isObjectLike(value){return null!=value&&"object"==typeof value}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function stubFalse(){return!1}function isIndex(value,length){return length=null==length?MAX_SAFE_INTEGER$1:length,!!length&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty$1.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}function isPrototype(value){var Ctor=value&&value.constructor,proto="function"==typeof Ctor&&Ctor.prototype||objectProto$5;return value===proto}function overArg(func,transform){return function(arg){return func(transform(arg))}}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty$3.call(object,key)&&"constructor"!=key&&result.push(key);return result}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function createArrayIterator(coll){var i=-1,len=coll.length;return function(){return++i<len?{value:coll[i],key:i}:null}}function createES2015Iterator(iterator){var i=-1;return function(){var item=iterator.next();return item.done?null:(i++,{value:item.value,key:i})}}function createObjectIterator(obj){var okeys=keys(obj),i=-1,len=okeys.length;return function(){var key=okeys[++i];return i<len?{value:obj[key],key:key}:null}}function iterator(coll){if(isArrayLike(coll))return createArrayIterator(coll);var iterator=getIterator(coll);return iterator?createES2015Iterator(iterator):createObjectIterator(coll)}function onlyOnce(fn){return function(){if(null===fn)throw new Error("Callback was already called.");var callFn=fn;fn=null,callFn.apply(this,arguments)}}function _eachOfLimit(limit){return function(obj,iteratee,callback){function iterateeCallback(err,value){if(running-=1,err)done=!0,callback(err);else{if(value===breakLoop||done&&running<=0)return done=!0,callback(null);replenish()}}function replenish(){for(;running<limit&&!done;){var elem=nextElem();if(null===elem)return done=!0,void(running<=0&&callback(null));running+=1,iteratee(elem.value,elem.key,onlyOnce(iterateeCallback))}}if(callback=once(callback||noop),limit<=0||!obj)return callback(null);var nextElem=iterator(obj),done=!1,running=0;replenish()}}function eachOfLimit(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,iteratee,callback)}function doLimit(fn,limit){return function(iterable,iteratee,callback){return fn(iterable,limit,iteratee,callback)}}function eachOfArrayLike(coll,iteratee,callback){function iteratorCallback(err,value){err?callback(err):++completed!==length&&value!==breakLoop||callback(null)}callback=once(callback||noop);var index=0,completed=0,length=coll.length;for(0===length&&callback(null);index<length;index++)iteratee(coll[index],index,onlyOnce(iteratorCallback))}function doParallel(fn){return function(obj,iteratee,callback){return fn(eachOf,obj,iteratee,callback)}}function _asyncMap(eachfn,arr,iteratee,callback){callback=callback||noop,arr=arr||[];var results=[],counter=0;eachfn(arr,function(value,_,callback){var index=counter++;iteratee(value,function(err,v){results[index]=v,callback(err)})},function(err){callback(err,results)})}function doParallelLimit(fn){return function(obj,limit,iteratee,callback){return fn(_eachOfLimit(limit),obj,iteratee,callback)}}function asyncify(func){return initialParams(function(args,callback){var result;try{result=func.apply(this,args)}catch(e){return callback(e)}isObject(result)&&"function"==typeof result.then?result.then(function(value){callback(null,value)},function(err){callback(err.message?err:new Error(err))}):callback(null,result)})}function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIsNaN(value){return value!==value}function strictIndexOf(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),end=end>length?length:end,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function castSlice(array,start,end){var length=array.length;return end=void 0===end?length:end,!start&&end>=length?array:baseSlice(array,start,end)}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function asciiToArray(string){return string.split("")}function hasUnicode(string){return reHasUnicode.test(string)}function unicodeToArray(string){return string.match(reUnicode)||[]}function stringToArray(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string)}function toString(value){return null==value?"":baseToString(value)}function trim(string,chars,guard){if(string=toString(string),string&&(guard||void 0===chars))return string.replace(reTrim,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars),start=charsStartIndex(strSymbols,chrSymbols),end=charsEndIndex(strSymbols,chrSymbols)+1;return castSlice(strSymbols,start,end).join("")}function parseParams(func){return func=func.toString().replace(STRIP_COMMENTS,""),func=func.match(FN_ARGS)[2].replace(" ",""),func=func?func.split(FN_ARG_SPLIT):[],func=func.map(function(arg){return trim(arg.replace(FN_ARG,""))})}function autoInject(tasks,callback){var newTasks={};baseForOwn(tasks,function(taskFn,key){function newTask(results,taskCb){var newArgs=arrayMap(params,function(name){return results[name]});newArgs.push(taskCb),taskFn.apply(null,newArgs)}var params;if(isArray(taskFn))params=taskFn.slice(0,-1),taskFn=taskFn[taskFn.length-1],newTasks[key]=params.concat(params.length>0?newTask:taskFn);else if(1===taskFn.length)newTasks[key]=taskFn;else{if(params=parseParams(taskFn),0===taskFn.length&&0===params.length)throw new Error("autoInject task functions require explicit parameters.");params.pop(),newTasks[key]=params.concat(newTask)}}),auto(newTasks,callback)}function fallback(fn){setTimeout(fn,0)}function wrap(defer){return rest(function(fn,args){defer(function(){fn.apply(null,args)})})}function DLL(){this.head=this.tail=null,this.length=0}function setInitial(dll,node){dll.length=1,dll.head=dll.tail=node}function queue(worker,concurrency,payload){function _insert(data,insertAtFront,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,isArray(data)||(data=[data]),0===data.length&&q.idle())return setImmediate$1(function(){q.drain()});for(var i=0,l=data.length;i<l;i++){var item={data:data[i],callback:callback||noop};insertAtFront?q._tasks.unshift(item):q._tasks.push(item)}setImmediate$1(q.process)}function _next(tasks){return rest(function(args){workers-=1;for(var i=0,l=tasks.length;i<l;i++){var task=tasks[i],index=baseIndexOf(workersList,task,0);index>=0&&workersList.splice(index),task.callback.apply(task,args),null!=args[0]&&q.error(args[0],task.data)}workers<=q.concurrency-q.buffer&&q.unsaturated(),q.idle()&&q.drain(),q.process()})}if(null==concurrency)concurrency=1;else if(0===concurrency)throw new Error("Concurrency must not be zero");var workers=0,workersList=[],isProcessing=!1,q={_tasks:new DLL,concurrency:concurrency,payload:payload,saturated:noop,unsaturated:noop,buffer:concurrency/4,empty:noop,drain:noop,error:noop,started:!1,paused:!1,push:function(data,callback){_insert(data,!1,callback)},kill:function(){q.drain=noop,q._tasks.empty()},unshift:function(data,callback){_insert(data,!0,callback)},process:function(){if(!isProcessing){for(isProcessing=!0;!q.paused&&workers<q.concurrency&&q._tasks.length;){var tasks=[],data=[],l=q._tasks.length;q.payload&&(l=Math.min(l,q.payload));for(var i=0;i<l;i++){var node=q._tasks.shift();tasks.push(node),data.push(node.data)}0===q._tasks.length&&q.empty(),workers+=1,workersList.push(tasks[0]),workers===q.concurrency&&q.saturated();var cb=onlyOnce(_next(tasks));worker(data,cb)}isProcessing=!1}},length:function(){return q._tasks.length},running:function(){return workers},workersList:function(){return workersList},idle:function(){return q._tasks.length+workers===0},pause:function(){q.paused=!0},resume:function(){q.paused!==!1&&(q.paused=!1,setImmediate$1(q.process))}};return q}function cargo(worker,payload){return queue(worker,1,payload)}function reduce(coll,memo,iteratee,callback){callback=once(callback||noop),eachOfSeries(coll,function(x,i,callback){iteratee(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})}function concat$1(eachfn,arr,fn,callback){var result=[];eachfn(arr,function(x,index,cb){fn(x,function(err,y){result=result.concat(y||[]),cb(err)})},function(err){callback(err,result)})}function doSeries(fn){return function(obj,iteratee,callback){return fn(eachOfSeries,obj,iteratee,callback)}}function _createTester(check,getResult){return function(eachfn,arr,iteratee,cb){cb=cb||noop;var testResult,testPassed=!1;eachfn(arr,function(value,_,callback){iteratee(value,function(err,result){err?callback(err):check(result)&&!testResult?(testPassed=!0,testResult=getResult(!0,value),callback(null,breakLoop)):callback()})},function(err){err?cb(err):cb(null,testPassed?testResult:getResult(!1))})}}function _findGetResult(v,x){return x}function consoleFunc(name){return rest(function(fn,args){fn.apply(null,args.concat(rest(function(err,args){"object"==typeof console&&(err?console.error&&console.error(err):console[name]&&arrayEach(args,function(x){console[name](x)}))})))})}function doDuring(fn,test,callback){function check(err,truth){return err?callback(err):truth?void fn(next):callback(null)}callback=onlyOnce(callback||noop);var next=rest(function(err,args){return err?callback(err):(args.push(check),void test.apply(this,args))});check(null,!0)}function doWhilst(iteratee,test,callback){callback=onlyOnce(callback||noop);var next=rest(function(err,args){return err?callback(err):test.apply(this,args)?iteratee(next):void callback.apply(null,[null].concat(args))});iteratee(next)}function doUntil(fn,test,callback){doWhilst(fn,function(){return!test.apply(this,arguments)},callback)}function during(test,fn,callback){function next(err){return err?callback(err):void test(check)}function check(err,truth){return err?callback(err):truth?void fn(next):callback(null)}callback=onlyOnce(callback||noop),test(check)}function _withoutIndex(iteratee){return function(value,index,callback){return iteratee(value,callback)}}function eachLimit(coll,iteratee,callback){eachOf(coll,_withoutIndex(iteratee),callback)}function eachLimit$1(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,_withoutIndex(iteratee),callback)}function ensureAsync(fn){return initialParams(function(args,callback){var sync=!0;args.push(function(){var innerArgs=arguments;sync?setImmediate$1(function(){callback.apply(null,innerArgs)}):callback.apply(null,innerArgs)}),fn.apply(this,args),sync=!1})}function notId(v){return!v}function baseProperty(key){return function(object){return null==object?void 0:object[key]}}function filterArray(eachfn,arr,iteratee,callback){var truthValues=new Array(arr.length);eachfn(arr,function(x,index,callback){iteratee(x,function(err,v){truthValues[index]=!!v,callback(err)})},function(err){if(err)return callback(err);for(var results=[],i=0;i<arr.length;i++)truthValues[i]&&results.push(arr[i]);callback(null,results)})}function filterGeneric(eachfn,coll,iteratee,callback){var results=[];eachfn(coll,function(x,index,callback){iteratee(x,function(err,v){err?callback(err):(v&&results.push({index:index,value:x}),callback())})},function(err){err?callback(err):callback(null,arrayMap(results.sort(function(a,b){return a.index-b.index}),baseProperty("value")))})}function _filter(eachfn,coll,iteratee,callback){var filter=isArrayLike(coll)?filterArray:filterGeneric;filter(eachfn,coll,iteratee,callback||noop)}function forever(fn,errback){function next(err){return err?done(err):void task(next)}var done=onlyOnce(errback||noop),task=ensureAsync(fn);next()}function mapValuesLimit(obj,limit,iteratee,callback){callback=once(callback||noop);var newObj={};eachOfLimit(obj,limit,function(val,key,next){iteratee(val,key,function(err,result){return err?next(err):(newObj[key]=result,void next())})},function(err){callback(err,newObj)})}function has(obj,key){return key in obj}function memoize(fn,hasher){var memo=Object.create(null),queues=Object.create(null);hasher=hasher||identity;var memoized=initialParams(function(args,callback){var key=hasher.apply(null,args);has(memo,key)?setImmediate$1(function(){callback.apply(null,memo[key])}):has(queues,key)?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat(rest(function(args){memo[key]=args;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++)q[i].apply(null,args)}))))});return memoized.memo=memo,memoized.unmemoized=fn,memoized}function _parallel(eachfn,tasks,callback){callback=callback||noop;var results=isArrayLike(tasks)?[]:{};eachfn(tasks,function(task,key,callback){task(rest(function(err,args){args.length<=1&&(args=args[0]),results[key]=args,callback(err)}))},function(err){callback(err,results)})}function parallelLimit(tasks,callback){_parallel(eachOf,tasks,callback)}function parallelLimit$1(tasks,limit,callback){_parallel(_eachOfLimit(limit),tasks,callback)}function race(tasks,callback){if(callback=once(callback||noop),!isArray(tasks))return callback(new TypeError("First argument to race must be an array of functions"));if(!tasks.length)return callback();for(var i=0,l=tasks.length;i<l;i++)tasks[i](callback)}function reduceRight(array,memo,iteratee,callback){var reversed=slice.call(array).reverse();reduce(reversed,memo,iteratee,callback)}function reflect(fn){return initialParams(function(args,reflectCallback){return args.push(rest(function(err,cbArgs){if(err)reflectCallback(null,{error:err});else{var value=null;1===cbArgs.length?value=cbArgs[0]:cbArgs.length>1&&(value=cbArgs),reflectCallback(null,{value:value})}})),fn.apply(this,args)})}function reject$1(eachfn,arr,iteratee,callback){_filter(eachfn,arr,function(value,cb){iteratee(value,function(err,v){cb(err,!v)})},callback)}function reflectAll(tasks){var results;return isArray(tasks)?results=arrayMap(tasks,reflect):(results={},baseForOwn(tasks,function(task,key){results[key]=reflect.call(this,task)})),results}function constant$1(value){return function(){return value}}function retry(opts,task,callback){function parseTimes(acc,t){if("object"==typeof t)acc.times=+t.times||DEFAULT_TIMES,acc.intervalFunc="function"==typeof t.interval?t.interval:constant$1(+t.interval||DEFAULT_INTERVAL),acc.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");acc.times=+t||DEFAULT_TIMES}}function retryAttempt(){task(function(err){err&&attempt++<options.times&&("function"!=typeof options.errorFilter||options.errorFilter(err))?setTimeout(retryAttempt,options.intervalFunc(attempt)):callback.apply(null,arguments)})}var DEFAULT_TIMES=5,DEFAULT_INTERVAL=0,options={times:DEFAULT_TIMES,intervalFunc:constant$1(DEFAULT_INTERVAL)};if(arguments.length<3&&"function"==typeof opts?(callback=task||noop,task=opts):(parseTimes(options,opts),callback=callback||noop),"function"!=typeof task)throw new Error("Invalid arguments for async.retry");var attempt=1;retryAttempt()}function series(tasks,callback){_parallel(eachOfSeries,tasks,callback)}function sortBy(coll,iteratee,callback){function comparator(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}map(coll,function(x,callback){iteratee(x,function(err,criteria){return err?callback(err):void callback(null,{value:x,criteria:criteria})})},function(err,results){return err?callback(err):void callback(null,arrayMap(results.sort(comparator),baseProperty("value")))})}function timeout(asyncFn,milliseconds,info){function injectedCallback(){timedOut||(originalCallback.apply(null,arguments),clearTimeout(timer))}function timeoutCallback(){var name=asyncFn.name||"anonymous",error=new Error('Callback function "'+name+'" timed out.');error.code="ETIMEDOUT",info&&(error.info=info),timedOut=!0,originalCallback(error)}var originalCallback,timer,timedOut=!1;return initialParams(function(args,origCallback){originalCallback=origCallback,timer=setTimeout(timeoutCallback,milliseconds),asyncFn.apply(null,args.concat(injectedCallback))})}function baseRange(start,end,step,fromRight){for(var index=-1,length=nativeMax$1(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}function timeLimit(count,limit,iteratee,callback){mapLimit(baseRange(0,count,1),limit,iteratee,callback)}function transform(coll,accumulator,iteratee,callback){3===arguments.length&&(callback=iteratee,iteratee=accumulator,accumulator=isArray(coll)?[]:{}),callback=once(callback||noop),eachOf(coll,function(v,k,cb){iteratee(accumulator,v,k,cb)},function(err){callback(err,accumulator)})}function unmemoize(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}}function whilst(test,iteratee,callback){if(callback=onlyOnce(callback||noop),!test())return callback(null);var next=rest(function(err,args){return err?callback(err):test()?iteratee(next):void callback.apply(null,[null].concat(args))});iteratee(next)}function until(test,fn,callback){whilst(function(){return!test.apply(this,arguments)},fn,callback)}var nativeMax=Math.max,initialParams=function(fn){return rest(function(args){var callback=args.pop();fn.call(this,args,callback)})},freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]",MAX_SAFE_INTEGER=9007199254740991,breakLoop={},iteratorSymbol="function"==typeof Symbol&&Symbol.iterator,getIterator=function(coll){return iteratorSymbol&&coll[iteratorSymbol]&&coll[iteratorSymbol]()},argsTag="[object Arguments]",objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$2.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray,freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,nativeIsBuffer=Buffer?Buffer.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _defer,freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$2=Object.prototype,hasOwnProperty$1=objectProto$2.hasOwnProperty,objectProto$5=Object.prototype,nativeKeys=overArg(Object.keys,Object),objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty,eachOfGeneric=doLimit(eachOfLimit,1/0),eachOf=function(coll,iteratee,callback){var eachOfImplementation=isArrayLike(coll)?eachOfArrayLike:eachOfGeneric;eachOfImplementation(coll,iteratee,callback)},map=doParallel(_asyncMap),applyEach=applyEach$1(map),mapLimit=doParallelLimit(_asyncMap),mapSeries=doLimit(mapLimit,1),applyEachSeries=applyEach$1(mapSeries),apply$2=rest(function(fn,args){return rest(function(callArgs){return fn.apply(null,args.concat(callArgs))})}),baseFor=createBaseFor(),auto=function(tasks,concurrency,callback){function enqueueTask(key,task){readyTasks.push(function(){runTask(key,task)})}function processQueue(){if(0===readyTasks.length&&0===runningTasks)return callback(null,results);for(;readyTasks.length&&runningTasks<concurrency;){var run=readyTasks.shift();run()}}function addListener(taskName,fn){var taskListeners=listeners[taskName];taskListeners||(taskListeners=listeners[taskName]=[]),taskListeners.push(fn)}function taskComplete(taskName){var taskListeners=listeners[taskName]||[];arrayEach(taskListeners,function(fn){fn()}),processQueue()}function runTask(key,task){if(!hasError){var taskCallback=onlyOnce(rest(function(err,args){if(runningTasks--,args.length<=1&&(args=args[0]),err){var safeResults={};baseForOwn(results,function(val,rkey){safeResults[rkey]=val}),safeResults[key]=args,hasError=!0,listeners=Object.create(null),callback(err,safeResults)}else results[key]=args,taskComplete(key)}));runningTasks++;var taskFn=task[task.length-1];task.length>1?taskFn(results,taskCallback):taskFn(taskCallback)}}function checkForDeadlocks(){for(var currentTask,counter=0;readyToCheck.length;)currentTask=readyToCheck.pop(),counter++,arrayEach(getDependents(currentTask),function(dependent){0===--uncheckedDependencies[dependent]&&readyToCheck.push(dependent)});if(counter!==numTasks)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function getDependents(taskName){var result=[];return baseForOwn(tasks,function(task,key){isArray(task)&&baseIndexOf(task,taskName,0)>=0&&result.push(key)}),result}"function"==typeof concurrency&&(callback=concurrency,concurrency=null),callback=once(callback||noop);var keys$$1=keys(tasks),numTasks=keys$$1.length;if(!numTasks)return callback(null);concurrency||(concurrency=numTasks);var results={},runningTasks=0,hasError=!1,listeners=Object.create(null),readyTasks=[],readyToCheck=[],uncheckedDependencies={};baseForOwn(tasks,function(task,key){if(!isArray(task))return enqueueTask(key,[task]),void readyToCheck.push(key);var dependencies=task.slice(0,task.length-1),remainingDependencies=dependencies.length;return 0===remainingDependencies?(enqueueTask(key,task),void readyToCheck.push(key)):(uncheckedDependencies[key]=remainingDependencies,void arrayEach(dependencies,function(dependencyName){if(!tasks[dependencyName])throw new Error("async.auto task `"+key+"` has a non-existent dependency `"+dependencyName+"` in "+dependencies.join(", "));addListener(dependencyName,function(){remainingDependencies--,0===remainingDependencies&&enqueueTask(key,task)})}))}),checkForDeadlocks(),processQueue()},symbolTag="[object Symbol]",INFINITY=1/0,symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0,rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsZWJ="\\u200d",reHasUnicode=RegExp("["+rsZWJ+rsAstralRange+rsComboRange+rsVarRange+"]"),rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange$1+"]",rsCombo="["+rsComboRange$1+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange$1+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange$1+"]?",rsOptJoin="(?:"+rsZWJ$1+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g"),reTrim=/^\s+|\s+$/g,FN_ARGS=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/(=.+)?(\s*)$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,hasSetImmediate="function"==typeof setImmediate&&setImmediate,hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;_defer=hasSetImmediate?setImmediate:hasNextTick?process.nextTick:fallback;var setImmediate$1=wrap(_defer);DLL.prototype.removeLink=function(node){return node.prev?node.prev.next=node.next:this.head=node.next,node.next?node.next.prev=node.prev:this.tail=node.prev,node.prev=node.next=null,this.length-=1,node},DLL.prototype.empty=DLL,DLL.prototype.insertAfter=function(node,newNode){newNode.prev=node,newNode.next=node.next,node.next?node.next.prev=newNode:this.tail=newNode,node.next=newNode,this.length+=1},DLL.prototype.insertBefore=function(node,newNode){
newNode.prev=node.prev,newNode.next=node,node.prev?node.prev.next=newNode:this.head=newNode,node.prev=newNode,this.length+=1},DLL.prototype.unshift=function(node){this.head?this.insertBefore(this.head,node):setInitial(this,node)},DLL.prototype.push=function(node){this.tail?this.insertAfter(this.tail,node):setInitial(this,node)},DLL.prototype.shift=function(){return this.head&&this.removeLink(this.head)},DLL.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var _defer$1,eachOfSeries=doLimit(eachOfLimit,1),seq$1=rest(function(functions){return rest(function(args){var that=this,cb=args[args.length-1];"function"==typeof cb?args.pop():cb=noop,reduce(functions,args,function(newargs,fn,cb){fn.apply(that,newargs.concat(rest(function(err,nextargs){cb(err,nextargs)})))},function(err,results){cb.apply(that,[err].concat(results))})})}),compose=rest(function(args){return seq$1.apply(null,args.reverse())}),concat=doParallel(concat$1),concatSeries=doSeries(concat$1),constant=rest(function(values){var args=[null].concat(values);return initialParams(function(ignoredArgs,callback){return callback.apply(this,args)})}),detect=doParallel(_createTester(identity,_findGetResult)),detectLimit=doParallelLimit(_createTester(identity,_findGetResult)),detectSeries=doLimit(detectLimit,1),dir=consoleFunc("dir"),eachSeries=doLimit(eachLimit$1,1),every=doParallel(_createTester(notId,notId)),everyLimit=doParallelLimit(_createTester(notId,notId)),everySeries=doLimit(everyLimit,1),filter=doParallel(_filter),filterLimit=doParallelLimit(_filter),filterSeries=doLimit(filterLimit,1),log=consoleFunc("log"),mapValues=doLimit(mapValuesLimit,1/0),mapValuesSeries=doLimit(mapValuesLimit,1);_defer$1=hasNextTick?process.nextTick:hasSetImmediate?setImmediate:fallback;var nextTick=wrap(_defer$1),queue$1=function(worker,concurrency){return queue(function(items,cb){worker(items[0],cb)},concurrency,1)},priorityQueue=function(worker,concurrency){var q=queue$1(worker,concurrency);return q.push=function(data,priority,callback){if(null==callback&&(callback=noop),"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,isArray(data)||(data=[data]),0===data.length)return setImmediate$1(function(){q.drain()});priority=priority||0;for(var nextNode=q._tasks.head;nextNode&&priority>=nextNode.priority;)nextNode=nextNode.next;for(var i=0,l=data.length;i<l;i++){var item={data:data[i],priority:priority,callback:callback};nextNode?q._tasks.insertBefore(nextNode,item):q._tasks.push(item)}setImmediate$1(q.process)},delete q.unshift,q},slice=Array.prototype.slice,reject=doParallel(reject$1),rejectLimit=doParallelLimit(reject$1),rejectSeries=doLimit(rejectLimit,1),retryable=function(opts,task){return task||(task=opts,opts=null),initialParams(function(args,callback){function taskFn(cb){task.apply(null,args.concat(cb))}opts?retry(opts,taskFn,callback):retry(taskFn,callback)})},some=doParallel(_createTester(Boolean,identity)),someLimit=doParallelLimit(_createTester(Boolean,identity)),someSeries=doLimit(someLimit,1),nativeCeil=Math.ceil,nativeMax$1=Math.max,times=doLimit(timeLimit,1/0),timesSeries=doLimit(timeLimit,1),waterfall=function(tasks,callback){function nextTask(args){if(taskIndex===tasks.length)return callback.apply(null,[null].concat(args));var taskCallback=onlyOnce(rest(function(err,args){return err?callback.apply(null,[err].concat(args)):void nextTask(args)}));args.push(taskCallback);var task=tasks[taskIndex++];task.apply(null,args)}if(callback=once(callback||noop),!isArray(tasks))return callback(new Error("First argument to waterfall must be an array of functions"));if(!tasks.length)return callback();var taskIndex=0;nextTask([])},index={applyEach:applyEach,applyEachSeries:applyEachSeries,apply:apply$2,asyncify:asyncify,auto:auto,autoInject:autoInject,cargo:cargo,compose:compose,concat:concat,concatSeries:concatSeries,constant:constant,detect:detect,detectLimit:detectLimit,detectSeries:detectSeries,dir:dir,doDuring:doDuring,doUntil:doUntil,doWhilst:doWhilst,during:during,each:eachLimit,eachLimit:eachLimit$1,eachOf:eachOf,eachOfLimit:eachOfLimit,eachOfSeries:eachOfSeries,eachSeries:eachSeries,ensureAsync:ensureAsync,every:every,everyLimit:everyLimit,everySeries:everySeries,filter:filter,filterLimit:filterLimit,filterSeries:filterSeries,forever:forever,log:log,map:map,mapLimit:mapLimit,mapSeries:mapSeries,mapValues:mapValues,mapValuesLimit:mapValuesLimit,mapValuesSeries:mapValuesSeries,memoize:memoize,nextTick:nextTick,parallel:parallelLimit,parallelLimit:parallelLimit$1,priorityQueue:priorityQueue,queue:queue$1,race:race,reduce:reduce,reduceRight:reduceRight,reflect:reflect,reflectAll:reflectAll,reject:reject,rejectLimit:rejectLimit,rejectSeries:rejectSeries,retry:retry,retryable:retryable,seq:seq$1,series:series,setImmediate:setImmediate$1,some:some,someLimit:someLimit,someSeries:someSeries,sortBy:sortBy,timeout:timeout,times:times,timesLimit:timeLimit,timesSeries:timesSeries,transform:transform,unmemoize:unmemoize,until:until,waterfall:waterfall,whilst:whilst,all:every,any:some,forEach:eachLimit,forEachSeries:eachSeries,forEachLimit:eachLimit$1,forEachOf:eachOf,forEachOfSeries:eachOfSeries,forEachOfLimit:eachOfLimit,inject:reduce,foldl:reduce,foldr:reduceRight,select:filter,selectLimit:filterLimit,selectSeries:filterSeries,wrapSync:asyncify};exports["default"]=index,exports.applyEach=applyEach,exports.applyEachSeries=applyEachSeries,exports.apply=apply$2,exports.asyncify=asyncify,exports.auto=auto,exports.autoInject=autoInject,exports.cargo=cargo,exports.compose=compose,exports.concat=concat,exports.concatSeries=concatSeries,exports.constant=constant,exports.detect=detect,exports.detectLimit=detectLimit,exports.detectSeries=detectSeries,exports.dir=dir,exports.doDuring=doDuring,exports.doUntil=doUntil,exports.doWhilst=doWhilst,exports.during=during,exports.each=eachLimit,exports.eachLimit=eachLimit$1,exports.eachOf=eachOf,exports.eachOfLimit=eachOfLimit,exports.eachOfSeries=eachOfSeries,exports.eachSeries=eachSeries,exports.ensureAsync=ensureAsync,exports.every=every,exports.everyLimit=everyLimit,exports.everySeries=everySeries,exports.filter=filter,exports.filterLimit=filterLimit,exports.filterSeries=filterSeries,exports.forever=forever,exports.log=log,exports.map=map,exports.mapLimit=mapLimit,exports.mapSeries=mapSeries,exports.mapValues=mapValues,exports.mapValuesLimit=mapValuesLimit,exports.mapValuesSeries=mapValuesSeries,exports.memoize=memoize,exports.nextTick=nextTick,exports.parallel=parallelLimit,exports.parallelLimit=parallelLimit$1,exports.priorityQueue=priorityQueue,exports.queue=queue$1,exports.race=race,exports.reduce=reduce,exports.reduceRight=reduceRight,exports.reflect=reflect,exports.reflectAll=reflectAll,exports.reject=reject,exports.rejectLimit=rejectLimit,exports.rejectSeries=rejectSeries,exports.retry=retry,exports.retryable=retryable,exports.seq=seq$1,exports.series=series,exports.setImmediate=setImmediate$1,exports.some=some,exports.someLimit=someLimit,exports.someSeries=someSeries,exports.sortBy=sortBy,exports.timeout=timeout,exports.times=times,exports.timesLimit=timeLimit,exports.timesSeries=timesSeries,exports.transform=transform,exports.unmemoize=unmemoize,exports.until=until,exports.waterfall=waterfall,exports.whilst=whilst,exports.all=every,exports.allLimit=everyLimit,exports.allSeries=everySeries,exports.any=some,exports.anyLimit=someLimit,exports.anySeries=someSeries,exports.find=detect,exports.findLimit=detectLimit,exports.findSeries=detectSeries,exports.forEach=eachLimit,exports.forEachSeries=eachSeries,exports.forEachLimit=eachLimit$1,exports.forEachOf=eachOf,exports.forEachOfSeries=eachOfSeries,exports.forEachOfLimit=eachOfLimit,exports.inject=reduce,exports.foldl=reduce,exports.foldr=reduceRight,exports.select=filter,exports.selectLimit=filterLimit,exports.selectSeries=filterSeries,exports.wrapSync=asyncify,Object.defineProperty(exports,"__esModule",{value:!0})})}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/async/dist/async.js","/../../node_modules/async/dist")},{b55mWE:4,buffer:3}],2:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:code<NUMBER?-1:code<NUMBER+10?code-NUMBER+26+26:code<UPPER+26?code-UPPER:code<LOWER+26?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;i<length;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/../../node_modules/gulp-browserify/node_modules/base64-js/lib")},{b55mWE:4,buffer:3}],3:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;if("base64"===encoding&&"string"===type)for(subject=stringtrim(subject);subject.length%4!==0;)subject+="=";var length;if("number"===type)length=coerce(subject);else if("string"===type)length=Buffer.byteLength(subject,encoding);else{if("object"!==type)throw new Error("First argument needs to be a number, array or string.");length=coerce(subject.length)}var buf;Buffer._useTypedArrays?buf=Buffer._augment(new Uint8Array(length)):(buf=this,buf.length=length,buf._isBuffer=!0);var i;if(Buffer._useTypedArrays&&"number"==typeof subject.byteLength)buf._set(subject);else if(isArrayish(subject))for(i=0;i<length;i++)Buffer.isBuffer(subject)?buf[i]=subject.readUInt8(i):buf[i]=subject[i];else if("string"===type)buf.write(subject,0,encoding);else if("number"===type&&!Buffer._useTypedArrays&&!noZero)for(i=0;i<length;i++)buf[i]=0;return buf}function _hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;assert(strLen%2===0,"Invalid hex string"),length>strLen/2&&(length=strLen/2);for(var i=0;i<length;i++){var byte=parseInt(string.substr(2*i,2),16);assert(!isNaN(byte),"Invalid hex string"),buf[offset+i]=byte}return Buffer._charsWritten=2*i,i}function _utf8Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function _asciiWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function _binaryWrite(buf,string,offset,length){return _asciiWrite(buf,string,offset,length)}function _base64Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function _utf16leWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}function _base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function _utf8Slice(buf,start,end){var res="",tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)buf[i]<=127?(res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]),tmp=""):tmp+="%"+buf[i].toString(16);return res+decodeUtf8Char(tmp)}function _asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);return ret}function _binarySlice(buf,start,end){return _asciiSlice(buf,start,end)}function _hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;i++)out+=toHex(buf[i]);return out}function _utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function _readUInt16(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val;return littleEndian?(val=buf[offset],offset+1<len&&(val|=buf[offset+1]<<8)):(val=buf[offset]<<8,offset+1<len&&(val|=buf[offset+1])),val}}function _readUInt32(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val;return littleEndian?(offset+2<len&&(val=buf[offset+2]<<16),offset+1<len&&(val|=buf[offset+1]<<8),val|=buf[offset],offset+3<len&&(val+=buf[offset+3]<<24>>>0)):(offset+1<len&&(val=buf[offset+1]<<16),offset+2<len&&(val|=buf[offset+2]<<8),offset+3<len&&(val|=buf[offset+3]),val+=buf[offset]<<24>>>0),val}}function _readInt16(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val=_readUInt16(buf,offset,littleEndian,!0),neg=32768&val;return neg?(65535-val+1)*-1:val}}function _readInt32(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val=_readUInt32(buf,offset,littleEndian,!0),neg=2147483648&val;return neg?(4294967295-val+1)*-1:val}}function _readFloat(buf,offset,littleEndian,noAssert){return noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(offset+3<buf.length,"Trying to read beyond buffer length")),ieee754.read(buf,offset,littleEndian,23,4)}function _readDouble(buf,offset,littleEndian,noAssert){return noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(offset+7<buf.length,"Trying to read beyond buffer length")),ieee754.read(buf,offset,littleEndian,52,8)}function _writeUInt16(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"trying to write beyond buffer length"),verifuint(value,65535));var len=buf.length;if(!(offset>=len))for(var i=0,j=Math.min(len-offset,2);i<j;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function _writeUInt32(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"trying to write beyond buffer length"),verifuint(value,4294967295));var len=buf.length;if(!(offset>=len))for(var i=0,j=Math.min(len-offset,4);i<j;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function _writeInt16(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to write beyond buffer length"),verifsint(value,32767,-32768));var len=buf.length;offset>=len||(value>=0?_writeUInt16(buf,value,offset,littleEndian,noAssert):_writeUInt16(buf,65535+value+1,offset,littleEndian,noAssert))}function _writeInt32(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to write beyond buffer length"),verifsint(value,2147483647,-2147483648));var len=buf.length;offset>=len||(value>=0?_writeUInt32(buf,value,offset,littleEndian,noAssert):_writeUInt32(buf,4294967295+value+1,offset,littleEndian,noAssert))}function _writeFloat(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to write beyond buffer length"),verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38));var len=buf.length;offset>=len||ieee754.write(buf,value,offset,littleEndian,23,4)}function _writeDouble(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+7<buf.length,"Trying to write beyond buffer length"),verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308));var len=buf.length;offset>=len||ieee754.write(buf,value,offset,littleEndian,52,8)}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function clamp(index,len,defaultValue){return"number"!=typeof index?defaultValue:(index=~~index,index>=len?len:index>=0?index:(index+=len,index>=0?index:0))}function coerce(length){return length=~~Math.ceil(+length),length<0?0:length}function isArray(subject){return(Array.isArray||function(subject){return"[object Array]"===Object.prototype.toString.call(subject)})(subject)}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&"object"==typeof subject&&"number"==typeof subject.length}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(str){for(var byteArray=[],i=0;i<str.length;i++){var b=str.charCodeAt(i);if(b<=127)byteArray.push(str.charCodeAt(i));else{var start=i;b>=55296&&b<=57343&&i++;for(var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%"),j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str){for(var c,hi,lo,byteArray=[],i=0;i<str.length;i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}function verifuint(value,max){assert("number"==typeof value,"cannot write a non-number as a number"),assert(value>=0,"specified a negative value for writing an unsigned value"),assert(value<=max,"value is larger than maximum value for type"),assert(Math.floor(value)===value,"value has a fractional component")}function verifsint(value,max,min){assert("number"==typeof value,"cannot write a non-number as a number"),assert(value<=max,"value larger than maximum allowed value"),assert(value>=min,"value smaller than minimum allowed value"),assert(Math.floor(value)===value,"value has a fractional component")}function verifIEEE754(value,max,min){assert("number"==typeof value,"cannot write a non-number as a number"),assert(value<=max,"value larger than maximum allowed value"),assert(value>=min,"value smaller than minimum allowed value")}function assert(test,message){if(!test)throw new Error(message||"Failed assertion")}var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=Buffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192,Buffer._useTypedArrays=function(){try{var buf=new ArrayBuffer(0),arr=new Uint8Array(buf);return arr.foo=function(){return 42},42===arr.foo()&&"function"==typeof arr.subarray}catch(e){return!1}}(),Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.isBuffer=function(b){return!(null===b||void 0===b||!b._isBuffer)},Buffer.byteLength=function(str,encoding){var ret;switch(str+="",encoding||"utf8"){case"hex":ret=str.length/2;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"ascii":case"binary":case"raw":ret=str.length;break;case"base64":ret=base64ToBytes(str).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=2*str.length;break;default:throw new Error("Unknown encoding")}return ret},Buffer.concat=function(list,totalLength){if(assert(isArray(list),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===list.length)return new Buffer(0);if(1===list.length)return list[0];var i;if("number"!=typeof totalLength)for(totalLength=0,i=0;i<list.length;i++)totalLength+=list[i].length;var buf=new Buffer(totalLength),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}offset=Number(offset)||0;var remaining=this.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining,encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=_hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=_utf8Write(this,string,offset,length);break;case"ascii":ret=_asciiWrite(this,string,offset,length);break;case"binary":ret=_binaryWrite(this,string,offset,length);break;case"base64":ret=_base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leWrite(this,string,offset,length);break;default:throw new Error("Unknown encoding")}return ret},Buffer.prototype.toString=function(encoding,start,end){var self=this;if(encoding=String(encoding||"utf8").toLowerCase(),start=Number(start)||0,end=void 0!==end?Number(end):end=self.length,end===start)return"";var ret;switch(encoding){case"hex":ret=_hexSlice(self,start,end);break;case"utf8":case"utf-8":ret=_utf8Slice(self,start,end);break;case"ascii":ret=_asciiSlice(self,start,end);break;case"binary":ret=_binarySlice(self,start,end);break;case"base64":ret=_base64Slice(self,start,end);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leSlice(self,start,end);break;default:throw new Error("Unknown encoding")}return ret},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(start||(start=0),end||0===end||(end=this.length),target_start||(target_start=0),end!==start&&0!==target.length&&0!==source.length){assert(end>=start,"sourceEnd < sourceStart"),assert(target_start>=0&&target_start<target.length,"targetStart out of bounds"),assert(start>=0&&start<source.length,"sourceStart out of bounds"),assert(end>=0&&end<=source.length,"sourceEnd out of bounds"),end>this.length&&(end=this.length),target.length-target_start<end-start&&(end=target.length-target_start+start);var len=end-start;if(len<100||!Buffer._useTypedArrays)for(var i=0;i<len;i++)target[i+target_start]=this[i+start];else target._set(this.subarray(start,start+len),target_start)}},Buffer.prototype.slice=function(start,end){var len=this.length;if(start=clamp(start,len,0),end=clamp(end,len,len),Buffer._useTypedArrays)return Buffer._augment(this.subarray(start,end));for(var sliceLen=end-start,newBuf=new Buffer(sliceLen,(void 0),(!0)),i=0;i<sliceLen;i++)newBuf[i]=this[i+start];return newBuf},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.readUInt8=function(offset,noAssert){if(noAssert||(assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to read beyond buffer length")),!(offset>=this.length))return this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return _readUInt16(this,offset,!0,noAssert)},Buffer.prototype.readUInt16BE=function(offset,noAssert){return _readUInt16(this,offset,!1,noAssert)},Buffer.prototype.readUInt32LE=function(offset,noAssert){return _readUInt32(this,offset,!0,noAssert)},Buffer.prototype.readUInt32BE=function(offset,noAssert){return _readUInt32(this,offset,!1,noAssert)},Buffer.prototype.readInt8=function(offset,noAssert){if(noAssert||(assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to read beyond buffer length")),!(offset>=this.length)){var neg=128&this[offset];return neg?(255-this[offset]+1)*-1:this[offset]}},Buffer.prototype.readInt16LE=function(offset,noAssert){return _readInt16(this,offset,!0,noAssert)},Buffer.prototype.readInt16BE=function(offset,noAssert){return _readInt16(this,offset,!1,noAssert)},Buffer.prototype.readInt32LE=function(offset,noAssert){return _readInt32(this,offset,!0,noAssert)},Buffer.prototype.readInt32BE=function(offset,noAssert){return _readInt32(this,offset,!1,noAssert)},Buffer.prototype.readFloatLE=function(offset,noAssert){return _readFloat(this,offset,!0,noAssert)},Buffer.prototype.readFloatBE=function(offset,noAssert){return _readFloat(this,offset,!1,noAssert)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return _readDouble(this,offset,!0,noAssert)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return _readDouble(this,offset,!1,noAssert)},Buffer.prototype.writeUInt8=function(value,offset,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"trying to write beyond buffer length"),verifuint(value,255)),offset>=this.length||(this[offset]=value)},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){_writeUInt16(this,value,offset,!0,noAssert)},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){_writeUInt16(this,value,offset,!1,noAssert)},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){_writeUInt32(this,value,offset,!0,noAssert)},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){_writeUInt32(this,value,offset,!1,noAssert)},Buffer.prototype.writeInt8=function(value,offset,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to write beyond buffer length"),verifsint(value,127,-128)),offset>=this.length||(value>=0?this.writeUInt8(value,offset,noAssert):this.writeUInt8(255+value+1,offset,noAssert))},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){_writeInt16(this,value,offset,!0,noAssert)},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){_writeInt16(this,value,offset,!1,noAssert)},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){_writeInt32(this,value,offset,!0,noAssert)},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){_writeInt32(this,value,offset,!1,noAssert)},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){_writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){_writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){_writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){_writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),"string"==typeof value&&(value=value.charCodeAt(0)),assert("number"==typeof value&&!isNaN(value),"value is not a number"),assert(end>=start,"end < start"),end!==start&&0!==this.length){assert(start>=0&&start<this.length,"start out of bounds"),assert(end>=0&&end<=this.length,"end out of bounds");for(var i=start;i<end;i++)this[i]=value}},Buffer.prototype.inspect=function(){for(var out=[],len=this.length,i=0;i<len;i++)if(out[i]=toHex(this[i]),i===exports.INSPECT_MAX_BYTES){out[i+1]="...";break}return"<Buffer "+out.join(" ")+">"},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer._useTypedArrays)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;i<len;i+=1)buf[i]=this[i];return buf.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr._isBuffer=!0,arr._get=arr.get,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,
arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/gulp-browserify/node_modules/buffer/index.js","/../../node_modules/gulp-browserify/node_modules/buffer")},{b55mWE:4,"base64-js":2,buffer:3,ieee754:6}],4:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/gulp-browserify/node_modules/process/browser.js","/../../node_modules/gulp-browserify/node_modules/process")},{b55mWE:4,buffer:3}],5:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",424:"Failed Dependency",429:"Too Many Requests",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not Supported",507:"Insufficient Storage",CONTINUE:100,SWITCHING_PROTOCOLS:101,OK:200,CREATED:201,ACCEPTED:202,NON_AUTHORITATIVE_INFORMATION:203,NO_CONTENT:204,RESET_CONTENT:205,PARTIAL_CONTENT:206,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,USE_PROXY:305,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,REQUEST_ENTITY_TOO_LARGE:413,REQUEST_URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,REQUESTED_RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,UNPROCESSABLE_ENTITY:422,FAILED_DEPENDENCY:424,TOO_MANY_REQUESTS:429,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,INSUFFICIENT_STORAGE:507}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/http-status/lib/index.js","/../../node_modules/http-status/lib")},{b55mWE:4,buffer:3}],6:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/ieee754/index.js","/../../node_modules/ieee754")},{b55mWE:4,buffer:3}],7:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){(function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.5.2";var each=_.each=_.forEach=function(obj,iterator,context){if(null!=obj)if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){if(iterator.call(context,value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)},_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker}),!!result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker}),!!result)};_.contains=_.include=function(obj,target){return null!=obj&&(nativeIndexOf&&obj.indexOf===nativeIndexOf?obj.indexOf(target)!=-1:any(obj,function(value){return value===target}))},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.where=function(obj,attrs,first){return _.isEmpty(attrs)?first?void 0:[]:_[first?"find":"filter"](obj,function(value){for(var key in attrs)if(attrs[key]!==value[key])return!1;return!0})},_.findWhere=function(obj,attrs){return _.where(obj,attrs,!0)},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-(1/0);var result={computed:-(1/0),value:-(1/0)};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return 1/0;var result={computed:1/0,value:1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return arguments.length<2||guard?obj[_.random(obj.length-1)]:_.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,value,context){var result={},iterator=null==value?_.identity:lookupIterator(value);return each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result}};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){iterator=null==iterator?_.identity:lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;low<high;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;i<length;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=isSorted<0?Math.max(0,length+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<length;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(length);idx<length;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:new Date,timeout=null,result=func.apply(context,args)};return function(){var now=new Date;previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this,args=arguments,timestamp=new Date;var later=function(){var last=new Date-timestamp;last<wait?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args)))},callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args)),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return function(){var args=[func];return push.apply(args,arguments),wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=new Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=new Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null!=object){var value=object[property];return _.isFunction(value)?value.call(object):value}},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../node_modules/underscore/underscore.js","/../../node_modules/underscore")},{b55mWE:4,buffer:3}],8:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.votesFormdata=function(){return{templateUrl:"./components/exhibitions/music/votes-form-and-data.html"}},exports.rawVotes=function(){return{controller:"raw_votes_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyVotes=function(){return{controller:"monthly_votes_controller",templateUrl:"./shared/templates/data_table_simple.html"}},exports.votesForm=function(){return{controller:"record_votes_controller",templateUrl:"./components/exhibitions/music/music-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/exhibitions/directive.js","/../components/exhibitions")},{b55mWE:4,buffer:3}],9:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_votes_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Top_40_tally,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-7 col-lg-7 col-sm-7",console.log("controller go"),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),$scope.table_heading="Monthly retail sales",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],$rootScope.canEdit_table=!1,$scope.loading=!0,columnDefs.push({field:"artist",name:"Artist",width:250},{field:"track",name:"Track",width:250},{field:"tally",name:"Votes",width:75,visible:!0},{field:"logger_user_name",name:"Logged by",visible:!1},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),console.log("columnDefs",columnDefs),scope=$scope,$scope.gridOptions={columnDefs:columnDefs,enableFiltering:!1,enableCellEdit:!1,cellEditableCondition:scope.canEdit,enableGridMenu:!1,enableSelectAll:!1,enableRowHeaderSelection:!1,enableRowSelection:!1,enableCellSelection:!1,enableCellEditOnFocus:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit(scope,function(rowEntity,colDef,newValue,oldValue){1!=scope.isloggedin&&alert("you'll need to log in to make these changes");var update=[],key1=colDef.field,obj1={};obj1[key1]=newValue,update.push(obj1);var key2="logger_user_name",obj2={};obj2[key2]=scope.user.username,update.push(obj2);var key3="date_logged",obj3={};obj3[key3]=new Date,update.push(obj3),setupArray=_.extend(obj1,obj2),setupArray=_.extend(setupArray,obj3);var query={id:rowEntity._id};scope.featured_collection.update(query,setupArray,function(err,affected,resp){})})}},$scope.museums=[],$scope.selected_chart_stats=["Net sales"],Top_40_tally.query({exhibition_id:"bristolmusic"},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,$scope.loading=!1,$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/exhibitions/music/monthly-votes-controller.js","/../components/exhibitions/music")},{b55mWE:4,buffer:3}],10:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_votes_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_Bristol_music_top_40,data_table_reload,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,get_table_data,table_security){$scope.table_class="col-md-8 col-lg-8 col-sm-1 full-height",$scope.featured_collection=Raw_Bristol_music_top_40,$rootScope.featured_collection=Raw_Bristol_music_top_40,$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data="__data";var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"artist",name:"artist",resizable:!0,enableFiltering:!0},{field:"track",name:"track",resizable:!0,visible:!0},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yyyy'"},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yyyy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/exhibitions/music/raw-votes-controller.js","/../components/exhibitions/music");
},{b55mWE:4,buffer:3}],11:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_votes_controller=function($scope,$http,$q,$routeParams,$location,$filter,Bristol_music_top_40,data_table_reload,get_table_data,CustomerService,$timeout,$interval,Top_40_tally){function refreshResults($select,artist_or_state){var search=$select.search,list=angular.copy($select.items),FLAG=-1;if(list=list.filter(function(item){return item.id!==FLAG}),search){var userInputItem={id:FLAG,description:search};$select.items=[userInputItem].concat(list),$scope.selected[artist_or_state]=$("#"+artist_or_state).find("span .glyphclose").text(),$select.selected=userInputItem}else $select.items=list}function clear($event,$select){$("#vote-button").hide(),console.log("$select",$select),$event.stopPropagation(),$select.selected=void 0,$select.search=void 0,$select.activate()}var vm=this;vm.name="World",vm.tables=[{id:1,description:"Front"},{id:2,description:"Back"}],vm.drinksList=[{id:1,description:"Cola"},{id:2,description:"Water"}],vm.order={},vm.refreshResults=refreshResults,vm.clear=clear,$scope.hideartistcross=!1,$scope.hidetrackcross=!1,$scope.blankform=$("#visit_form"),$scope.selected=[],$scope.artistfilled=!1,$scope.visitor_groups=[],$scope.countries=[],$scope.allcountries=[],Bristol_music_top_40.query(function(team){countries=[],_.each(team,function(row){country={},country.country=row.artist,country.state=row.track,$scope.allcountries.push(country),countries.indexOf(row.artist)==-1&&(countries.push(country.country),$scope.countries.push(country))}),vm.getCountryStates=function(item,model){$("#heading").hide(),vm.counter++,console.log("getCountryStates"),$scope.artistfilled=!0,$scope.selectedcountry=item.country,$scope.selected.artist=item.country,$scope._states=$filter("filter")($scope.allcountries,{country:item.country}),tracks=[],$scope.states=[],_.each($scope._states,function(row){console.log(row),tracks.indexOf(row.state)==-1&&(tracks.push(row.state),$scope.states.push(row))}),$scope.cities=[]},vm.getStateCities=function(item,model){$("#vote-button").show(),console.log(item,model),$scope.selectedstate=item.state,$scope.selected.track=item.state},vm.removed=function(item,model){vm.lastRemoved={item:item,model:model}}}),$scope.resetform=function(){$("#vote-button").hide(),$("#visit_form").show(),$("#heading").hide(),$("#reset-button").hide()},$scope.onSubmit=function(){function refresh(){(new Date).getTime()-time>=3e5?window.location.reload(!0):setTimeout(refresh,1e4)}function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",Top_40_tally.query({exhibition_id:"bristolmusic"},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows}),$("#vote-button").hide(),$("#heading").show(),$("#visit_form").hide(),$("#reset-button").show(),$scope.selected.artist=void 0,$scope.selected.track=void 0})}if(console.log("artist",$scope.selected.artist),console.log("track",$scope.selected.track),$scope.selected.track){var kpis=new Bristol_music_top_40({artist:artist.innerText.trim()||$scope.selected.artist,exhibition_id:"bristolmusic",track:track.innerText.trim()||$scope.selected.track,date_logged:new Date}),query={};Bristol_music_top_40.query(query,function(visits){console.log("Bristol_music_top_40",visits.length),save(kpis)})}var time=(new Date).getTime();$(document.body).bind("mousemove keypress",function(e){time=(new Date).getTime()}),setTimeout(refresh,1e4)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/exhibitions/music/votes-form-controller.js","/../components/exhibitions/music")},{b55mWE:4,buffer:3}],12:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.rawFeedback=function(){return{controller:"raw_feedback_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawNominate=function(){return{controller:"raw_nominate_controller",templateUrl:"./shared/templates/data_table.html"}},exports.feedbackData=function(){return{templateUrl:"./components/feedback/feedback-data.html"}},exports.nominateData=function(){return{templateUrl:"./components/feedback/nominate-data.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/feedback/directives.js","/../components/feedback")},{b55mWE:4,buffer:3}],13:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_feedback_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_feedback,data_table_reload,get_table_data_nomusem,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_feedback,$rootScope.featured_collection=Raw_feedback,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={type:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"satisfaction",name:"satisfaction",resizable:!0,width:"150"},{field:"description",name:"description",resizable:!0,width:"300"},{field:"kiosk",name:"kiosk",resizable:!0,width:"150"},{field:"date",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/feedback/raw-feedback-controller.js","/../components/feedback")},{b55mWE:4,buffer:3}],14:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_nominate_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_nominate,data_table_reload,get_table_data_nomusem,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_nominate,$rootScope.featured_collection=Raw_nominate,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={type:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"nomination_name",name:"name",resizable:!0,width:"200"},{field:"reason",name:"reason",resizable:!0,width:"450"},{field:"kiosk",name:"kiosk",resizable:!0,width:"150"},{field:"date",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/feedback/raw-nominate-controller.js","/../components/feedback")},{b55mWE:4,buffer:3}],15:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.customersGiftaid=function(){return{controller:"customers_giftaid_controller",templateUrl:"./shared/templates/data_table.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/gift-aid/customers-directive.js","/../components/gift-aid")},{b55mWE:4,buffer:3}],16:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.customers_giftaid_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Customers_giftaid,data_table_reload,get_table_data,grid_ui_settings,table_security){$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.gridOptions=[],$scope.gridOptions.data="__data",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.featured_collection=Customers_giftaid,$rootScope.featured_collection=Customers_giftaid;var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"first_name",name:"first_name",resizable:!0,width:"150"},{field:"last_name",name:"last_name",resizable:!0,width:"150"},{field:"email",resizable:!0,width:"250"},{field:"house",resizable:!0,width:"250"},{field:"post_code",resizable:!0,width:"150"},{field:"note",resizable:!0,width:"250"},{field:"order",resizable:!0,width:"150"},{field:"donation_amount",resizable:!0,width:"250"},{field:"last_order_url",resizable:!0,width:"250"},{field:"last_order_id",resizable:!0,width:"250"},{field:"date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'",width:"150"}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),$scope&&(myScope=$scope);moment().month();filterdate=moment(new Date).subtract({years:1}),filterdate=moment(filterdate)._d,console.log("all dates after",filterdate);var query={};$scope.extraQuery&&_.extend(query,$scope.extraQuery),console.log("query",query),$rootScope.featured_collection.query({},function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){console.log("displaying all data"),$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})}),$rootScope.alldata=function(val){if("month"==val){console.log("show month data");var date=new Date,y=date.getFullYear(),m=date.getMonth(),firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay),array.getData(firstDay,myScope)}else if(val){console.log("show month data",myScope.start);var date=new Date(val),y=date.getFullYear(val),m=date.getMonth(val);console.log("filtering on month",m);var firstDay=new Date(myScope.start);new Date(myScope.end);firstDay=moment(firstDay)._d,array.getData(firstDay,myScope)}else console.log("show all data"),array.getData("",myScope)},$rootScope.dynamic_filter=function(filter_key,filter_value){array.filter_x(filter_key,filter_value,myScope)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/gift-aid/raw-giftaid-controller.js","/../components/gift-aid")},{b55mWE:4,buffer:3}],17:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.iframe_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Team){console.log("controller go"),console.log($route.routes),$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];columnDefs.push({field:"username",resizable:!0},{field:"password",resizable:!0},{field:"email",resizable:!0},{field:"firstName",resizable:!0},{field:"lastName",resizable:!0},{field:"team",resizable:!0},{field:"group",resizable:!0},{field:"trello_doing_id",resizable:!0},{field:"score",resizable:!0},{field:"bonus",resizable:!0},{field:"leave_start",resizable:!0},{field:"leave_taken",resizable:!0},{field:"number_days_leave",resizable:!0}),$scope.gridOptions={columnDefs:columnDefs,enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!0,enableCellEditOnFocus:!0,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){var myArray=[],key=colDef.field,obj={};obj[key]=newValue,myArray.push(obj);var query={id:rowEntity._id};Team.update(query,obj,function(err,affected,resp){})})}},console.log("getData"),Team.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/iframe/iframe-controller.js","/../components/iframe")},{b55mWE:4,buffer:3}],18:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.iFrame=function(){return{controller:"iframe_controller",templateUrl:"./components/iframe/iframe-page.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/iframe/iframe-directive.js","/../components/iframe")},{b55mWE:4,buffer:3}],19:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.boardCtrl=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$location,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team){$scope.team=["Zahid","Tom","Fay","Mark","Darren","Lacey","David"],$scope.chart_title="Leader Board",$scope.labels=$scope.team,$scope.removeTally=function(id){Tallys.remove({id:id})},Tallys.query({},function(team){_.each(team,function(row){})}),trello.auth();_series=[],__series=[],$scope.series=[],_.each($scope.team,function(member){_series[member]=[]});var plot_graph=function(){var _data=[],_series=[];_.each($scope.team,function(member){_series[member]=[]}),Tallys.query({},function(tallys){tallys.sort(function(a,b){return a.date+b.date}),_.each(tallys,function(row){for(var member in _series)_series.hasOwnProperty(member)&&row.name&&row.name.toLowerCase()==member.toLowerCase()&&_series[member].push({x:row.date,y:row.points})})});for(var member in _series)_series.hasOwnProperty(member)&&_data.push(_series[member]);$scope.data=_data};for(var member in _series)_series.hasOwnProperty(member)&&__series.push(member);$scope.series=__series,$scope.datasetOverride=[{yAxisID:"y-axis-1"}],$scope.options={scales:{xAxes:[{type:"time",unit:"day",unitStepSize:1,time:{displayFormats:{day:"MMM DD"}}}],yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}};$scope.loadMoreShots=function(count,display_data){angular.forEach(display_data,function(list,index){get_trello_board.get_data(list).then(function(){count++,display_data.length==count+1&&($scope.listscores(),plot_graph())})})},$scope.loadMoreShots(0,$rootScope.team),setInterval(function(){$scope.loadMoreShots(0,$rootScope.team)},25e4),kiosk_path=$routeParams.kiosk,screensaver="",$scope.start_screen_saver=function(){},$scope.functionThatReturnsStyle=function(){},$scope.changeheadingcolor=function(){},1!=$rootScope.screensaver_on&&console.log("start screensaver"),$scope.lists=[],$scope.listscores=function(){$scope._lists=[],Team.query({},function(team){_.each(team,function(row){list=[],list.title=row.name,list.average=row.penalty,list.age=(10-1/row.penalty*10).toFixed(0),list.tint=row.penalty/100,list.card_count=row.card_count,list.points=row.score,$scope._lists.push(list)}),$scope.lists=$scope._lists})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/dashboard-controller.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],20:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.deadCtrl=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$location,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team,kiosk_activity){$scope.machine_types=[],$scope.changedValue=function(type){$scope.data=[],$scope.series=[],$scope.category=[],$scope.type=type,plot_graph()},$scope.machine_types=["apple","orange","pear","naartjie"],$scope.machine_types_selection=["apple","pear"],$scope.toggleSelection=function(type){var idx=$scope.machine_types_selection.indexOf(type);idx>-1?($scope.machine_types_selection.splice(idx,1),plot_graph()):($scope.machine_types_selection.push(type),plot_graph())},$scope.changedCatValue=function(category){},$scope.categories=[],$scope.category_selection=[],$scope.toggleCatSelection=function(type){var idx=$scope.category_selection.indexOf(type);idx>-1?($scope.category_selection.splice(idx,1),plot_graph()):($scope.category_selection.push(type),$scope.data=[],$scope.series=[],$scope._series=[],plot_graph())},$scope.changedCatValue=function(category){},$scope.data=[],$scope.team=[],$scope.labels=$scope.team,$scope.chart_title="Machine activity";var plot_graph=function(){$scope.data=[],$scope.series=[],$scope._series=[],kiosk_activity.async_all($scope.category_selection).then(function(data){console.log("data",data),$scope.listscores(data.data.off_today),$scope.listslivecores(data.data.on_today)})};plot_graph(),$scope.live_lists=[],$scope.listslivecores=function(list){console.log("list",list),_.each(list,function(row){console.log(row),list=[],list.title=row.kiosk,list.average=row.penalty,list.age=(10-1/row.penalty*10).toFixed(0),list.tint=row.penalty/100,list.card_count=row.card_count,list.points=row.score,$scope.live_lists.push(list)})},$scope.lists=[],$scope.listscores=function(list){console.log("list",list),_.each(list,function(row){list=[],list.title=row.kiosk,list.average=row.penalty,list.age=(10-1/row.penalty*10).toFixed(0),list.tint=row.penalty/100,list.card_count=row.card_count,list.points=row.score,$scope.lists.push(list)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/dead-controller.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],21:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.downtimeCtrl=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$location,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team,kiosk_activity){function satisfact_pie(comments){$scope.kiosks=[];var series_a=[],labels=[];$scope.pie_labels=[],$scope.pie_data=[],$scope.pie_options=[],$scope.datax=[],_.each(comments.data.satisfaction_tally,function(row){$scope.kiosks.indexOf(row.kiosk)==-1&&($scope.kiosks.push(row.kiosk),series_a[row.kiosk]=[],$scope[row.kiosk]=[],labels[row.kiosk]=[]),series_a[row.kiosk].push(Math.round(row.count)),labels[row.kiosk].push(row.satisfaction),console.log(labels)}),_.each($scope.kiosks,function(kiosk,i){$scope.pie_labels[i]=labels[kiosk],$scope.datax[i]=series_a[kiosk],$scope.pie_options[i]={legend:{display:!1},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(tooltipItems,data){var label=data.labels[tooltipItems.index];return label+" "+data.datasets[0].data[tooltipItems.index]}}}}})}console.log("controller load");var REFERENCE=moment();$scope.TODAY=REFERENCE.clone().startOf("day"),$scope.YESTERDAY=REFERENCE.clone().subtract(0,"days").startOf("day"),$scope.A_WEEK_OLD=REFERENCE.clone().subtract(7,"days").startOf("day"),$scope.datePicker=[],$scope.datePicker.date={startDate:$scope.A_WEEK_OLD._d,endDate:$scope.TODAY._d},$scope.machine_types=[],$scope.type="all",$scope.changedValue=function(type){$scope.data=[],$scope.series=[],$scope.category=[],$scope.type=type,plot_graph()},$scope.machinesx=$scope.kiosk=$routeParams.kiosk||["all"],$scope.filterCondition={machine:"neq"},$scope.$watch("type",function(type){$scope.machinesx=["all"],plot_graph("type")}),$scope.$watch("daterangepicker.dates",function(){console.log("daterangepicker"),plot_graph()}),$scope.$watch("machine",function(){plot_graph("machine")}),$scope.machine_types_selection=[],$scope.categories=[],$scope.category_selection=[];var _data=[];$scope.data=[],$scope.day_data=[],$scope.team=[],$scope.labels=$scope.team,$scope.chart_title="Machine activity";var firstTime=!0,plot_graph=function(mode){$scope.data=[],$scope.series=[],$scope.day_series=[],$scope._series=[],$scope.week_day_series=[],mode||($scope.machinesx=[]),$scope.categories=[],kiosk_activity.async_all($scope.categories,$scope.machine_types,$scope.datePicker.date).then(function(data){_.each(data.data.kiosk_list,function(data){("all"==$scope.type||$scope.type==data.type&&"machine"!=mode)&&$scope.machinesx.push(data.kiosk),"all"!=$scope.type&&$scope.type!=data.type||"all"!=$scope.machine&&$scope.machine!=data.kiosk||($scope._series[data.kiosk]=[],$scope.week_day_series[data.kiosk]=[])}),_.each(data.data.machine_types,function(data){1==firstTime&&$scope.machine_types.push(data.machine_type)}),firstTime=!1,$scope.categories=[],_.each(data.data.categories,function(data){$scope.categories.push(data.category)}),_.each(data.data.all,function(row){$scope._series[row.kiosk]&&$scope._series[row.kiosk].push({x:row.date,y:row.count})}),$scope.week_days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],_.each($scope.week_days,function(day_of_week){_.each(data.data.week_day,function(row){!$scope.week_day_series[row.kiosk]||row.kiosk!=$scope.machine&&"all"!=$scope.machine||row.date==day_of_week&&$scope.week_day_series[row.kiosk].push(row.count)})});for(var member in $scope._series)$scope._series.hasOwnProperty(member)&&$scope.series.push(member);for(var member in $scope._series)$scope._series.hasOwnProperty(member)&&$scope.data.push($scope._series[member]);_data=[];for(var member in $scope.week_day_series)$scope.week_day_series.hasOwnProperty(member)&&($scope.day_series.push(member),_data.push($scope.week_day_series[member]));$scope.day_labels=$scope.week_days,$scope.day_data=_data})};$scope.day_onClick=function(points,evt){},$scope.day_datasetOverride=[{yAxisID:"y-axis-1"}],$scope.onClick=function(points,evt){},$scope.datasetOverride=[{yAxisID:"y-axis-1"}],$scope.options={tension:0,bezierCurve:!1,scales:{xAxes:[{type:"time",unit:"hour",unitStepSize:.05,time:{displayFormats:{day:"MMM DD"}}}],yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}};kiosk_path=$routeParams.kiosk,screensaver="",$scope.start_screen_saver=function(){},$scope.functionThatReturnsStyle=function(){},$scope.changeheadingcolor=function(){},1!=$rootScope.screensaver_on,$scope.lists=[],$scope.listscores=function(list){_.each(list,function(row){list=[],list.title=row.kiosk,list.average=row.penalty,list.age=(10-1/row.penalty*10).toFixed(0),list.tint=row.penalty/100,list.card_count=row.card_count,list.points=row.score,$scope.lists.push(list)})},kiosk_activity.comments_all().then(function(data){satisfact_pie(data)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/downtime-controller.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],22:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.kiosk_activity=function($http){return{async_categories:function(){return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/downtime.php")},async_all:function(categories,machine_types,dates){var categories=categories||"",dates=dates||"",machine_types=machine_types||"";return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/all_logs.php?categories="+JSON.stringify(categories)+"&machine_types="+JSON.stringify(machine_types)+"&dates="+JSON.stringify(dates))},comments_all:function(){return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/all_comments.php")}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/downtime-services.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],23:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.feedbackCtrl=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$location,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team,feedback){function overall_satisfact_pie(comments){$scope.kiosks=[],$scope.kiosks.push("OVERALL SATISFACTION"),$scope.machine="OVERALL SATISFACTION",$scope.series_a=[],$scope.labels=[],$scope.series_a["OVERALL SATISFACTION"]=[],$scope.labels["OVERALL SATISFACTION"]=[],$scope.satisfaction_tally=0,$scope.satisfaction_count=0,_.each(comments.data.overall_satisfaction,function(row){$scope.satisfaction_tally+=Math.round(row.count),$scope.series_a["OVERALL SATISFACTION"].push(Math.round(row.count)),$scope.labels["OVERALL SATISFACTION"].push(row.satisfaction),satisfied.indexOf(row.satisfaction)!=-1&&($scope.satisfaction_count+=Math.round(row.count)),$scope.pie_labels.push($scope.labels["OVERALL SATISFACTION"]),$scope.pie_data.push($scope.series_a["OVERALL SATISFACTION"])}),$scope.percentage=Math.round($scope.satisfaction_count/$scope.satisfaction_tally*100)}function satisfact_pie(comments){$scope.kiosks=[],$scope.series_a=[],$scope.labels=[],$scope.pie_labels=[],$scope.pie_data=[],$scope.pie_options=[],$scope.datax=[],$scope.satisfaction_count=0,$scope.satisfaction_tally=0,_.each(comments.data.satisfaction_tally,function(row){$scope.kiosks.indexOf(row.kiosk)==-1&&$scope.selected.indexOf(row.kiosk)!=-1&&($scope.kiosks.push(row.kiosk),console.log("cats"),$scope.series_a[row.kiosk]=[],$scope[row.kiosk]=[],$scope.labels[row.kiosk]=[]),$scope.selected.indexOf(row.kiosk)!=-1&&($scope.series_a[row.kiosk].push(Math.round(row.count)),$scope.labels[row.kiosk].push(row.satisfaction),satisfied.indexOf(row.satisfaction)!=-1&&($scope.satisfaction_count+=Math.round(row.count)),$scope.satisfaction_tally+=Math.round(row.count),$scope.percentage=Math.round($scope.satisfaction_count/$scope.satisfaction_tally*100))}),_.each($scope.kiosks,function(kiosk,i){$scope.machine=kiosk,$scope.pie_labels[i]=$scope.labels[kiosk],$scope.pie_data[i]=$scope.series_a[kiosk],$scope.pie_options[i]={legend:{display:!0},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(tooltipItems,data){var label=data.labels[tooltipItems.index];return label+" "+data.datasets[0].data[tooltipItems.index]}}}}})}var REFERENCE=moment();$scope.TODAY=REFERENCE.clone().startOf("day"),$scope.YESTERDAY=REFERENCE.clone().subtract(1,"days").startOf("day"),$scope.A_WEEK_OLD=REFERENCE.clone().subtract(2,"days").startOf("day"),$scope.datePicker=[],$scope.datePicker.date={startDate:$scope.A_WEEK_OLD._d,endDate:$scope.TODAY._d},$scope.machine_types=[],$scope.type="INTERPRETATION-KIOSK",$scope.feedback=[],$scope.changedValue=function(type){$scope.data=[],$scope.series=[],$scope.category=[],$scope.type=type,plot_graph()},$scope.selected="all",$scope.changeMachine=function(machine){$scope.feedback=[],$scope.data=[],$scope.series=[],$scope.category=[],$scope.selected=machine,plot_graph(machine)},$scope.machinesx=["all"],$scope.filterCondition={machine:"neq"},$scope.$watch("type",function(type){$scope.machinesx=["all"]}),$scope.$watch("datePicker",function(){plot_graph()}),$scope.machine_types_selection=[],$scope.categories=[],$scope.category_selection=[];$scope.data=[],$scope.day_data=[],$scope.team=[],$scope.labels=$scope.team,$scope.chart_title="KIOSK FEEDBACK";var firstTime=!0;$scope.satisfaction_count=0,satisfied=[],satisfied.push("satisfied"),satisfied.push("very satisfied");var plot_graph=function(mode){$scope.data=[],$scope.series=[],$scope.day_series=[],$scope._series=[],$scope.week_day_series=[],mode||($scope.machinesx=[]),$scope.categories=[],feedback.feedback($scope.categories,$scope.datePicker.date).then(function(data){$scope.machinesx.push("OVERALL SATISFACTION"),_.each(data.data.kiosk_list,function(data){"INTERPRETATION-KIOSK"==$scope.type&&1==firstTime&&(mode="OVERALL SATISFACTION",$scope.machinesx.push(data.kiosk))}),firstTime=!1,_.each(data.data.all,function(data){""!=data.description&&data.kiosk==$scope.selected&&($scope.feedback.push(data),console.log(data.description))}),satisfact_pie(data),"OVERALL SATISFACTION"==mode&&overall_satisfact_pie(data)})};$scope.day_onClick=function(points,evt){},$scope.day_datasetOverride=[{yAxisID:"y-axis-1"}],$scope.onClick=function(points,evt){},$scope.datasetOverride=[{yAxisID:"y-axis-1"}],$scope.options={tension:0,bezierCurve:!1,scales:{xAxes:[{type:"time",unit:"hour",unitStepSize:.05,time:{displayFormats:{day:"MMM DD"}}}],yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}};kiosk_path=$routeParams.kiosk,screensaver="",$scope.start_screen_saver=function(){},$scope.functionThatReturnsStyle=function(){},$scope.changeheadingcolor=function(){},1!=$rootScope.screensaver_on,$scope.lists=[],$scope.listscores=function(list){_.each(list,function(row){list=[],list.title=row.kiosk,list.average=row.penalty,list.age=(10-1/row.penalty*10).toFixed(0),list.tint=row.penalty/100,list.card_count=row.card_count,list.points=row.score,$scope.lists.push(list)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/feedback-controller.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],24:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.feedback=function($http){return{async_categories:function(){return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/downtime.php")},async_all:function(categories,dates){var categories=categories||"",dates=dates||"",machine_types=machine_types||"";return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/all_logs.php?categories="+JSON.stringify(categories)+"&machine_types="+JSON.stringify(machine_types)+"&dates="+JSON.stringify(dates))},feedback:function(categories,machine_types,dates){return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/all_comments.php")},comments_all:function(){return $http.get("http://www.markpajak.co.uk/mark/kiosk-feedback/all_comments.php")}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/feedback-services.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],25:[function(require,module,exports){
(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.satisfaction=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$location,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team,feedback){feedback.feedback($scope.categories,$scope.datePicker.date).then(function(data){_.each(data.data.satisfaction_tally,function(data){console.log(data)})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/machine-monitor/satisfaction-controller.js","/../components/machine-monitor")},{b55mWE:4,buffer:3}],26:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.member_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,date_calc,Tallys,Team,Timeline,$mdEditDialog,Leave,delete_leave_by_id){$scope.me=$routeParams.member,$me_Data=[],Leave.query({},function(team){_.each(team,function(row,index){})}),Team.query({},function(team){_.each(team,function(team,i){function sortByKey(array,key){return array.sort(function(a,b){var x=a[key],y=b[key];return x<y?-1:x>y?1:0})}team.username.toLowerCase()==$scope.me.toLowerCase()&&(console.log(team),number_days_leave_taken=0,team.leave_taken=sortByKey(team.leave_taken,"leave_start"),_.each(team.leave_taken,function(leave,w){var leave_count=0;"Full Day"==leave._type&&(leave_count=1),"Half Day"==leave._type&&(leave_count=.5),leave.start_date>=team.leave_start&&leave.end_date<=team.leave_year_end?(number_days_leave_taken+=leave.weekday_duration*leave_count,team.leave_taken[w].tally=(team.number_days_leave-number_days_leave_taken)*leave_count):(console.log(leave.start_date>=team.leave_start),console.log("leave.start_date"+leave.start_date),console.log("row.leave_start"+team.leave_start),console.log(leave.end_date<=team.leave_year_end),console.log("leave.end_date"+leave.end_date),console.log("row.leave_year_end"+team.leave_year_end))}),team.number_days_leave_remaining=team.number_days_leave-number_days_leave_taken,$scope.me_Data=team)})}),$scope.removeLeave=function(event,dessert){event.stopPropagation(),console.log(dessert),delete_leave_by_id._delete(dessert._id)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/member/member-controller.js","/../components/member")},{b55mWE:4,buffer:3}],27:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.analyser_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Weekly_donations,Weekly_welcomedesk,Monthly_products_sold_online,Weekly_visits,Monthly_products_published,Monthly_welcomedesk,Monthly_donations,Monthly_visits,Weekly_retail_sales,Monthly_turnstiles,Monthly_retail_sales,Monthly_teg,make_a_pie,make_a_line_chart,weekly_data_table_columns,monthly_data_table_columns,grid_ui_settings,data_table_reload,table_security){$scope.interval="Weekly",$scope.running=!1,$scope.museums=[],$scope.selected_museums=[],$scope.chart_class="col-md-12 col-lg-12 col-sm-12 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.show_all_Button=!1,$scope.table_heading=$scope.range+" donations",$scope.pie_date="Apr 2017",$scope.start_date=new Date("04/01/2017"),$scope.end_date=new Date("03/31/2018");var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:"100",pinnedLeft:!0},{field:"stat",name:"Statistic",width:"100",pinnedLeft:!0}),$scope.windup=function(sales,gallery_visits,welcome,products,orders,team,visits,gates){columnDefs=columnDefs.concat($scope.axis_range.build($scope,$scope.start_date,$scope.end_date)),_.each(visits,function(row){""!=row.museum&&($scope._rows.push(row),row.museum.indexOf("%")==-1&&($scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.data_rows.push(row)))}),_.each(gallery_visits,function(row){""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope.data_rows.push(row))}),_.each(sales,function(row){console.log("sales",sales),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope._rows.push(row),$scope.data_rows.push(row))}),_.each(team,function(row){console.log("team",team),""!=row.museum&&($scope._rows.push(row),"Donations"==row.stat&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),console.log("Donations"),$scope.data_rows.push(row)))}),_.each(gates,function(row){console.log("gates",gates),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),console.log("Donations"),$scope.data_rows.push(row))}),_.each(welcome,function(row){console.log("welcome",welcome),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope.data_rows.push(row))}),_.each(products,function(row){console.log("products",products),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope.data_rows.push(row))}),console.log("chart_stats",$scope.chart_stats),_.each(orders,function(row){console.log("orders",orders),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.stat)==-1&&$scope.chart_stats.push(row.stat),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,$scope.axis_threshhold=50,$scope.toggleSelection_stats=function(fruitName){var idx=$scope.selected_chart_stats.indexOf(fruitName);idx>-1?$scope.selected_chart_stats.splice(idx,1):$scope.selected_chart_stats.push(fruitName),make_a_line_chart.build($scope,columnDefs,"museum")},$scope.toggleSelection=function(fruitName){var idxx=$scope.selected_museums.indexOf(fruitName);idxx>-1?$scope.selected_museums.splice(idxx,1):$scope.selected_museums.push(fruitName),make_a_line_chart.build($scope,columnDefs,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:150,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat($scope.axis_range.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.running=!1},$scope.$watch("interval",function(newValue,oldValue){$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1,$scope.rows=[],$scope.data_rows=[],$scope._rows=[],$scope.chart_stats=[],$scope.selected_chart_stats=[],$("input").attr("checked",!1),$scope.running=!0,"Weekly"==$scope.interval?($scope.axis_range=weekly_data_table_columns,Weekly_visits.query({},function(visits){Weekly_retail_sales.query({},function(sales){Weekly_welcomedesk.query({},function(welcome){Weekly_donations.query({},function(donations){$scope.windup(sales,"",welcome,"","",donations,visits,"")})})})})):($scope.axis_range=monthly_data_table_columns,$scope.windup($scope.sales,$scope.gallery_visits,$scope.welcome,$scope.products,$scope.orders,$scope.team,$scope.visits,$scope.gates))}),Monthly_retail_sales.query({},function(sales){$scope.sales=sales,Monthly_teg.query({},function(gallery_visits){$scope.gallery_visits=gallery_visits,Monthly_welcomedesk.query({},function(welcome){$scope.welcome=welcome,Monthly_products_published.query({},function(products){$scope.products=products,Monthly_products_sold_online.query({},function(orders){$scope.orders=orders,Monthly_donations.query({},function(team){$scope.team=team,Monthly_visits.query({},function(visits){$scope.visits=visits,Monthly_turnstiles.query({},function(gates){$scope.gates=gates})})})})})})})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/analyser/analyser-controller.js","/../components/performance/analyser")},{b55mWE:4,buffer:3}],28:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_corporate_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,dynamicTableCellFilter_donations,Monthly_corporate,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_corporate){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="corporate",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Corporate income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"200",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["corporate"],Monthly_corporate.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"corporate"==row.stat&&(console.log("corporate"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"200",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/corporate/monthly-corporate-controller.js","/../components/performance/corporate")},{b55mWE:4,buffer:3}],29:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.corporate_performance_form=function($scope,$http,$q,Raw_corporate,data_table_reload,get_table_data_nomusem){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.donation_box_amount.value=""})}$scope.extraQuery={donation_box_no:"#"},$scope.Raw_corporate=Raw_corporate,$scope.onSubmit=function(){var kpis=new Raw_corporate({type:visit_form.museum.value,kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,donation_box_no:0,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={type:visit_form.museum.value,date_value:visit_form.date_value.value,donation_box_no:0,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_corporate.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("corporate_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/corporate/performance-form-controller.js","/../components/performance/corporate")},{b55mWE:4,buffer:3}],30:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_corporate_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_corporate,data_table_reload,get_table_data_nomusem,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_corporate,$rootScope.featured_collection=Raw_corporate,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={type:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"type",name:"type",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_box_amount",name:"Amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/corporate/raw-corporate-controller.js","/../components/performance/corporate")},{b55mWE:4,buffer:3}],31:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_corporate_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_corporate,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_corporate.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"corporate"==row.stat&&(console.log("corporate"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/corporate/yearly-corporate-controller.js","/../components/performance/corporate")},{b55mWE:4,buffer:3}],32:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.dashboard_controller=function($route,$scope){$scope.dashboard=!0,$scope.refresh=function(link){window.open(link,"_blank")}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/dashboard-controllers.js","/../components/performance")},{b55mWE:4,buffer:3}],33:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donations_box_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_boxes,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Donation boxes  by month",$scope.background_colour="donations",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Donation Box Income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["Donations"],Monthly_donations_boxes.query({cache:!0},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"Donations"==row.stat&&(console.log("Donations"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-boxes/monthly-donations-controller.js","/../components/performance/donations-boxes")},{b55mWE:4,buffer:3}],34:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.directdebitFormdata=function(){return{templateUrl:"./components/performance/donations-directdebit/kpi-form-and-data.html"}},exports.directdebitDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-directdebit/dashboard.html"}},exports.monthlyDonationsdirectdebit=function(){return{controller:"monthly_directdebit_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationsdirectdebit=function(){return{controller:"raw_directdebit_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationsdirectdebit=function(){return{controller:"donations_directdebit_performance_form",templateUrl:"./components/performance/donations-directdebit/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-directdebit/directdebit-directive.js","/../components/performance/donations-directdebit")},{b55mWE:4,buffer:3}],35:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_directdebit_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_directdebit,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Fundraised income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_directdebit.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-directdebit/monthly-controller.js","/../components/performance/donations-directdebit")},{b55mWE:4,buffer:3}],36:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_directdebit_performance_form=function($scope,$http,$q,Raw_donations_directdebit,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.museum_id.value="",visit_form.amount.value="",visit_form.gift_aid_amount=""})}$scope.extraQuery={},$scope.Raw_donations_directdebit=Raw_donations_directdebit,$scope.onSubmit=function(){var kpis=new Raw_donations_directdebit({kpi_type:"visits",amount:visit_form.amount.value,gift_aid_amount:visit_form.gift_aid_amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_directdebit.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_directdebit.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-directdebit/performance-form-controller.js","/../components/performance/donations-directdebit")},{b55mWE:4,buffer:3}],37:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_directdebit_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_directdebit,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_directdebit,$rootScope.featured_collection=Raw_donations_directdebit,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-directdebit/raw-controller.js","/../components/performance/donations-directdebit")},{b55mWE:4,buffer:3}],38:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donorsFormdata=function(){return{templateUrl:"./components/performance/donations-donors/kpi-form-and-data.html"}},exports.donorsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-donors/dashboard.html"}},exports.monthlyDonationsdonors=function(){return{controller:"monthly_donors_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationsdonors=function(){return{controller:"raw_donors_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationsdonors=function(){return{controller:"donations_donors_performance_form",templateUrl:"./components/performance/donations-donors/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-donors/donors-directive.js","/../components/performance/donations-donors")},{b55mWE:4,buffer:3}],39:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donors_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_donors,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Major Donors income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_donors.query({},function(team){$scope.rows=[],
$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-donors/monthly-controller.js","/../components/performance/donations-donors")},{b55mWE:4,buffer:3}],40:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_donors_performance_form=function($scope,$http,$q,Raw_donations_donors,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.museum_id.value="",visit_form.amount.value="",visit_form.gift_aid_amount=""})}$scope.extraQuery={},$scope.Raw_donations_donors=Raw_donations_donors,$scope.onSubmit=function(){var kpis=new Raw_donations_donors({kpi_type:"visits",amount:visit_form.amount.value,gift_aid_amount:visit_form.gift_aid_amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_donors.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_donors.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-donors/performance-form-controller.js","/../components/performance/donations-donors")},{b55mWE:4,buffer:3}],41:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_donors_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_donors,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_donors,$rootScope.featured_collection=Raw_donations_donors,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-donors/raw-controller.js","/../components/performance/donations-donors")},{b55mWE:4,buffer:3}],42:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donationsgeneralFormdata=function(){return{templateUrl:"./components/performance/donations-general/kpi-form-and-data.html"}},exports.donationsgeneralDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-general/dashboard.html"}},exports.monthlyDonationsgeneral=function(){return{controller:"monthly_donationsgeneral_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationsgeneral=function(){return{controller:"raw_donationsgeneral_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationsgeneral=function(){return{controller:"donations_general_performance_form",templateUrl:"./components/performance/donations-general/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-general/donors-directive.js","/../components/performance/donations-general")},{b55mWE:4,buffer:3}],43:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donationsgeneral_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_general,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthlygeneral donations income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_general.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-general/monthly-controller.js","/../components/performance/donations-general")},{b55mWE:4,buffer:3}],44:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_general_performance_form=function($scope,$http,$q,Raw_donations_general,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.amount.value="",visit_form.gift_aid_amount=""})}$scope.extraQuery={},$scope.Raw_donations_general=Raw_donations_general,$scope.onSubmit=function(){var kpis=new Raw_donations_general({kpi_type:"visits",amount:visit_form.amount.value,gift_aid_amount:visit_form.gift_aid_amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_general.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_general.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-general/performance-form-controller.js","/../components/performance/donations-general")},{b55mWE:4,buffer:3}],45:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_donationsgeneral_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_general,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_general,$rootScope.featured_collection=Raw_donations_general,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!1)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-general/raw-controller.js","/../components/performance/donations-general")},{b55mWE:4,buffer:3}],46:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.daily_donations_kiosk_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Daily_donations_kiosk,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Daily_donations_kiosk,$rootScope.featured_collection=Daily_donations_kiosk,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",type:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"amount_including_gift_aid",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-kiosk/daily-donations_kiosk-controller.js","/../components/performance/donations-kiosk")},{b55mWE:4,buffer:3}],47:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.kiosk_uploader=function($scope,$http,$q,Resources,Posters,data_table_reload,get_table_data,timeline_functions,$routeParams){if("rooms"==$routeParams.mode){$scope.name_of_form="Select room"}else{$scope.name_of_form="Select Equipment"}$scope.extraQuery={museum_id:"#"},$scope.rooms=[];var _room=[];_room.name="BMAG",$scope.rooms.push(_room);var _room=[];_room.name="MSHED",$scope.rooms.push(_room);var _room=[];_room.name="ALL VENUES",$scope.rooms.push(_room),$scope.Posters=Posters,console.log("user",$scope.user);$scope.selected_room="",$scope.room_change=function(room){$scope.selected_room=room.name};var content="file content for example",blob=new Blob([content],{type:"text/plain"});$scope.url=(window.URL||window.webkitURL).createObjectURL(blob),$scope.onSubmit=function(){var files=[];_.each($("#upload-input").get(0).files,function(file){var _file={};_file.name=file.name,_file.type=file.type,files.push(_file),console.log(_file)})},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}}),$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var files=$(this).get(0).files;if(files.length>0){for(var formData=new FormData,i=0;i<files.length;i++){var file=files[i];file.comments=visit_form.name.value,formData.append("uploads[]",file,file.name),console.log(file)}$.ajax({url:"/upload/donation-kiosk",type:"POST",data:formData,processData:!1,contentType:!1,success:function(data){console.log("upload successful!\n"+data),$.ajax({url:"/download/"+file.name+".log/donation-kiosk",type:"GET",success:function(response){$("#logtext").text(response)},error:function(XMLHttpRequest,textStatus,errorThrown){}})},xhr:function(){var xhr=new XMLHttpRequest;return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(100*percentComplete),$(".progress-bar").text(percentComplete+"%"),$(".progress-bar").width(percentComplete+"%"),100===percentComplete&&$(".progress-bar").html("Done")}},!1),xhr}})}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-kiosk/kiosk-uploader-controller.js","/../components/performance/donations-kiosk")},{b55mWE:4,buffer:3}],48:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donations_kiosk_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_kiosk,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_kiosk){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Kiosk Donations  by month",$scope.background_colour="donations_kiosk",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Kiosk Donations  by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_kiosk}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_kiosk.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_kiosk}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-kiosk/monthly-donations_kiosk-controller.js","/../components/performance/donations-kiosk")},{b55mWE:4,buffer:3}],49:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_kiosk_performance_form=function($scope,$http,$q,Raw_donations_kiosk,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.museum_id.value="",visit_form.donation_box_amount.value="",visit_form.type_id.value="",visit_form.no_envelopes.value="",visit_form.gift_aid_donation_box_amount="",visit_form.no_transactions.value=""})}$scope.extraQuery={museum_id:"#",type:"#"},$scope.Raw_donations_kiosk=Raw_donations_kiosk,$scope.onSubmit=function(){var kpis=new Raw_donations_kiosk({museum_id:visit_form.museum.value,kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,gift_aid_donation_box_amount:visit_form.gift_aid_donation_box_amount.value,type:visit_form.type_id.value,no_transactions:visit_form.no_transactions.value,no_envelopes:visit_form.no_envelopes.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,type:visit_form.type_id.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_kiosk.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_kiosk.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-kiosk/performance-form-controller.js","/../components/performance/donations-kiosk")},{b55mWE:4,buffer:3}],50:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_donations_kiosk_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_kiosk,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_kiosk,$rootScope.featured_collection=Raw_donations_kiosk,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",type:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"kiosk_alias",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aided",resizable:!0,type:"boolean"},{field:"amount_including_gift_aid",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-kiosk/raw-donations_kiosk-controller.js","/../components/performance/donations-kiosk")},{b55mWE:4,buffer:3}],51:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_online_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_online,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Online shop donations  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly online shop donations",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_online.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-online/monthly-controller.js","/../components/performance/donations-online")},{b55mWE:4,buffer:3}],52:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.onlineFormdata=function(){return{templateUrl:"./components/performance/donations-online/kpi-form-and-data.html"}},exports.onlineDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-online/dashboard.html"}},exports.monthlyDonationsonline=function(){return{controller:"monthly_online_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationsonline=function(){return{controller:"raw_online_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationsonline=function(){return{controller:"donations_online_performance_form",templateUrl:"./components/performance/donations-online/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-online/online-directive.js","/../components/performance/donations-online")},{b55mWE:4,buffer:3}],53:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_online_performance_form=function($scope,$http,$q,Raw_donations_online,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.amount.value="",visit_form.issue=""})}$scope.extraQuery={},$scope.Raw_donations_online=Raw_donations_online,$scope.onSubmit=function(){var kpis=new Raw_donations_online({kpi_type:"visits",amount:visit_form.amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_online.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_online.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-online/performance-form-controller.js","/../components/performance/donations-online")},{b55mWE:4,buffer:3}],54:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_online_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_online,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_online,$rootScope.featured_collection=Raw_donations_online,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-online/raw-controller.js","/../components/performance/donations-online");
},{b55mWE:4,buffer:3}],55:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donations_other_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_other,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Fundraised income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_other.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-other/monthly-donations_other-controller.js","/../components/performance/donations-other")},{b55mWE:4,buffer:3}],56:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_other_performance_form=function($scope,$http,$q,Raw_donations_other,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.museum_id.value="",visit_form.donation_box_amount.value="",visit_form.type_id.value="",visit_form.no_envelopes.value="",visit_form.gift_aid_donation_box_amount="",visit_form.no_transactions.value=""})}$scope.extraQuery={museum_id:"#",type:"#"},$scope.Raw_donations_other=Raw_donations_other,$scope.onSubmit=function(){var kpis=new Raw_donations_other({museum_id:visit_form.museum.value,kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,gift_aid_donation_box_amount:visit_form.gift_aid_donation_box_amount.value,type:visit_form.type_id.value,no_transactions:visit_form.no_transactions.value,no_envelopes:visit_form.no_envelopes.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,type:visit_form.type_id.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_other.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_other.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-other/performance-form-controller.js","/../components/performance/donations-other")},{b55mWE:4,buffer:3}],57:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_donations_other_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_other,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_other,$rootScope.featured_collection=Raw_donations_other,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",type:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"type",name:"type",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_box_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_donation_box_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"no_envelopes",name:"No Gift Aided Donations",resizable:!0},{field:"no_transactions",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-other/raw-donations_other-controller.js","/../components/performance/donations-other")},{b55mWE:4,buffer:3}],58:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_donations_other_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_donations_other,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_donations_other.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-other/yearly-donations_other-controller.js","/../components/performance/donations-other")},{b55mWE:4,buffer:3}],59:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_treasure_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_treasure,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Treasure income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_treasure.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-treasure/monthly-controller.js","/../components/performance/donations-treasure")},{b55mWE:4,buffer:3}],60:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_treasure_performance_form=function($scope,$http,$q,Raw_donations_treasure,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.museum_id.value="",visit_form.amount.value="",visit_form.gift_aid_amount="",visit_form.issue=""})}$scope.extraQuery={},$scope.Raw_donations_treasure=Raw_donations_treasure,$scope.onSubmit=function(){var kpis=new Raw_donations_treasure({kpi_type:"visits",amount:visit_form.amount.value,gift_aid_amount:visit_form.gift_aid_amount.value,issue:visit_form.issue.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_treasure.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_treasure.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-treasure/performance-form-controller.js","/../components/performance/donations-treasure")},{b55mWE:4,buffer:3}],61:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_treasure_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_treasure,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_treasure,$rootScope.featured_collection=Raw_donations_treasure,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"issue",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-treasure/raw-controller.js","/../components/performance/donations-treasure")},{b55mWE:4,buffer:3}],62:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.treasureFormdata=function(){return{templateUrl:"./components/performance/donations-treasure/kpi-form-and-data.html"}},exports.treasureDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-treasure/dashboard.html"}},exports.monthlyDonationstreasure=function(){return{controller:"monthly_treasure_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationstreasure=function(){return{controller:"raw_treasure_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationstreasure=function(){return{controller:"donations_treasure_performance_form",templateUrl:"./components/performance/donations-treasure/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-treasure/treasure-directive.js","/../components/performance/donations-treasure")},{b55mWE:4,buffer:3}],63:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_trusts_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations_trusts,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations_other){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations_other",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Trusts and Foundations income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["donations_other"],Monthly_donations_trusts.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"donations_other"==row.stat&&(console.log("donations_other"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations_other}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-trusts/monthly-controller.js","/../components/performance/donations-trusts")},{b55mWE:4,buffer:3}],64:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_trusts_performance_form=function($scope,$http,$q,Raw_donations_trusts,data_table_reload,get_table_data_nomusem_notype){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.get_table_data_nomusem_notype(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.amount.value="",visit_form.installment_number="",visit_form.trust_name=""})}$scope.extraQuery={},$scope.Raw_donations_trusts=Raw_donations_trusts,$scope.onSubmit=function(){var kpis=new Raw_donations_trusts({kpi_type:"visits",amount:visit_form.amount.value,trust_name:visit_form.trust_name.value,installment_number:visit_form.installment_number.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations_trusts.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations_trusts.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_other_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-trusts/performance-form-controller.js","/../components/performance/donations-trusts")},{b55mWE:4,buffer:3}],65:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_trusts_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations_trusts,data_table_reload,get_table_data_nomusem_notype,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations_trusts,$rootScope.featured_collection=Raw_donations_trusts,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"trust_name",resizable:!0},{field:"installment_number",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("get_table_data_nomusem_notype"),get_table_data_nomusem_notype.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-trusts/raw-controller.js","/../components/performance/donations-trusts")},{b55mWE:4,buffer:3}],66:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.trustsFormdata=function(){return{templateUrl:"./components/performance/donations-trusts/kpi-form-and-data.html"}},exports.trustsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-trusts/dashboard.html"}},exports.monthlyDonationstrusts=function(){return{controller:"monthly_trusts_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationstrusts=function(){return{controller:"raw_trusts_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordDonationstrusts=function(){return{controller:"donations_trusts_performance_form",templateUrl:"./components/performance/donations-trusts/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations-trusts/trusts-directive.js","/../components/performance/donations-trusts")},{b55mWE:4,buffer:3}],67:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_donations_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_donations,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="donations",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Fundraised income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["Donations"],Monthly_donations.query({cache:!0},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"Donations"==row.stat&&(console.log("Donations"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations/monthly-donations-controller.js","/../components/performance/donations")},{b55mWE:4,buffer:3}],68:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.donations_performance_form=function($scope,$http,$q,Raw_donations,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.gift_aid_donation_box_amount.value="",visit_form.donation_box_amount.value="",visit_form.donation_box_no.value="",visit_form.no_envelopes.value=""})}$scope.extraQuery={donation_box_no:"#"},$scope.Raw_donations=Raw_donations,$scope.onSubmit=function(){var kpis=new Raw_donations({museum_id:visit_form.museum.value,kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,gift_aid_donation_box_amount:visit_form.gift_aid_donation_box_amount.value,donation_box_no:visit_form.donation_box_no.value,no_envelopes:visit_form.no_envelopes.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,donation_box_no:visit_form.donation_box_no,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_donations.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_donations.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations/performance-form-controller.js","/../components/performance/donations")},{b55mWE:4,buffer:3}],69:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_donations_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_donations,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_donations,$rootScope.featured_collection=Raw_donations,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_box_amount",name:"Amount (without gift aid)",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"gift_aid_donation_box_amount",name:"Gift aid amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"donation_box_no",resizable:!0},{field:"no_envelopes",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1
},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations/raw-donations-controller.js","/../components/performance/donations")},{b55mWE:4,buffer:3}],70:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_donations_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_donations,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_donations.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"donations"==row.stat&&(console.log("donations"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/donations/yearly-donations-controller.js","/../components/performance/donations")},{b55mWE:4,buffer:3}],71:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_events_controller=function(yearly_totals,yearly_percentage_difference,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_events,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter_retail){$scope.init=function(event_type){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.background_colour="events",$scope.table_heading=event_type+" monthly event attendees",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],columns={field:"stat",cellFilter:"valueFilter",name:"Statistic",width:300,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter_retail},columnDefs.push(columns),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.options_list=[],option=[],option.name="INDEPENDENT",option.value="INDEPENDENT",$scope.options_list.push(option),option=[],option.name="FACILITATED",option.value="FACILITATED",$scope.options_list.push(option),get_data=function(event_type){console.log("get_data"),Monthly_events.query({event_type:event_type,cache:!0},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),"age_group"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),make_a_line_chart.build($scope,columnDefs,"age_group"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push(columns),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"age_group")})})},get_data(event_type),$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/events/monthly-events-controller.js","/../components/performance/events")},{b55mWE:4,buffer:3}],72:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_events_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,Event_names,data_table_reload,Emu_events,get_table_data,Community_groups){function sortJSON(data,key,way){return data.sort(function(a,b){var x=a[key],y=b[key];return"123"===way?x<y?-1:x>y?1:0:"321"===way?x>y?-1:x<y?1:0:void 0})}$scope.scope=$scope,$scope.events=[],$scope.selected_event=[],$scope.museums=[],$scope.types=[],$scope.extraQuery={on_site_off_site:"#"},$scope.event_lead=$scope.user.firstName+" "+$scope.user.lastName,$scope.$watch("event",function(newValue){newValue&&(visit_form.date_value.value=moment(newValue.startDate).format("YYYY-MM-DD"),visit_form.date_value_end.value=moment(newValue.endDate).format("YYYY-MM-DD"),newValue.venue&&(newValue.venue=newValue.venue.replace("M Shed","M-SHED"),newValue.venue=newValue.venue.replace("Bristol Museum & Art Gallery","BMAG"),newValue.venue=newValue.venue.replace("Georgian House","GEORGIAN-HOUSE"),newValue.venue=newValue.venue.replace("The Red Lodge Museum","RED-LODGE"),newValue.venue=newValue.venue.replace("Bristol Archives","BRISTOL-ARCHIVES"),newValue.venue=newValue.venue.replace("Kings Weston Roman Villa","ROMAN-VILLA"),newValue.venue=newValue.venue.replace("Blaise Castle House Museum","BLAISE"),$scope.selected_museum=newValue.venue))}),$scope.museums.push({value:"BMAG",name:"Bristol Museum & Art Gallery"}),$scope.museums.push({value:"M-SHED",name:"M Shed"}),$scope.museums.push({value:"GEORGIAN-HOUSE",name:"The Georgian House Museum"}),$scope.museums.push({value:"RED-LODGE",name:"The Red Lodge"}),$scope.museums.push({value:"BLAISE",name:"Blaise Museum"}),$scope.museums.push({value:"BRISTOL-ARCHIVES",name:"Bristol Archives"}),$scope.museums.push({value:"ROMAN-VILLA",name:"Kings Weston Roman Villas"}),$scope.types.push({value:"Adult Workshop",name:"Adult Workshop"}),$scope.types.push({value:"Family Activity/Workshop",name:"Family Activity/Workshop"}),$scope.types.push({value:"Festival",name:"Festival"}),$scope.types.push({value:"Lecture",name:"Lecture"}),$scope.types.push({value:"Talk/Tour",name:"Talk/Tour"}),$scope.types.push({value:"Walk",name:"Walk"}),$scope.types.push({value:"Working-Exhibits",name:"Working-Exhibits"}),$scope.types.push({value:"Other / Special event",name:"Other / Special event"}),Community_groups.query({},function(groups){past_community=[],_.each(groups,function(group){_group=[],_group.name=group,_group.value=group,past_community.push(_group)}),$scope.community_groups=past_community,$scope.community_groups.push({name:"add new group"})}),Event_names.query({},function(response){past_events=[],_.each(response,function(event){event._id.event_lead.toLowerCase()==$scope.user.firstName.toLowerCase()+" "+$scope.user.lastName.toLowerCase()&&(past_events.push({name:event._id.event_name}),console.log("past event",event._id.event_name))}),"PARTICIPATION"==$scope.user.team.toUpperCase()?past_events.push({name:"Dementia Friendly Creative Cafs"}):past_events.push({name:"add new event below"}),past_events=sortJSON(past_events,"name","321"),$scope.events=past_events,$scope.events.push({name:"add new event"})}),$scope.add=function(newValue){var obj={};obj.name=newValue,obj.value=newValue.name,$scope.events.push(obj),$scope.event=obj,$scope.newValue=""},$scope.add_community=function(){var obj={};""!=$scope._newValue&&(obj.name=$scope._newValue,obj.value=$scope._newValue,$scope.community_groups.push(obj),$scope.community_group=obj,$scope.newValue="")},$scope.form_name="Bristol Culture activities",$scope.age_groups=[],$scope.target_groups=[],$scope.selection=[],$scope.on_site_off_site="",$scope.target_groups.push({name:"Black, Asian, and minority ethnic (BAME)"}),$scope.target_groups.push({name:"Disability"}),$scope.target_groups.push({name:"Lesbian, Gay, Bisexual, and Transgrender (LGBT)"}),$scope.target_groups.push({name:"Children and Young People (CYP)"}),$scope.target_groups.push({name:"Older People"}),$scope.target_groups.push({name:"Socio-economically disadvantaged group"}),$scope.target_groups.push({name:"Faith/Religion"}),$scope.target_groups.push({name:" Health/Wellbeing"}),$scope.deleteUser=function(userToEdit){var idx=$scope.age_groups.indexOf(userToEdit);idx>-1&&$scope.age_groups.splice(idx,1)},$scope.toggleSelection=function(target_group){var idx=$scope.selection.indexOf(target_group);idx>-1?$scope.selection.splice(idx,1):$scope.selection.push(target_group)},$scope.addCount=function(){if(visit_form.count.value>0){var age_group={name:visit_form.age_group.value,count:visit_form.count.value};console.log("clear age group"),visit_form.age_group.value="",visit_form.count.value="",$scope.age_groups.push(age_group)}},$scope.addtarget_groups=function(){var target_groups={name:visit_form.target_group.value};$scope.target_groups.push(target_groups),visit_form.age_group.value="",visit_form.count.value="",$scope.$apply()},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),visit_form.on_site_off_site.value="",$scope.age_groups=[],$scope.selection=[],visit_form.event_name.value="",visit_form.community_group="",visit_form.count.value="",visit_form.age_group.value="",visit_form.comments.value="",visit_form.date_value.value="",visit_form.date_value_end.value=""})}$scope.addCount();var kpis=new Raw_events({museum_id:visit_form.museum.value,kpi_type:"visits",age_groups:$scope.age_groups,on_site_off_site:visit_form.on_site_off_site.value,target_groups:$scope.selection,event_name:$("#event_name").find("option:selected").text(),event_type:visit_form.events.value,age_group:visit_form.age_group.value,no_sessions:visit_form.no_sessions.value,event_lead:visit_form.event_lead.value,date_logged:new Date,date_value:visit_form.date_value.value,date_value_end:visit_form.date_value_end.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,event_lead:visit_form.event_lead.value,event_name:$("#event_name").find("option:selected").text(),date_value:visit_form.date_value.value,on_site_off_site:visit_form.on_site_off_site.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_events.query(query,function(visits){console.log("Raw_visits",visits.length),save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/events/performance-form-controller.js","/../components/performance/events")},{b55mWE:4,buffer:3}],73:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_events_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,data_table_reload,AuthService,grid_ui_settings,get_table_data,table_security){$scope.table_class="col-md-12 col-lg-12col-sm-12 full-height",$scope.show_all_Button=!0,$scope.featured_collection=Raw_events,$rootScope.featured_collection=Raw_events,$rootScope.canEdit_table=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={on_site_off_site:"#"};var columnDefs=[];$scope.moused=function(){console.log("moused over")},columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:100},{field:"date_value",name:"Week beginning",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'",width:90},{field:"on_site_off_site",name:"Site",resizable:!0,width:100},{field:"no_sessions",name:"No. sessions",resizable:!0,width:100},{field:"event_lead",name:"Event Lead",resizable:!0,width:140},{field:"event_name",name:"Name of Event",resizable:!0,width:250},{field:"event_type",name:"Type of Event",resizable:!0,width:250},{field:"under_5",name:"Under 5s",resizable:!0,width:100,Editable:!1},{field:"_5_15",name:"5 - 15",resizable:!0,width:100,Editable:!1},{field:"_16_over",name:"Adults 16+",resizable:!0,width:100,Editable:!1},{field:"count",name:"Total",resizable:!0,width:100,Editable:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/events/raw-events-controller.js","/../components/performance/events")},{b55mWE:4,buffer:3}],74:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_events_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_events,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"on_off_site",name:"Type",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"age_group",name:"Age Group",width:80,pinnedLeft:!0,enableColumnMoving:!1}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_events.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"count"==row.stat&&(console.log("count"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","count"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"on_off_site",name:"Type",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"age_group",name:"Age Group",width:80,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","count")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/events/yearly-events-controller.js","/../components/performance/events")},{b55mWE:4,buffer:3}],75:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_exhibitions_pwyt_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_exhibitions_pwyt,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly total",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:"250",pinnedLeft:!0},{field:"stat",name:"Statistic",width:"250",pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_exhibitions_pwyt.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row),"Donations"==row.stat&&(console.log("Donations"),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","donation_box_amount"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watch("end_date",function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:"250"},{field:"stat",name:"Statistic",width:"250"}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"donation_box_amount")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/exhibitions-pwyt/monthly-donations-controller.js","/../components/performance/exhibitions-pwyt")},{b55mWE:4,buffer:3}],76:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.exhibitions_pwyt_performance_form=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_exhibitions_pwyt,data_table_reload,get_table_data){$scope.extraQuery={donation_box_no:"#"},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),visit_form.donation_box_amount.value="",visit_form.donation_box_no.value="",visit_form.no_envelopes.value="",get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)})}var kpis=new Raw_exhibitions_pwyt({museum_id:visit_form.museum.value,kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,donation_box_no:visit_form.donation_box_no.value,no_envelopes:visit_form.no_envelopes.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,donation_box_no:visit_form.donation_box_no,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_exhibitions_pwyt.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_exhibitions_pwyt.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/exhibitions-pwyt/performance-form-controller.js","/../components/performance/exhibitions-pwyt")},{b55mWE:4,buffer:3}],77:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_exhibitions_pwyt_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_exhibitions_pwyt,data_table_reload,get_table_data,grid_ui_settings,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_exhibitions_pwyt,$rootScope.featured_collection=Raw_exhibitions_pwyt,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.extraQuery={donation_box_no:"#"},$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"130"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_box_amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"donation_box_no",resizable:!0},{field:"no_envelopes",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/exhibitions-pwyt/raw-donations-controller.js","/../components/performance/exhibitions-pwyt")},{b55mWE:4,buffer:3}],78:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.exhibitions_summary_controller=function(monthly_data_table_columns,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Emu_events,grid_ui_settings){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-6 col-lg-6 col-sm-6 pull-right",$scope.table_heading="Exhibition dates",$scope.chart_heading="Data  by month",$scope.background_colour="exhibitions",$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),$scope.filter_pieSelected=[],build_report=function(){$scope.filter_pie=[],columnDefs.push({field:"name",name:"Name",width:350,pinnedLeft:!0,enableColumnMoving:!1},{field:"venue",name:"Venue",width:110,pinnedLeft:!0,enableColumnMoving:!1},{field:"event_space",name:"Gallery",width:110,pinnedLeft:!0,enableColumnMoving:!1},{field:"startDate",name:"Start",width:100,pinnedLeft:!0,enableColumnMoving:!1},{field:"endDate",name:"End",width:100,pinnedLeft:!0,enableColumnMoving:!1}),Emu_events.getData().then(function(response){$scope._rows=[],$scope.options_list=[],_.each(response,function(event){"Exhibition"==event.type&&new Date(event.startDate)>=$scope.start_date&&($scope.options_list.push(event),$scope._rows.push(event),console.log(event))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.columnDefs=columnDefs})},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){build_report()})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/exhibitions/exhibitions-summary-controller.js","/../components/performance/exhibitions")},{b55mWE:4,buffer:3}],79:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.exhibitions_teg_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Exhibitions_teg,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Overall Stats by Exhibition",$scope.chart_class="col-md-12 col-lg-12 col-sm-12 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-12",$scope.chart_heading="Gallery visits by monthx",$scope.background_colour="exhibitions",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"exhibition",name:"Exhibition",width:350},{field:"visits",name:"All visits",width:200},{field:"gallery_visits",name:"Exhibition  visits",width:200},{field:"income",name:"Income",width:200},{field:"conversion",name:"Conversion",width:200},{field:"spend_per_head",name:"Spend per head (gross)",width:200}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs.enableFiltering=!1,console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["TEG visits"],Exhibitions_teg.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),"gallery_visits"==row.stat&&(console.log("gallery_visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_line_chart.build($scope,columnDefs,"exhibition"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"exhibition")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"exhibition",name:"Exhibition",width:250},{field:"visits",name:"all visits",width:130},{field:"gallery_visits",name:"exhibition  visits",width:130},{field:"income",name:"income",width:130},{field:"conversion",name:"conversion",width:130},{field:"spend_per_head",name:"spend_per_head",width:130}),columnDefs.enableFiltering=!1,$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"exhibition")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/exhibitions-teg-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],80:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_teg_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_teg,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly TEG stats",$scope.chart_class="col-md-6 col-lg-6 col-sm-6",$scope.table_class="col-md-9 col-lg-9 col-sm-9",$scope.chart_heading="Exhibition visits by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"exhibition",name:"Exhibition",width:200},{field:"museum",name:"Museum",width:80,pinnedLeft:!0},{field:"stat",name:"Statistic",width:100,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["TEG visits"],Monthly_teg.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),"gallery_visits"==row.stat&&(console.log("gallery_visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"exhibition"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"exhibition",name:"Exhibition",width:200},{field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:100,pinnedLeft:!0}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"exhibition")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/monthly-teg-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],81:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.teg_performance_form=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_teg,data_table_reload,get_table_data){$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),visit_form.no_visits.value="",get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)})}var kpis=new Raw_teg({museum_id:visit_form.museum.value,kpi_type:"visits",value:visit_form.no_visits.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,exact:!0};Raw_teg.query(query,function(visits){console.log("Raw_visits",visits.length),
visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_teg.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/performance-form-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],82:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_teg_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_teg,data_table_reload,get_table_data,grid_ui_settings,$rootScope,table_security){$scope.table_class="col-md-10 col-lg-10 col-sm-10 full-height",$scope.show_all_Button=!0,$scope.featured_collection=Raw_teg,$rootScope.featured_collection=Raw_teg,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"value",name:"Visitors",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/raw-teg-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],83:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.weekly_teg_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Weekly_teg,make_a_pie,make_a_line_chart,weekly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Weekly TEG stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:"70",pinnedLeft:!0},{field:"stat",name:"Statistic",width:"50",pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(weekly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),Weekly_teg.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"gallery_visits"==row.stat&&(console.log("gallery_visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){for(week=0;week<moment().isoWeeksInYear();week++)$scope.filter_pie.push({value:week+" "+year,name:week+" "+year})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watch("end_date",function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:"250"},{field:"stat",name:"Statistic",width:"250"}),columnDefs=columnDefs.concat(weekly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/weekly-teg-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],84:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_teg_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_teg,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly TEG stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_teg.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"gallery_visits"==row.stat&&(console.log("gallery_visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gallery-visits/yearly-teg-controller.js","/../components/performance/gallery-visits")},{b55mWE:4,buffer:3}],85:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_all_giftaid_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,monthly_data_table_columns_retail,dynamicTableCellFilter_donations,$location,$rootScope,Monthly_all_giftaid,grid_ui_settings,table_security){console.log("controller go"),$scope.gridOptions=[],$scope.gridOptions.data=[],dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1];var columnDefs=[];$scope.table_heading="Welcome desk and donations gift aid",$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"100",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_all_giftaid.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gift-aid/monthly-allgiftaid-controller.js","/../components/performance/gift-aid")},{b55mWE:4,buffer:3}],86:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_giftaid_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,monthly_data_table_columns_retail,dynamicTableCellFilter_donations,$location,$rootScope,Monthly_giftaid,grid_ui_settings,table_security){console.log("controller go"),$scope.gridOptions=[],$scope.gridOptions.data=[],dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],$scope.table_heading="Monthly donations gift aid";var columnDefs=[];$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:"100",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_giftaid.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gift-aid/monthly-giftaid-controller.js","/../components/performance/gift-aid")},{b55mWE:4,buffer:3}],87:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_giftaid_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_giftaid,data_table_reload,get_table_data){$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),visit_form.reset(),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)})}var kpis=new Raw_giftaid({museum_id:visit_form.museum.value,kpi_type:"visits",amount:visit_form.amount.value,no_envelopes:visit_form.no_envelopes.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,exact:!0};Raw_giftaid.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_giftaid.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gift-aid/performance-form-controller.js","/../components/performance/gift-aid")},{b55mWE:4,buffer:3}],88:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_giftaid_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_giftaid,data_table_reload,get_table_data,grid_ui_settings,table_security){$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.gridOptions=[],$scope.gridOptions.data="__data",$scope.featured_collection=Raw_giftaid,$rootScope.featured_collection=Raw_giftaid;var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"no_envelopes",resizable:!0},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!0},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!0}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:10})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/gift-aid/raw-giftaid-controller.js","/../components/performance/gift-aid")},{b55mWE:4,buffer:3}],89:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.kpi_home_controller=function(get_kpis,get_team_kpis,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,data_table_reload,AuthService,grid_ui_settings,get_table_data,table_security){function numberWithCommas(x){x=x.toString();for(var pattern=/(-?\d+)(\d{3})/;pattern.test(x);)x=x.replace(pattern,"$1,$2");return x}function whizz_number(number,id){console.log("whizz_number"),$("#"+id).each(function(){$(this).prop("Counter",0).animate({Counter:number},{duration:2e3,easing:"swing",step:function(now){$(this).text(numberWithCommas(Math.ceil(now)))}})})}$scope.satisfied=!1,$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1dZ1UMfIbNpbUEgGLy7nLeEwPaZ1xSlVyewSmK7jjWV0/values/satisfaction?key=AIzaSyCYImmjWQO1DVt0Wk3C2jUhQqRFQ1MgGfo",function(data){console.log(parseInt(data.values[0][0].replace("%",""))>=75),parseInt(data.values[0][0].replace("%",""))>=75&&(whizz_number(data.values[0][0].replace("%",""),"satisfaction"),$scope.satisfied=!0)});var current_year=moment(new Date).format("YYYY"),current_month=moment(new Date).format("MM");console.log("current month",current_month),get_team_kpis.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.visits=0,$scope.visits_num=0,$scope.lte_visits=0,$scope.lte_visits_num=0,$scope.filming_days=0,$scope.digitised=0,$scope.objects_used=0,_.each(team,function(row){console.log("kpi_row",row),row._id=[],row._id.year=moment(new Date(row.date_value_end)).format("YYYY"),row._id.month=moment(new Date(row.date_value_end)).format("MM"),row._id.year&&"objects used this month"==row.kpi_type&&(row._id.month>3&&current_month<=3&&(current_year-1).toString()==row._id.year.toString()&&($scope.objects_used+=row.no_sessions),row._id.month>3&&current_month>3&&current_year.toString()==row._id.year.toString()&&($scope.objects_used+=row.no_sessions),row._id.month<=3&&current_month<=3&&current_year.toString()==row._id.year.toString()&&($scope.objects_used+=row.no_sessions)),row._id.year&&"New emu object records"==row.kpi_type&&(row._id.month>3&&current_month<=3&&(current_year-1).toString()==row._id.year.toString()&&($scope.digitised+=row.no_sessions),row._id.month>3&&current_month>3&&current_year.toString()==row._id.year.toString()&&($scope.digitised+=row.no_sessions),row._id.month<=3&&current_month<=3&&current_year.toString()==row._id.year.toString()&&($scope.digitised+=row.no_sessions)),row._id.year&&"filming days"==row.kpi_type&&(row._id.month>3&&current_month<=3&&(current_year-1).toString()==row._id.year.toString()&&($scope.filming_days+=row.no_sessions),row._id.month>3&&current_month>3&&current_year.toString()==row._id.year.toString()&&($scope.filming_days+=row.no_sessions),row._id.month<=3&&current_month<=3&&current_year.toString()==row._id.year.toString()&&($scope.filming_days+=row.no_sessions))}),whizz_number($scope.digitised,"digitised-objects"),whizz_number($scope.objects_used,"objects-used"),whizz_number($scope.filming_days,"filming-days"),$scope.message="",$scope.lte_visits_num<$scope.visits_num&&($scope.plus=!0,$scope.percantage=Math.round($scope.visits_num/$scope.lte_visits_num*100-100),console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level1")),$scope.lte_visits_num>$scope.visits_num&&($scope.plus=!1,$scope.percantage=$scope.lte_visits_num-$scope.visits_num,console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level2"))}),get_kpis.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.visits=0,$scope.visits_num=0,$scope.lte_visits=0,$scope.lte_visits_num=0,_.each(team,function(row){row._id.year&&(current_month<=3&&(current_year-1).toString()==row._id.year.toString()&&"this"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("this fianncial year$scope.visits_num",$scope.visits_num),console.log("(current_year-1).toString()",(current_year-1).toString())),current_month>3&&current_year.toString()==row._id.year.toString()&&"this"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("$scope.visits_num",$scope.visits_num)),current_month<=3&&current_year.toString()==row._id.year.toString()&&"last"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("$scope.visits_num_last"+current_year,row.total_sessions))),row._id.ltd_year&&(current_month<=3&&(current_year-2).toString()==row._id.ltd_year.toString()&&"this"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.lte_visits",$scope.lte_visits)),(current_year-1).toString()==row._id.ltd_year.toString()&&"this"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.lte_visits",$scope.lte_visits)),current_month<=3&&(current_year-1).toString()==row._id.ltd_year.toString()&&"last"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.visits_num_last"+current_year,row.total_sessions)))}),whizz_number($scope.lte_visits_num,"lte_visits-level"),whizz_number($scope.visits_num,"visits-level"),$scope.message="",$scope.lte_visits_num<$scope.visits_num&&($scope.plus=!0,$scope.percantage=Math.round($scope.visits_num/$scope.lte_visits_num*100-100),console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level1")),$scope.lte_visits_num>$scope.visits_num&&($scope.plus=!1,$scope.percantage=$scope.lte_visits_num-$scope.visits_num,console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level2"))})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/home/kpi-home-controller.js","/../components/performance/home")},{b55mWE:4,buffer:3}],90:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.master_kpi_home_controller=function(get_kpis,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,data_table_reload,AuthService,grid_ui_settings,get_table_data,table_security){function numberWithCommas(x){x=x.toString();for(var pattern=/(-?\d+)(\d{3})/;pattern.test(x);)x=x.replace(pattern,"$1,$2");return x}function whizz_number(number,id){console.log("whizz_number"),$("#"+id).each(function(){$(this).prop("Counter",0).animate({Counter:number},{duration:2e3,easing:"swing",step:function(now){$(this).text(numberWithCommas(Math.ceil(now)))}})})}$scope.satisfied=!1,$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1dZ1UMfIbNpbUEgGLy7nLeEwPaZ1xSlVyewSmK7jjWV0/values/satisfaction?key=AIzaSyCYImmjWQO1DVt0Wk3C2jUhQqRFQ1MgGfo",function(data){console.log(parseInt(data.values[0][0].replace("%",""))>=75),parseInt(data.values[0][0].replace("%",""))>=75&&(whizz_number(data.values[0][0].replace("%",""),"satisfaction"),$scope.satisfied=!0)});var current_year=moment(new Date).format("YYYY"),current_month=moment(new Date).format("MM");console.log("current month",current_month),get_kpis.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.visits=0,$scope.visits_num=0,$scope.lte_visits=0,$scope.lte_visits_num=0,_.each(team,function(row){row._id.year&&(current_month<=3&&(current_year-1).toString()==row._id.year.toString()&&"this"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("this fianncial year$scope.visits_num",$scope.visits_num),console.log("(current_year-1).toString()",(current_year-1).toString())),current_month>3&&current_year.toString()==row._id.year.toString()&&"this"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("$scope.visits_num",$scope.visits_num)),current_month<=3&&current_year.toString()==row._id.year.toString()&&"last"==row._id.financial_yer&&($scope.visits+=row.total_sessions,$scope.visits_num+=row.total_sessions,console.log("$scope.visits_num_last"+current_year,row.total_sessions))),row._id.ltd_year&&(current_month<=3&&(current_year-2).toString()==row._id.ltd_year.toString()&&"this"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.lte_visits",$scope.lte_visits)),(current_year-1).toString()==row._id.ltd_year.toString()&&"this"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.lte_visits",$scope.lte_visits)),current_month<=3&&(current_year-1).toString()==row._id.ltd_year.toString()&&"last"==row._id.ltd_financial_yer&&($scope.lte_visits+=row.total_sessions,$scope.lte_visits_num+=row.total_sessions,console.log("$scope.visits_num_last"+current_year,row.total_sessions)))}),whizz_number($scope.lte_visits_num,"lte_visits-level"),whizz_number($scope.visits_num,"visits-level"),$scope.message="",$scope.lte_visits_num<$scope.visits_num&&($scope.plus=!0,$scope.percantage=Math.round($scope.visits_num/$scope.lte_visits_num*100-100),console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level1")),$scope.lte_visits_num>$scope.visits_num&&($scope.plus=!1,$scope.percantage=$scope.lte_visits_num-$scope.visits_num,console.log("$scope.percantage",$scope.percantage),whizz_number($scope.percantage,"diff-level2"))})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/home/master-kpi-home-controller.js","/../components/performance/home")},{b55mWE:4,buffer:3}],91:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_kpi_events_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_kpi_events,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}$scope.chart_class="col-md-6 col-lg-6 col-sm-6 pull-right",$scope.table_class="col-md-6 col-lg-6 col-sm-6",$scope.table_heading="Monthly kpi stats (automatically calulated)",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.extraQuery={team_id:$scope.user.team,kpi_type:"#"},$scope.filter_pie=[],columnDefs.push({field:"date",name:"Date",width:80,pinnedLeft:!0,enableColumnMoving:!1}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],console.log("columnDefs",columnDefs),$scope.teams=[],$scope.selected_chart_stats=[],$scope.chart_stats=[],$scope.selected_teams=[],$scope.data_columns=[],$scope.data_columns.push("date"),$scope.get_data=function(event_type){console.log("get_data cheese"),Monthly_kpi_events.query({team_id:$scope.user.team,kpi_type:"#"},function(team){for(console.log("team",team),$scope.rows=[],$scope._rows=[],$scope.columns=[],$scope.data_rows=[],start=moment($scope.start_date).year(),end=moment($scope.end_date).year(),year=start;year<=end;year++)_.each(moment.monthsShort(),function(month){var month_year=month+" "+year;column_data={date:month_year},_.each(team,function(row){if(""!=row.team&&($scope.teams.indexOf(row.team)==-1&&$scope.teams.push(row.team),row.team.indexOf("%")==-1)){$scope.selected_teams.indexOf(row.team)==-1&&$scope.selected_teams.push(row.team);Object.keys(row);$scope.data_rows.push(row);var heading_name=row.kpi_type;$scope.columns.indexOf(heading_name)==-1&&"team"!=heading_name&&($scope.columns.push(heading_name),heading={field:heading_name,name:heading_name,width:150},"total_income"==heading_name&&(heading.cellFilter='currency:"&pound;" : 2'),columnDefs.push(heading)),column_data[heading_name]&&isNumeric(row[month_year])?(column_data[heading_name]=parseInt(column_data[heading_name]),column_data[heading_name]+=parseInt(row[month_year])):row[month_year]>0&&isNumeric(row[month_year])&&(column_data[heading_name]=parseInt(row[month_year]))}}),console.log("column_data",column_data),$scope._rows.push(column_data)});console.log("team $scope._rows",$scope._rows),$scope.gridOptions.data=$scope._rows,yearly_totals.build($scope),yearly_percentage_difference.build($scope),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"team"),$scope.get_data(item)}})},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watch("changed",function(newValue){newValue>0&&$scope.get_data()}),$scope.$watch("tableChanged",function(newValue){newValue>0&&$scope.get_data()}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.options_list=[],$scope.session_type="OFF SITE",option=[],option.name="OFF SITE",option.value="OFF SITE",$scope.options_list.push(option),option=[],option.name="ON SITE",option.value="ON SITE",$scope.options_list.push(option),$scope.get_data("OFF SITE"),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/kpi-events/monthly-events-controller.js","/../components/performance/kpi-events")},{b55mWE:4,buffer:3}],92:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_kpi_events_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_kpi_events,data_table_reload,Emu_events,get_table_data_team,Community_groups){$scope.scope=$scope,$scope.events=[],$scope.selected_event=[],$scope.teams=[],$scope.extraQuery={kpi_type:"#",on_site_off_site:"#"},$scope.changed=0,$scope.$watch("event",function(newValue){newValue&&(visit_form.date_value.value=moment(newValue.startDate).format("YYYY-MM-DD"),visit_form.date_value_end.value=moment(newValue.endDate).format("YYYY-MM-DD"),newValue.venue&&($scope.selected_team=newValue.venue))}),$scope.team=$scope.user.team,Community_groups.query({},function(groups){past_community=[],_.each(groups,function(group){_group=[],_group.name=group,_group.value=group,past_community.push(_group)}),$scope.community_groups=past_community,$scope.community_groups.push({name:"add new group"})}),$scope.add=function(newValue){var obj={};obj.name=newValue,obj.value=newValue.name,$scope.events.push(obj),$scope.event=obj,$scope.newValue=""},$scope.add_community=function(){var obj={};""!=$scope._newValue&&(obj.name=$scope._newValue,obj.value=$scope._newValue,$scope.community_groups.push(obj),$scope.community_group=obj,$scope.newValue="")},$scope.form_name="Bristol Culture activities",$scope.age_groups=[],$scope.target_groups=[],$scope.selection=[],$scope.on_site_off_site="",$scope.target_groups.push({name:"Black, Asian, and minority ethnic (BAME)"}),$scope.target_groups.push({name:"Disability"}),$scope.target_groups.push({name:"Lesbian, Gay, Bisexual, and Transgrender (LGBT)"}),$scope.target_groups.push({name:"Children and Young People (CYP)"}),$scope.target_groups.push({name:"Older People"}),$scope.target_groups.push({name:"Socio-economically disadvantaged group"}),$scope.target_groups.push({name:"Faith/Religion"}),$scope.target_groups.push({name:" Health/Wellbeing"}),$scope.deleteUser=function(userToEdit){var idx=$scope.age_groups.indexOf(userToEdit);idx>-1&&$scope.age_groups.splice(idx,1)},$scope.changed=0,$scope.tableChanged=0,$scope.start_date_update=function(target_group){visit_form.date_value_end.value=moment(target_group).format("YYYY-MM-DD")},$scope.kpi_type_update=function(target_group){$scope.selectedkpiValue=target_group},$scope.toggleSelection=function(target_group){var idx=$scope.selection.indexOf(target_group);idx>-1?$scope.selection.splice(idx,1):$scope.selection.push(target_group)},$scope.addCount=function(){if(visit_form.count.value>0){var age_group={name:visit_form.age_group.value,count:visit_form.count.value};console.log("clear age group"),visit_form.age_group.value="",visit_form.count.value="",$scope.age_groups.push(age_group)}},$scope.addtarget_groups=function(){var target_groups={name:visit_form.target_group.value};$scope.target_groups.push(target_groups),visit_form.age_group.value="",visit_form.count.value="",$scope.$apply()},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully :)";message+="\n ",get_table_data_team.getData(moment(new Date).subtract({months:10})._d,$scope),alert(message),visit_form.no_sessions.value="",visit_form.income.value="",visit_form.no_visits.value="",visit_form.no_enquiries.value="",$scope.changed++})}var kpis=new Raw_kpi_events({team_id:visit_form.team.value,event_name:visit_form.event_name.value,kpi_type:visit_form.kpi_type.value,date_logged:new Date,date_value:visit_form.date_value.value,date_value_end:visit_form.date_value_end.value,comments:visit_form.comments.value,no_sessions:visit_form.no_sessions.value,income:visit_form.income.value,no_visits:visit_form.no_visits.value,no_enquiries:visit_form.no_enquiries.value,logger_user_name:$scope.user.username}),query={team_id:visit_form.team.value,event_name:visit_form.event_name.value,kpi_type:visit_form.kpi_type.value,date_value:visit_form.date_value.value,exact:!0};Raw_kpi_events.query(query,function(visits){console.log("Raw_visits",visits.length),save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/kpi-events/performance-form-controller.js","/../components/performance/kpi-events")},{b55mWE:4,buffer:3}],93:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_kpi_events_controller=function($route,$scope,AuthService,get_table_data_team,$http,$q,$routeParams,$location,$rootScope,Raw_kpi_events,data_table_reload,AuthService,grid_ui_settings,table_security){$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.table_class="col-md-5 col-5-12col-sm-5",$scope.show_all_Button=!0,$scope.featured_collection=Raw_kpi_events,$rootScope.featured_collection=Raw_kpi_events,$scope.table_heading="Raw data (editable)",$rootScope.canEdit_table=!0;var teamfilter=$scope.user.team;console.log("teamfilter",teamfilter),"ADMIN"==$scope.user.group&&(teamfilter="#"),$scope.extraQuery={
team_id:teamfilter,kpi_type:"#"};var columnDefs=[];$scope.moused=function(){console.log("moused over")},columnDefs.push({field:"team_id",name:"Team",resizable:!0,width:150},{field:"kpi_type",name:"KPI Type",resizable:!0,width:150,Editable:!1},{field:"event_name",name:"Name of Event",resizable:!0,width:250},{field:"date_value_end",name:"End Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'",width:200},{field:"no_sessions",name:"KPI value",resizable:!0,width:100},{field:"no_visits",name:"No. participants",resizable:!0,width:100},{field:"no_enquiries",name:"No. Enquiries",resizable:!0,width:100},{field:"income",name:"Income",resizable:!0,width:100,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments by",resizable:!0,visible:!1},{field:"count",name:"Total",resizable:!0,width:100,Editable:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data_team.getData(moment(new Date).subtract({months:1e4})._d,$scope),$scope.$watch("changed",function(newValue){newValue>0&&(get_table_data_team.getData(moment(new Date).subtract({months:1e5})._d,$scope),$scope.tableChanged++)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/kpi-events/raw-events-controller.js","/../components/performance/kpi-events")},{b55mWE:4,buffer:3}],94:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.standard_monthly_kpi_events_controller=function(yearly_totals,yearly_percentage_difference,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_standard_kpi_events,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter_retail){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.background_colour="events",$scope.table_heading=$scope.user.team+" monthly kpis",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],columns={field:"stat",cellFilter:"valueFilter",name:"Statistic",width:300,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter_retail},columnDefs.push(columns),$scope.start_date=new Date("04/01/2018"),$scope.end_date=moment($scope.start_date).add("years",1).format("DD/MM/YYYY"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.options_list=[],option=[],option.name="INDEPENDENT",option.value="INDEPENDENT",$scope.options_list.push(option),option=[],option.name="FACILITATED",option.value="FACILITATED",$scope.options_list.push(option),get_data=function(){Monthly_standard_kpi_events.query({team_id:$scope.user.team,kpi_type:"#"},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),"age_group"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),make_a_line_chart.build($scope,columnDefs,"age_group"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push(columns),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"age_group")})})},get_data(),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/kpi-events/standard-monthly-events-controller.js","/../components/performance/kpi-events")},{b55mWE:4,buffer:3}],95:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.age_learning_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Age_learning,make_a_pie){console.log("controller go"),$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];columnDefs.push({field:"museum",name:"Museum",width:"150"},{field:"age_group",name:"Age Group",width:"250"},{field:"2017 total_sessions",name:"No. sessions [2017]",width:"150"},{field:"2017 total_children",name:"No. children [2017]",width:"150"},{field:"2017 total_teachers",name:"No. teachers [2017]",width:"150"},{field:"2017 total_income",name:"Income [2017]",width:"150"}),$scope.gridOptions={columnDefs:columnDefs,enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!1,enableCellEditOnFocus:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){})}},console.log("getData"),Age_learning.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows,$scope.filter_pie=[],$scope.filter_pie.push({value:"2017 total_children",name:"No. children"}),$scope.filter_pie.push({value:"2017 total_sessions",name:"No. sessions"}),$scope.filter_pie.push({value:"2017 total_teachers",name:"No. teachers"}),$scope.filter_pieSelected=$scope.filter_pie[0].name,make_a_pie.build($scope,"2017 total_children","age_group"),$scope.changedValue=function(item){make_a_pie.build($scope,item,"age_group")}}),$scope.chart_title="Age groups"}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/learning/age-learning-controller.js","/../components/performance/learning")},{b55mWE:4,buffer:3}],96:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_learning_controller=function(yearly_totals,yearly_percentage_difference,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_learning,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter_retail){$scope.init=function(session_type){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.background_colour="learning",$scope.table_heading=session_type+" monthly  stats",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],columns={field:"stat",cellFilter:"valueFilter",name:"Statistic",width:300,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter_retail},columnDefs.push(columns),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.options_list=[],option=[],option.name="INDEPENDENT",option.value="INDEPENDENT",$scope.options_list.push(option),option=[],option.name="FACILITATED",option.value="FACILITATED",$scope.options_list.push(option),get_data=function(session_type){console.log("get_data"),Monthly_learning.query({session_type:session_type,cache:!0},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),"age_group"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,yearly_totals.build($scope),yearly_percentage_difference.build($scope),$scope.gridOptions.enableFiltering=!1,make_a_line_chart.build($scope,columnDefs,"age_group"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push(columns),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"age_group")}),$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]})})},get_data(session_type),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/learning/monthly-learning-controller.js","/../components/performance/learning")},{b55mWE:4,buffer:3}],97:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_learning_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_learning,data_table_reload,get_table_data){$scope.extraQuery={session_type:"#",age_group:"#"},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),visit_form.total_sessions.value="",visit_form.total_children.value="",visit_form.total_teachers.value="",visit_form.total_income.value="",visit_form.age_group.value="",visit_form.session_type.comments.value=""})}var kpis=new Raw_learning({museum_id:visit_form.museum.value,kpi_type:"visits",total_sessions:visit_form.total_sessions.value,total_children:visit_form.total_children.value,total_teachers:visit_form.total_teachers.value,total_income:visit_form.total_income.value,age_group:visit_form.age_group.value,session_type:encodeURI(visit_form.session_type.value),date_logged:new Date,date_value:visit_form.date_value.value,date_value_end:visit_form.date_value_end.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,session_type:visit_form.session_type.value,age_group:encodeURI(visit_form.age_group.value),exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_learning.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure for that date - are you sure you want to overwrite it ?")&&(_.each(visits,function(visit){Raw_learning.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/learning/performance-form-controller.js","/../components/performance/learning")},{b55mWE:4,buffer:3}],98:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_learning_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_learning,data_table_reload,AuthService,grid_ui_settings,get_table_data,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_learning,$scope.table_class="col-md-12 col-lg-12 col-sm-5",$rootScope.featured_collection=Raw_learning,$rootScope.canEdit_table=!0,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.extraQuery={session_type:"#",age_group:"#"},columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:90},{field:"session_type",name:"Type",resizable:!0,width:90},{field:"date_value",name:"Week beginning",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'",width:90},{field:"age_group",name:"Age",resizable:!0,width:200},{field:"total_sessions",name:"No. sessions",resizable:!0,width:100},{field:"total_children",name:"No. children",resizable:!0,width:100},{field:"total_teachers",name:"No. teachers",resizable:!0,width:100},{field:"total_income",name:"Total income",resizable:!0,width:100,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!0},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!0}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/learning/raw-learning-controller.js","/../components/performance/learning")},{b55mWE:4,buffer:3}],99:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_learning_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_learning,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly Income stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:95,pinnedLeft:!0,enableColumnMoving:!1},{field:"session_type",name:"Type",width:95,pinnedLeft:!0,enableColumnMoving:!1}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),session_type="INDEPENDENT",Yearly_learning.query({session_type:session_type},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),console.log("count"),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:95,pinnedLeft:!0,enableColumnMoving:!1},{field:"session_type",name:"Type",width:80,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/learning/yearly-learning-controller.js","/../components/performance/learning")},{b55mWE:4,buffer:3}],100:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_operations_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_operations,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Operation stats",$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Visits by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:80,pinnedLeft:!0},{field:"stat",name:"Statistic",width:100}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_operations.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"Visits"==row.stat&&(console.log("visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","Visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/operations/monthly-operations-controller.js","/../components/performance/operations")},{b55mWE:4,buffer:3}],101:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_operations_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_operations,data_table_reload){$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),visit_form.reset(),data_table_reload.setDate(kpis.date_value)})}var kpis=new Raw_operations({museum_id:visit_form.museum.value,kpi_type:"visits",no_complaints:visit_form.no_complaints.value,health_and_safety_forms:visit_form.health_and_safety_forms.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value};Raw_operations.query(query,function(visits){console.log("Raw_visits",visits.length),_.each(visits,function(visit){Raw_operations.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/operations/performance-form-controller.js","/../components/performance/operations")},{b55mWE:4,buffer:3}],102:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_operations_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_operations,data_table_reload,get_table_data,grid_ui_settings,$rootScope,table_security){$scope.table_class="col-md-6 col-lg-6 col-sm-6 full-height",$scope.show_all_Button=!0,$scope.featured_collection=Raw_operations,$rootScope.featured_collection=Raw_operations,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"no_complaints",name:"no_complaints",resizable:!0,width:"150"},{field:"health_and_safety_forms",name:"health_and_safety_forms",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"value",name:"Visitors",resizable:!0,cellFilter:'currency:"" : 5'},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/operations/raw-operations-controller.js","/../components/performance/operations")},{b55mWE:4,buffer:3}],103:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_operations_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_operations,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly Operation stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_operations.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),console.log("visits"),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/operations/yearly-operations-controller.js","/../components/performance/operations")},{b55mWE:4,buffer:3}],104:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.community_events_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_events,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.table_heading="Monthly event figues",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"on_off_site",name:"Type",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"age_group",name:"Age Group",width:80,pinnedLeft:!0,enableColumnMoving:!1}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=[],$scope.chart_stats=[],$scope.selected_museums=[],$scope.get_data=function(event_type){console.log("get_data"),Monthly_events.query({event_type:event_type},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.chart_stats.indexOf(row.museum)==-1&&$scope.chart_stats.push(row.stat),$scope.selected_chart_stats.indexOf(row.museum)==-1&&$scope.selected_chart_stats.push(row.stat),$scope._rows.push(row),row.museum.indexOf("%")==-1&&($scope.selected_museums.indexOf(row.museum)==-1&&$scope.selected_museums.push(row.museum),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"on_off_site",name:"Type",width:80,pinnedLeft:!0,enableColumnMoving:!1},{field:"age_group",name:"Age Group",width:80,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum"),$scope.get_data(item)}})},$scope.options_list=[],$scope.session_type="OFF SITE",option=[],option.name="OFF SITE",option.value="OFF SITE",$scope.options_list.push(option),option=[],option.name="ON SITE",option.value="ON SITE",$scope.options_list.push(option),$scope.get_data("OFF SITE"),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/participation/monthly-participation-controller.js","/../components/performance/participation")},{b55mWE:4,buffer:3}],105:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_participation_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,data_table_reload,Emu_events,get_table_data,Community_groups){$scope.scope=$scope,$scope.events=[],$scope.selected_event=[],$scope.museums=[],$scope.extraQuery={on_site_off_site:"#"},$scope.$watch("event",function(newValue){newValue&&(visit_form.date_value.value=moment(newValue.startDate).format("YYYY-MM-DD"),visit_form.date_value_end.value=moment(newValue.endDate).format("YYYY-MM-DD"),newValue.venue&&(newValue.venue=newValue.venue.replace("M Shed","M-SHED"),newValue.venue=newValue.venue.replace("Bristol Museum & Art Gallery","BMAG"),newValue.venue=newValue.venue.replace("Georgian House","GEORGIAN-HOUSE"),newValue.venue=newValue.venue.replace("The Red Lodge Museum","RED-LODGE"),newValue.venue=newValue.venue.replace("Bristol Archives","BRISTOL-ARCHIVES"),newValue.venue=newValue.venue.replace("Kings Weston Roman Villa","ROMAN-VILLA"),newValue.venue=newValue.venue.replace("Blaise Castle House Museum","BLAISE"),$scope.selected_museum=newValue.venue))}),$scope.museums.push({value:"BMAG",name:"Bristol Museum & Art Gallery"}),$scope.museums.push({value:"M-SHED",name:"M Shed"}),$scope.museums.push({value:"GEORGIAN-HOUSE",name:"The Georgian House Museum"}),$scope.museums.push({value:"RED-LODGE",name:"The Red Lodge"}),$scope.museums.push({value:"BLAISE",name:"Blaise Museum"}),$scope.museums.push({value:"BRISTOL-ARCHIVES",name:"Bristol Archives"}),$scope.museums.push({value:"ROMAN-VILLA",name:"Kings Weston Roman Villas"}),Community_groups.query({},function(groups){past_community=[],_.each(groups,function(group){_group=[],_group.name=group,_group.value=group,past_community.push(_group)}),$scope.community_groups=past_community,$scope.community_groups.push({name:"add new group"})}),Emu_events.getData().then(function(response){past_events=[],_.each(response,function(event){new Date(event.startDate)<=new Date&&"Facilities"!=event.type&&"Poster - Digital Signage"!=event.type&&(past_events.push(event),console.log("past event",event))}),$scope.events=past_events,$scope.events.push({name:"add new event"})}),$scope.add=function(newValue){var obj={};obj.name=newValue,obj.value=newValue.name,$scope.events.push(obj),$scope.event=obj,$scope.newValue=""},$scope.add_community=function(){var obj={};""!=$scope._newValue&&(obj.name=$scope._newValue,obj.value=$scope._newValue,$scope.community_groups.push(obj),$scope.community_group=obj,$scope.newValue="")},$scope.form_name="Bristol Culture activities",$scope.age_groups=[],$scope.target_groups=[],$scope.selection=[],$scope.on_site_off_site="",$scope.target_groups.push({name:"Black, Asian, and minority ethnic (BAME)"}),$scope.target_groups.push({name:"Disability"}),$scope.target_groups.push({name:"Lesbian, Gay, Bisexual, and Transgrender (LGBT)"}),$scope.target_groups.push({name:"Children and Young People (CYP)"}),$scope.target_groups.push({name:"Older People"}),$scope.target_groups.push({name:"Socio-economically disadvantaged group"}),$scope.target_groups.push({name:"Faith/Religion"}),$scope.target_groups.push({name:" Health/Wellbeing"}),$scope.deleteUser=function(userToEdit){var idx=$scope.age_groups.indexOf(userToEdit);idx>-1&&$scope.age_groups.splice(idx,1)},$scope.toggleSelection=function(target_group){var idx=$scope.selection.indexOf(target_group);idx>-1?$scope.selection.splice(idx,1):$scope.selection.push(target_group)},$scope.addCount=function(){if(visit_form.count.value>0){var age_group={name:visit_form.age_group.value,count:visit_form.count.value};console.log("clear age group"),
visit_form.age_group.value="",visit_form.count.value="",$scope.age_groups.push(age_group)}},$scope.addtarget_groups=function(){var target_groups={name:visit_form.target_group.value};$scope.target_groups.push(target_groups),visit_form.age_group.value="",visit_form.count.value="",$scope.$apply()},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),visit_form.on_site_off_site.value="",$scope.age_groups=[],$scope.selection=[],visit_form.event_name.value="",visit_form.community_group="",visit_form.count.value="",visit_form.age_group.value="",visit_form.comments.value="",visit_form.date_value.value="",visit_form.event_lead.value="",visit_form.date_value_end.value=""})}$scope.addCount(),$scope.add_community();var kpis=new Raw_events({museum_id:visit_form.museum.value,kpi_type:"visits",age_groups:$scope.age_groups,on_site_off_site:visit_form.on_site_off_site.value,target_groups:$scope.selection,event_name:$("#event_name").find("option:selected").text(),age_group:visit_form.age_group.value,event_lead:visit_form.event_lead.value,community_group:$("#community_group").find("option:selected").text(),date_logged:new Date,date_value:visit_form.date_value.value,date_value_end:visit_form.date_value_end.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,event_lead:visit_form.event_lead.value,event_name:$("#event_name").find("option:selected").text(),date_value:visit_form.date_value.value,on_site_off_site:visit_form.on_site_off_site.value,exact:!0};Raw_events.query(query,function(visits){console.log("Raw_visits",visits.length),save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/participation/performance-form-controller.js","/../components/performance/participation")},{b55mWE:4,buffer:3}],106:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_events_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_events,data_table_reload,AuthService,grid_ui_settings,get_table_data,table_security){$scope.table_class="col-md-12 col-lg-12col-sm-12 full-height",$scope.show_all_Button=!0,$scope.featured_collection=Raw_events,$rootScope.featured_collection=Raw_events,$rootScope.canEdit_table=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={on_site_off_site:"#"};var columnDefs=[];$scope.moused=function(){console.log("moused over")},columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:100},{field:"date_value",name:"Week beginning",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'",width:90},{field:"on_site_off_site",name:"Site",resizable:!0,width:100},{field:"event_lead",name:"Event Lead",resizable:!0,width:140},{field:"event_name",name:"Name of Event",resizable:!0,width:250},{field:"community_group",name:"Community Group",resizable:!0,width:250},{field:"under_5",name:"Under 5s",resizable:!0,width:100,Editable:!1},{field:"_5_15",name:"5 - 15",resizable:!0,width:100,Editable:!1},{field:"_16_over",name:"Adults 16+",resizable:!0,width:100,Editable:!1},{field:"count",name:"Total",resizable:!0,width:100,Editable:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/participation/raw-participation-controller.js","/../components/performance/participation")},{b55mWE:4,buffer:3}],107:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.target_audience_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Target_audience_event_count,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-5 col-lg-5 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Number of events targetted at specific audiences",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"target_groups",name:"Target Group",width:250,pinnedLeft:!0,enableColumnMoving:!1}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2021"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Target_audience_event_count.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){"undefined"!=typeof row.target_groups&&(console.log("row.target_groups",row.target_groups),$scope._rows.push(row),"count"==row.stat&&(console.log("count"),$scope.data_rows.push(row)),"Target audience"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","count"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"target_groups",name:"Target Group",width:250,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","count")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/participation/target-audience-controller.js","/../components/performance/participation")},{b55mWE:4,buffer:3}],108:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_participation_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_community_groups,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-10 col-lg-10 col-sm-10",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Number of event attendees from community groups",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"community_group",name:"Community Group",width:250,pinnedLeft:!0,enableColumnMoving:!1}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_community_groups.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){"undefined"!=typeof row.community_group&&(console.log("row.community_group",row.community_group),$scope._rows.push(row),"count"==row.stat&&(console.log("count"),$scope.data_rows.push(row)),"Community Group"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","count"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"community_group",name:"Community Group",width:250,pinnedLeft:!0,enableColumnMoving:!1}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","count")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/participation/yearly-participation-controller.js","/../components/performance/participation")},{b55mWE:4,buffer:3}],109:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_patron_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_patron,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_patron){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Fundraised income  by month",$scope.background_colour="patron",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Fundraised income",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_patron}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["patron"],Monthly_patron.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"patron"==row.stat&&(console.log("patron"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_patron}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/patron/monthly-patron-controller.js","/../components/performance/patron")},{b55mWE:4,buffer:3}],110:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.patron_performance_form=function($scope,$http,$q,Raw_patron,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.donation_box_amount.value="",visit_form.no_envelopes.value=""})}$scope.extraQuery={donation_box_no:"#"},$scope.Raw_patron=Raw_patron,$scope.onSubmit=function(){var kpis=new Raw_patron({kpi_type:"visits",donation_box_amount:visit_form.donation_box_amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={type:"0",date_value:visit_form.date_value.value,donation_box_no:0,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_patron.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_patron.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("patron_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/patron/performance-form-controller.js","/../components/performance/patron")},{b55mWE:4,buffer:3}],111:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_patron_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_patron,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_patron,$rootScope.featured_collection=Raw_patron,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={type:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"donation_box_amount",name:"Amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/patron/raw-patron-controller.js","/../components/performance/patron")},{b55mWE:4,buffer:3}],112:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_corporate_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_corporate,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_corporate.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"corporate"==row.stat&&(console.log("corporate"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/patron/yearly-patron-controller.js","/../components/performance/patron")},{b55mWE:4,buffer:3}],113:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.masterKpi=function(){return{controller:"master_kpi_home_controller",templateUrl:"./components/performance/home/master_kpi_dashboard.html"}},exports.kpihomeDashboard=function(){return{controller:"kpi_home_controller",templateUrl:"./components/performance/home/kpi_dashboard.html"}},exports.dateSelect=function(){return{controller:"date_select_controller",templateUrl:"./shared/templates/date_select.html"}},exports.pieChart=function(){return{templateUrl:"./shared/templates/pie_chart.html"}},exports.lineChart=function(){return{templateUrl:"./shared/templates/line_chart.html"}},exports.learningDashboard=function(){return{controller:"dashboard_controller",link:function(scope,element,attrs){$scope.refresh=function(){alert("cheese")}},templateUrl:"./components/performance/retail/dashboard.html"}},exports.learningFormdata=function(){return{templateUrl:"./components/performance/learning/kpi-form-and-data.html"}},exports.rawLearning=function(){return{controller:"raw_learning_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyLearning=function(){return{restrict:"E",scope:{},controller:"yearly_learning_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordLearning=function(){return{controller:"record_learning_controller",templateUrl:"./components/performance/learning/kpi-form.html"}},exports.monthlyLearning=function(){return{restrict:"E",scope:{},link:function(scope,element,attrs){session_type=attrs.sessionType,console.log(attrs),scope.init(session_type)},controller:"monthly_learning_controller",templateUrl:"./shared/templates/data_table.html"}},exports.ageLearning=function(){return{controller:"age_learning_controller",templateUrl:"./shared/templates/data_table.html"}},exports.retailDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/retail/dashboard.html"}},exports.exhibitionspwytDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/exhibitions-pwyt/dashboard.html"}},exports.learningDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/learning/dashboard.html"}},exports.visitsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/visits/dashboard.html"}},exports.venuehireDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/venue-hire/dashboard.html"}},exports.yearlyCorporate=function(){return{restrict:"E",scope:{},controller:"yearly_corporate_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawCorporate=function(){return{controller:"raw_corporate_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataCorporate=function(){return{templateUrl:"./components/performance/corporate/data.html"}},exports.monthlyCorporate=function(){return{controller:"monthly_corporate_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordCorporate=function(){return{controller:"corporate_performance_form",templateUrl:"./components/performance/corporate/kpi-form.html"}},exports.corporateFormdata=function(){return{templateUrl:"./components/performance/corporate/kpi-form-and-data.html"}},exports.yearlyPatron=function(){return{restrict:"E",scope:{},controller:"yearly_patron_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawPatron=function(){return{controller:"raw_patron_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataPatron=function(){return{templateUrl:"./components/performance/patron/data.html"}},exports.monthlyPatron=function(){return{controller:"monthly_patron_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordPatron=function(){return{controller:"patron_performance_form",templateUrl:"./components/performance/patron/kpi-form.html"}},exports.patronFormdata=function(){return{templateUrl:"./components/performance/patron/kpi-form-and-data.html"}},exports.donationsboxesDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-boxes/dashboard.html"}},exports.donationsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations/dashboard.html"}},exports.donationsKioskdashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/donations-kiosk/dashboard.html"}},exports.welcomedeskFormdata=function(){return{templateUrl:"./components/performance/welcome-desk/kpi-form-and-data.html"}},exports.rawWelcomedesk=function(){return{controller:"raw_welcomedesk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataWelcomedesk=function(){return{templateUrl:"./components/performance/welcome-desk/data.html"}},exports.dataxExhibitionspwyt=function(){return{templateUrl:"./components/performance/exhibitions-pwyt/data.html"}},exports.welcomedeskDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/welcome-desk/dashboard.html"}},exports.recordWelcomedesk=function(){return{controller:"record_welcomedesk_controller",templateUrl:"./components/performance/welcome-desk/kpi-form.html"}},exports.yearlyWelcomedesk=function(){return{restrict:"E",scope:{},controller:"yearly_welcomedesk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyWelcomedesk=function(){return{controller:"monthly_welcomedesk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataxVisits=function(){return{templateUrl:"./components/performance/visits/data.html"}},exports.dataxVenuehire=function(){return{templateUrl:"./components/performance/venue-hire/data.html"}},exports.rawVisits=function(){return{controller:"raw_visitor_numbers_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawVenuehire=function(){return{controller:"raw_venue_hire_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyVisits=function(){return{restrict:"E",scope:{},controller:"monthly_visitor_numbers_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyVenuehire=function(){return{restrict:"E",scope:{},link:function(scope,element,attrs){booking_type=attrs.bookingType,console.log(attrs),scope.init(booking_type)},controller:"monthly_venue_hire_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyVisits=function(){return{restrict:"E",scope:{},controller:"yearly_visitor_numbers_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyVenuehire=function(){return{restrict:"E",scope:{},controller:"yearly_venue_hire_controller",templateUrl:"./shared/templates/data_table.html"}},exports.giftaidFormdata=function(){return{templateUrl:"./components/performance/gift-aid/kpi-form-and-data.html"}},exports.rawGiftaid=function(){return{controller:"raw_giftaid_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataGiftaid=function(){return{templateUrl:"./components/performance/gift-aid/data.html"}},exports.recordGiftaid=function(){return{controller:"record_giftaid_controller",templateUrl:"./components/performance/gift-aid/kpi-form.html"}},exports.monthlyAllgiftaid=function(){return{restrict:"E",scope:{},controller:"monthly_all_giftaid_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyGiftaid=function(){return{restrict:"E",scope:{},controller:"monthly_giftaid_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyDonationsother=function(){return{restrict:"E",scope:{},controller:"yearly_donations_other_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationskiosk=function(){return{controller:"raw_donations_kiosk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationsother=function(){return{controller:"raw_donations_other_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataDonationskiosk=function(){return{templateUrl:"./components/performance/donations-kiosk/data.html"}},exports.monthlyDonationsbox=function(){return{controller:"monthly_donations_box_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyDonationskiosk=function(){return{controller:"monthly_donations_kiosk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonationskiosk=function(){return{controller:"raw_donations_kiosk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dayDonationskiosk=function(){return{controller:"daily_donations_kiosk_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataDonationsother=function(){return{templateUrl:"./components/performance/donations-other/data.html"}},exports.monthlyDonationsother=function(){return{controller:"monthly_donations_other_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlySitepermissions=function(){return{restrict:"E",scope:{},controller:"yearly_sitepermissions_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawSitepermissions=function(){return{controller:"raw_site_permissions_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataSitepermissions=function(){return{templateUrl:"./components/performance/site_permissions/data.html"}},exports.monthlySitepermissions=function(){return{restrict:"E",scope:{},controller:"monthly_site_permissions_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyDonations=function(){return{restrict:"E",scope:{},controller:"yearly_donations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawDonations=function(){return{controller:"raw_donations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.dataDonations=function(){return{templateUrl:"./components/performance/donations/data.html"}},exports.monthlyDonations=function(){return{restrict:"E",scope:{},controller:"monthly_donations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawTurnstiles=function(){return{controller:"raw_turnstiles_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyTurnstiles=function(){return{controller:"monthly_turnstiles_controller",templateUrl:"./shared/templates/data_table.html"}},exports.donationskioskFormdata=function(){return{templateUrl:"./components/performance/donations-kiosk/kpi-form-and-data.html"}},exports.recordDonationskiosk=function(){return{controller:"donations_kiosk_performance_form",templateUrl:"./components/performance/donations-kiosk/kpi-form.html"}},exports.donationsotherFormdata=function(){return{templateUrl:"./components/performance/donations-other/kpi-form-and-data.html"}},exports.recordDonationsother=function(){return{controller:"donations_other_performance_form",templateUrl:"./components/performance/donations-other/kpi-form.html"}},exports.recordDonations=function(){return{controller:"donations_performance_form",templateUrl:"./components/performance/donations/kpi-form.html"}},exports.donationsFormdata=function(){return{templateUrl:"./components/performance/donations/kpi-form-and-data.html"}},exports.sitepermissionsFormdata=function(){return{templateUrl:"./components/performance/site_permissions/kpi-form-and-data.html"}},exports.kpiForm=function(){return{controller:"visits_form",templateUrl:"./components/performance/visits/kpi-form.html"}},exports.venuehireForm=function(){return{controller:"venue_hire_form",templateUrl:"./components/performance/venue-hire/kpi-form.html"}},exports.venuehireFormdata=function(){return{templateUrl:"./components/performance/venue-hire/kpi-form-and-data.html"}},exports.visitsFormdata=function(){return{templateUrl:"./components/performance/visits/kpi-form-and-data.html"}},exports.retailFormdata=function(){return{templateUrl:"./components/performance/retail/kpi-form-and-data.html"}},exports.retailKpiform=function(){return{controller:"retail_performance_form",templateUrl:"./components/performance/retail/kpi-form.html"}},exports.retailUploader=function(){return{controller:"retail_uploader",templateUrl:"./components/performance/uploader/poster-form.html"}},exports.kioskUploader=function(){return{controller:"kiosk_uploader",templateUrl:"./components/performance/uploader/poster-form.html"}},exports.yearlyRetailsales=function(){return{restrict:"E",scope:{},controller:"yearly_retail_sales_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawRetailsales=function(){return{controller:"raw_retail_sales_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawRetailsalesfilter=function(){return{templateUrl:"./components/performance/retail/raw-retail-data.html"}},exports.monthlyRetailsales=function(){return{restrict:"E",scope:{},controller:"monthly_retail_sales_controller",templateUrl:"./shared/templates/data_table.html"}},exports.exhibitionspwytFormdata=function(){return{templateUrl:"./components/performance/exhibitions-pwyt/kpi-form-and-data.html"}},exports.recordExhibitionspwyt=function(){return{controller:"exhibitions_pwyt_performance_form",templateUrl:"./components/performance/exhibitions-pwyt/kpi-form.html"}},exports.monthlyExhibitionspwyt=function(){return{restrict:"E",scope:{},controller:"monthly_exhibitions_pwyt_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawExhibitionspwyt=function(){return{controller:"raw_exhibitions_pwyt_controller",templateUrl:"./shared/templates/data_table.html"}},exports.tegFormdata=function(){return{templateUrl:"./components/performance/gallery-visits/kpi-form-and-data.html"}},exports.recordTeg=function(){return{controller:"teg_performance_form",templateUrl:"./components/performance/gallery-visits/kpi-form.html"}},exports.monthlyTeg=function(){return{controller:"monthly_teg_controller",
templateUrl:"./shared/templates/data_table.html"}},exports.exhibitionsTeg=function(){return{restrict:"E",scope:{},controller:"exhibitions_teg_controller",templateUrl:"./shared/templates/data_table.html"}},exports.yearlyTeg=function(){return{restrict:"E",scope:{},controller:"yearly_teg_controller",templateUrl:"./shared/templates/data_table.html"}},exports.weeklyTeg=function(){return{restrict:"E",scope:{},controller:"weekly_teg_controller",templateUrl:"./shared/templates/data_table.html"}},exports.sitepermissionsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/site_permissions/dashboard.html"}},exports.tegDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/gallery-visits/dashboard.html"}},exports.yearlyEvents=function(){return{restrict:"E",scope:{},controller:"yearly_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyEvents=function(){return{restrict:"E",scope:{},link:function(scope,element,attrs){event_type=attrs.eventType,console.log(attrs),scope.init(event_type)},controller:"monthly_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.eventsFormdata=function(){return{templateUrl:"./components/performance/events/kpi-form-and-data.html"}},exports.kpieventsFormdata=function(){return{templateUrl:"./components/performance/kpi-events/kpi-form-and-data.html"}},exports.rawEventsfilter=function(){return{templateUrl:"./components/performance/events/raw-events-data.html"}},exports.rawKpieventsfilter=function(){return{templateUrl:"./components/performance/kpi-events/raw-events-data.html"}},exports.rawKpieventsx=function(){return{restrict:"E",scope:{user:"=",changed:"=",tableChanged:"="},link:function(scope,element,attrs){team=attrs.team,console.log(attrs)},controller:"raw_kpi_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.standardkpieventstransformationDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/team-kpis/transformation-dashboard.html"}},exports.standardkpieventsengagementDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/team-kpis/engagement-dashboard.html"}},exports.standardkpieventscollectionsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/team-kpis/collections-dashboard.html"}},exports.teamStandardkpievents=function(){return{restrict:"E",scope:{user:"=",changed:"=",tableChanged:"="},link:function(scope,element,attrs){team=attrs.team,console.log(attrs),scope.init(team)},controller:"team_monthly_kpi_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyStandardkpievents=function(){return{restrict:"E",scope:{user:"=",changed:"=",tableChanged:"="},link:function(scope,element,attrs){event_type=attrs.eventType,console.log(attrs)},controller:"standard_monthly_kpi_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.monthlyKpievents=function(){return{restrict:"E",scope:{user:"=",changed:"=",tableChanged:"="},controller:"monthly_kpi_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawEvents=function(){return{controller:"raw_events_controller",templateUrl:"./shared/templates/data_table.html"}},exports.communityEvents=function(){return{restrict:"E",scope:{},controller:"yearly_participation_controller",templateUrl:"./shared/templates/data_table.html"}},exports.targetAudience=function(){return{restrict:"E",scope:{},controller:"target_audience_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordKpievents=function(){return{controller:"record_kpi_events_controller",templateUrl:"./components/performance/kpi-events/kpi-form.html"}},exports.recordSitepermissions=function(){return{controller:"site_permissions_performance_form",templateUrl:"./components/performance/site_permissions/kpi-form.html"}},exports.recordEvents=function(){return{controller:"record_events_controller",templateUrl:"./components/performance/events/kpi-form.html"}},exports.eventsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/events/dashboard.html"}},exports.participationDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/participation/dashboard.html"}},exports.tegDatax=function(){return{controller:"raw_teg_controller",templateUrl:"./shared/templates/data_table.html"}},exports.rawTeg=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/gallery-visits/dashboard2.html"}},exports.monthlyOperations=function(){return{controller:"monthly_operations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.operationsFormdata=function(){return{templateUrl:"./components/performance/operations/kpi-form-and-data.html"}},exports.rawOperations=function(){return{controller:"raw_operations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordOperations=function(){return{controller:"record_operations_controller",templateUrl:"./components/performance/operations/kpi-form.html"}},exports.yearlyOperations=function(){return{restrict:"E",scope:{},controller:"yearly_operations_controller",templateUrl:"./shared/templates/data_table.html"}},exports.operationsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/operations/dashboard.html"}},exports.exhibitionsDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/exhibitions/dashboard.html"}},exports.giftaidDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/gift-aid/dashboard.html"}},exports.patronDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/patron/dashboard.html"}},exports.corporateDashboard=function(){return{controller:"dashboard_controller",templateUrl:"./components/performance/corporate/dashboard.html"}},exports.exhibitionsSummary=function(){return{restrict:"E",scope:{},controller:"exhibitions_summary_controller",templateUrl:"./shared/templates/data_table.html"}},exports.analyserDashboard=function(){return{controller:"analyser_controller",templateUrl:"./components/performance/analyser/dashboard.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/performance-directive.js","/../components/performance")},{b55mWE:4,buffer:3}],114:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_retail_sales_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_retail_sales,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,table_security,dynamicTableCellFilter_retail){dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.background_colour="retail",dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],$scope.table_heading="Monthly retail sales",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],$rootScope.canEdit_table=!1,columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"60",pinnedLeft:!0,cellClass:dynamicTableCellFilter_retail},{field:"comments",name:"comments",resizable:!0,visible:!1},{field:"logger_user_name",name:"Logged by",resizable:!0,visible:!1},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["Net sales"],Monthly_retail_sales.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,yearly_totals.build($scope),yearly_percentage_difference.build($scope),$scope.gridOptions.enableFiltering=!1,make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"180",pinnedLeft:!0,cellClass:dynamicTableCellFilter_retail}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/retail/monthly-retail-sales-controller.js","/../components/performance/retail")},{b55mWE:4,buffer:3}],115:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.retail_performance_form=function($scope,$http,$q,$routeParams,$location,$rootScope,Retail_sales,data_table_reload,get_table_data){$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",get_table_data.getData(moment(new Date(visit_form.date_value.value)).subtract({months:1})._d,$scope),visit_form.total_sales.value="",visit_form.non_vat_sales.value="",visit_form.no_transactions.value="",alert(message)})}var kpis=new Retail_sales({museum_id:visit_form.museum.value,kpi_type:"visits",total_sales:visit_form.total_sales.value,non_vat_sales:visit_form.non_vat_sales.value,no_transactions:visit_form.no_transactions.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:"",logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,exact:!0,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Retail_sales.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure of "+JSON.stringify(visits[0])+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Retail_sales.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/retail/performance-form-controller.js","/../components/performance/retail")},{b55mWE:4,buffer:3}],116:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_retail_sales_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Retail_sales,data_table_reload,AuthService,get_table_data,grid_ui_settings,table_security){$scope.table_class="col-md-12 col-lg-12 col-sm-12 full-height",$scope.featured_collection=Retail_sales,$rootScope.featured_collection=Retail_sales,$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data="__data";var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"70"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yyyy'"},{field:"total_sales",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"non_vat_sales",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"net_sales",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"no_transactions",resizable:!0},{field:"average_transaction",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"taxes",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",name:"comments",resizable:!0,visible:!1},{field:"logger_user_name",name:"Logged by",resizable:!0,visible:!1},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/retail/raw-retail-sales-controller.js","/../components/performance/retail")},{b55mWE:4,buffer:3}],117:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.retail_uploader=function($scope,$http,$q,Resources,Posters,data_table_reload,get_table_data,timeline_functions,$routeParams){if("rooms"==$routeParams.mode){$scope.name_of_form="Select room"}else{$scope.name_of_form="Select Equipment"}$scope.extraQuery={museum_id:"#"},$scope.rooms=[];var _room=[];_room.name="BMAG",$scope.rooms.push(_room);var _room=[];_room.name="MSHED",$scope.rooms.push(_room);var _room=[];_room.name="ALL VENUES",$scope.rooms.push(_room),$scope.Posters=Posters,console.log("user",$scope.user);$scope.selected_room="",$scope.room_change=function(room){$scope.selected_room=room.name};var content="file content for example",blob=new Blob([content],{type:"text/plain"});$scope.url=(window.URL||window.webkitURL).createObjectURL(blob),$scope.onSubmit=function(){var files=[];_.each($("#upload-input").get(0).files,function(file){var _file={};_file.name=file.name,_file.type=file.type,files.push(_file),console.log(_file)})},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}}),$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var files=$(this).get(0).files;if(files.length>0){for(var formData=new FormData,i=0;i<files.length;i++){var file=files[i];file.comments=visit_form.name.value,formData.append("uploads[]",file,file.name),console.log(file)}$.ajax({url:"/upload/data",type:"POST",data:formData,processData:!1,contentType:!1,success:function(data){console.log("upload successful!\n"+data),$.ajax({url:"/download/"+file.name+".log/data",type:"GET",success:function(response){$("#logtext").text(response)},error:function(XMLHttpRequest,textStatus,errorThrown){}})},xhr:function(){var xhr=new XMLHttpRequest;return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(100*percentComplete),$(".progress-bar").text(percentComplete+"%"),$(".progress-bar").width(percentComplete+"%"),100===percentComplete&&$(".progress-bar").html("Done")}},!1),xhr}})}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/retail/retail-uploader-controller.js","/../components/performance/retail")},{b55mWE:4,buffer:3}],118:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_retail_sales_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_retail_sales,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_retail_sales.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"visits"==row.stat&&(console.log("visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/retail/yearly-retail-sales-controller.js","/../components/performance/retail")},{b55mWE:4,buffer:3}],119:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_site_permissions_controller=function(getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_site_permissions,make_a_pie,make_a_line_chart,monthly_data_table_columns_retail,grid_ui_settings,data_table_reload,table_security,dynamicTableCellFilter_donations){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading=" Site Permissions data  by month",$scope.background_colour="site_permissions",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Site Permissions",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["site_permissions"],Monthly_site_permissions.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope._rows.push(row),"site_permissions"==row.stat&&(console.log("site_permissions"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"stat",cellFilter:"valueFilter",name:"Statistic",width:"300",pinnedLeft:!0,cellClass:dynamicTableCellFilter_donations}),columnDefs=columnDefs.concat(monthly_data_table_columns_retail.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/site_permissions/monthly-site_permissions-controller.js","/../components/performance/site_permissions")},{b55mWE:4,buffer:3}],120:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.site_permissions_performance_form=function($scope,$http,$q,Raw_site_permissions,data_table_reload,get_table_data_nomusem){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.no_events.value="",visit_form.no_cancelled_events.value="",visit_form.audience_figures.value="",visit_form.income_bcc.value="",visit_form.income_site_permissions.value=""})}$scope.extraQuery={donation_box_no:"#"},$scope.Raw_site_permissions=Raw_site_permissions,$scope.onSubmit=function(){var kpis=new Raw_site_permissions({kpi_type:"visits",donation_box_no:0,no_events:visit_form.no_events.value,no_cancelled_events:visit_form.no_cancelled_events.value,audience_figures:visit_form.audience_figures.value,income_bcc:visit_form.income_bcc.value,income_site_permissions:visit_form.income_site_permissions.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={type:"0",date_value:visit_form.date_value.value,donation_box_no:0,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_site_permissions.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_site_permissions.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("site_permissions_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/site_permissions/performance-form-controller.js","/../components/performance/site_permissions")},{b55mWE:4,buffer:3}],121:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_site_permissions_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_site_permissions,data_table_reload,get_table_data_nomusem,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Raw_site_permissions,$rootScope.featured_collection=Raw_site_permissions,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={type:"#",donation_box_no:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"no_events",name:"no_events",resizable:!0},{field:"no_cancelled_events",name:"no_cancelled_events",resizable:!0},{field:"audience_figures",name:"audience_figures",resizable:!0},{field:"income_bcc",name:"income_bcc",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"income_site_permissions",name:"income_site_permissions",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"income_remaining",name:"income_remaining",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data_nomusem.getData(moment(new Date).subtract({months:1})._d,$scope,!0)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/site_permissions/raw-site_permissions-controller.js","/../components/performance/site_permissions")},{b55mWE:4,buffer:3}],122:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_corporate_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_corporate,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_corporate.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"corporate"==row.stat&&(console.log("corporate"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/site_permissions/yearly-site_permissions-controller.js","/../components/performance/site_permissions")},{b55mWE:4,buffer:3}],123:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.team_monthly_kpi_events_controller=function(yearly_totals,yearly_percentage_difference,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_standard_kpi_events,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter_retail){$scope.init=function(team){$scope.team=team,$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.background_colour="events",$scope.table_heading=$scope.team+" monthly kpis",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],columns={field:"stat",cellFilter:"valueFilter",name:"Statistic",width:300,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter_retail},columnDefs.push(columns),dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.options_list=[],option=[],option.name="INDEPENDENT",option.value="INDEPENDENT",$scope.options_list.push(option),option=[],option.name="FACILITATED",option.value="FACILITATED",$scope.options_list.push(option),get_data=function(){console.log("get_data"),Monthly_standard_kpi_events.query({team_id:$scope.team,kpi_type:"#"},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),"age_group"==row.stat&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,$scope.gridOptions.enableFiltering=!1,yearly_totals.build($scope),yearly_percentage_difference.build($scope),make_a_line_chart.build($scope,columnDefs,"age_group"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push(columns),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"age_group")})})},get_data(),$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.changedValue=function(item){console.log("filter"),$scope.get_data(item)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/team-kpis/standard-monthly-events-controller.js","/../components/performance/team-kpis")},{b55mWE:4,buffer:3}],124:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_turnstiles_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_turnstiles,grid_ui_settings,table_security){console.log("controller go"),$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$rootScope.canEdit_table=!1,columnDefs.push({field:"exhibition",name:"Exhibition",width:"150",pinnedLeft:!0},{field:"Apr 2017",name:"Apr 17",width:"100"},{field:"May 2017",name:"May 17",width:"100"},{field:"Jun 2017",name:"Jun 17",width:"100"},{field:"Jul 2017",name:"Jul 17",width:"100"},{field:"Aug 2017",name:"Aug 17",width:"100"},{field:"Sep 2017",name:"Sep 17",width:"100"},{field:"Oct 2017",name:"Oct 17",width:"100"},{field:"Nov 2017",
name:"Nov 17",width:"100"},{field:"Dec 2017",name:"Dec 17",width:"100"},{field:"Jan 2018",name:"Jan 18",width:"100"},{field:"Feb 2018",name:"Feb 18",width:"100"},{field:"Mar 2018",name:"Mar 18",width:"100"}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_turnstiles.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/turnstiles/monthly-turnstiles-controller.js","/../components/performance/turnstiles")},{b55mWE:4,buffer:3}],125:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_turnstiles_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,day_turnstiles,data_table_reload,get_table_data,grid_ui_settings,table_security){$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.featured_collection=day_turnstiles,$rootScope.featured_collection=day_turnstiles,$scope.show_all_Button=!0,$scope.extraQuery={museum_id:"#"};var columnDefs=[];columnDefs.push({field:"museum_id",name:"Museum",resizable:!0},{field:"exhibition",name:"Exhibition",resizable:!0},{field:"date_value",value:"Date",resizable:!0,type:"date",cellFilter:"date:'yyyy/MM/dd '"},{field:"visits",name:"Visits",resizable:!0}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/turnstiles/raw-turnstiles-controller.js","/../components/performance/turnstiles")},{b55mWE:4,buffer:3}],126:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_venue_hire_controller=function(yearly_percentage_difference,yearly_totals,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_venue_hire,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter){$scope.init=function(booking_type){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.table_heading=booking_type+" Venue Hire",$scope.background_colour="venue",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.selected_museums=[],$scope.selected_chart_stats=["Visits"],dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1];var columnDefs=[];$scope.rowFormatter=function(row){return console.log("row",row),"male"===row.entity.gender},$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:200,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter}),$scope.start_date=new Date("04/01/2019"),$scope.end_date=moment($scope.start_date).add("years",1).format("DD/MM/YYYY"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.gridOptions.enableFiltering=!1,Monthly_venue_hire.query({booking_type:booking_type},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope.selected_museums.indexOf(row.museum)==-1&&$scope.selected_museums.push(row.museum),$scope._rows.push(row),row.museum.indexOf("%")==-1&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,yearly_totals.build($scope),yearly_percentage_difference.build($scope),$scope.genericMap=function(hash){return function(input){return input?hash[input]:""}},make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:200,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.$on("date:updated",function(event,data){$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")}})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/venue-hire/monthly-visits-controller.js","/../components/performance/venue-hire")},{b55mWE:4,buffer:3}],127:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_venue_hire_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_venue_hire,data_table_reload,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,get_table_data,table_security){$scope.table_class="col-md-6 col-lg-6 col-sm-1 full-height",$scope.featured_collection=Raw_venue_hire,$rootScope.featured_collection=Raw_venue_hire,$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data="__data";var columnDefs=[];$rootScope.canEdit_table=!0,$scope.start=new Date("04/01/2018"),$scope.end_date=moment($scope.start_date).add("years",1).format("DD/MM/YYYY"),columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,enableFiltering:!0},{field:"booking_type",name:"Booking type",resizable:!0,visible:!0},{field:"income_source",name:"Source",resizable:!0,visible:!0},{field:"value",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yyyy'"},{field:"comments",name:"comments",resizable:!0,visible:!1},{field:"logger_user_name",name:"Logged by",resizable:!0,visible:!0},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yyyy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/venue-hire/raw-visits-controller.js","/../components/performance/venue-hire")},{b55mWE:4,buffer:3}],128:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.venue_hire_form=function($scope,$http,$q,$routeParams,$location,Raw_venue_hire,data_table_reload,get_table_data){$scope.visitor_groups=[],$scope.extraQuery={booking_type:"#",age_group:"#"},$scope.deleteUser=function(userToEdit){visit_form.no_visits.value=0;var idx=$scope.visitor_groups.indexOf(userToEdit);idx>-1&&$scope.visitor_groups.splice(idx,1),_.each($scope.visitor_groups,function(no_visits){visit_form.no_visits.value=parseInt(visit_form.no_visits.value)+parseInt(no_visits.count)})},$scope.addCount=function(){visit_form.no_visits.value=0;var visitor_groups={name:visit_form.visitor_groups.value,count:visit_form.count.value};$scope.visitor_groups.push(visitor_groups),_.each($scope.visitor_groups,function(no_visits){visit_form.no_visits.value=parseInt(visit_form.no_visits.value)+parseInt(no_visits.count)})},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",visit_form.no_visits.value="",get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),alert(message)})}var kpis=new Raw_venue_hire({museum_id:visit_form.museum.value,kpi_type:"visits",value:visit_form.no_visits.value,visitor_groups:$scope.visitor_groups,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,booking_type:encodeURI(visit_form.booking_type.value),income_source:visit_form.income_source.value,customer:visit_form.customer.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,booking_type:encodeURI(visit_form.booking_type.value),date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_venue_hire.query(query,function(visits){console.log("Raw_venue_hire",visits.length),save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/venue-hire/visits-form-controller.js","/../components/performance/venue-hire")},{b55mWE:4,buffer:3}],129:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_venue_hire_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_venue_hire,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2016"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_venue_hire.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"visits"==row.stat&&(console.log("visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/venue-hire/yearly-visits-controller.js","/../components/performance/venue-hire")},{b55mWE:4,buffer:3}],130:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_visitor_numbers_controller=function(yearly_totals,yearly_percentage_difference,getDateService,$route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_visits,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security,dynamicTableCellFilter){dates=getDateService.getDate(),$scope.start_date=dates[0],$scope.end_date=dates[1],$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.table_heading="Bristol Culture Monthly Visitor Figures",$scope.background_colour="visits",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$rootScope.canEdit_table=!1,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.selected_museums=[],$scope.selected_chart_stats=["Visits"];var columnDefs=[];$scope.rowFormatter=function(row){return console.log("row",row),"male"===row.entity.gender},$scope.filter_pie=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:200,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.gridOptions.enableFiltering=!1,Monthly_visits.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope.selected_museums.indexOf(row.museum)==-1&&$scope.selected_museums.push(row.museum),$scope._rows.push(row),row.museum.indexOf("%")==-1&&$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,yearly_totals.build($scope),yearly_percentage_difference.build($scope),$scope.genericMap=function(hash){return function(input){return input?hash[input]:""}},make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.$on("date:updated",function(event,data){console.log(data),$scope.start_date=data[0],$scope.end_date=data[1]}),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",cellFilter:"valueFilter",name:"Museum",width:200,pinnedLeft:!0,enableColumnMoving:!1,cellClass:dynamicTableCellFilter}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/visits/monthly-visits-controller.js","/../components/performance/visits")},{b55mWE:4,buffer:3}],131:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_visitor_numbers_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_visits,data_table_reload,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,get_table_data,table_security){$scope.table_class="col-md-6 col-lg-6 col-sm-1 full-height",$scope.featured_collection=Raw_visits,$rootScope.featured_collection=Raw_visits,$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data="__data";var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,enableFiltering:!0},{field:"kpi_type",name:"kpi",resizable:!0,visible:!1},{field:"value",resizable:!0},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yyyy'"},{field:"comments",name:"comments",resizable:!0,visible:!1},{field:"logger_user_name",name:"Logged by",resizable:!0,visible:!0},{field:"date_logged",name:"Date logged",type:"date",cellFilter:"date:'dd/MM/yyyy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/visits/raw-visits-controller.js","/../components/performance/visits")},{b55mWE:4,buffer:3}],132:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.visits_form=function($scope,$http,$q,$routeParams,$location,Raw_visits,data_table_reload,get_table_data){$scope.visitor_groups=[],$scope.deleteUser=function(userToEdit){visit_form.no_visits.value=0;var idx=$scope.visitor_groups.indexOf(userToEdit);idx>-1&&$scope.visitor_groups.splice(idx,1),_.each($scope.visitor_groups,function(no_visits){visit_form.no_visits.value=parseInt(visit_form.no_visits.value)+parseInt(no_visits.count)})},$scope.addCount=function(){visit_form.no_visits.value=0;var visitor_groups={name:visit_form.visitor_groups.value,count:visit_form.count.value};$scope.visitor_groups.push(visitor_groups),_.each($scope.visitor_groups,function(no_visits){visit_form.no_visits.value=parseInt(visit_form.no_visits.value)+parseInt(no_visits.count)})},$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",visit_form.no_visits.value="",get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),alert(message)})}var kpis=new Raw_visits({museum_id:visit_form.museum.value,kpi_type:"visits",value:visit_form.no_visits.value,visitor_groups:$scope.visitor_groups,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,exact:!0,end_value:moment(new Date).format("YYYY-MM-DD")};Raw_visits.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_visits.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/visits/visits-form-controller.js","/../components/performance/visits")},{b55mWE:4,buffer:3}],133:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_visitor_numbers_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_visits,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2016"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_visits.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"visits"==row.stat&&(console.log("visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/visits/yearly-visits-controller.js","/../components/performance/visits")},{b55mWE:4,buffer:3}],134:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_welcomedesk_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_welcomedesk,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.chart_class="col-md-8 col-lg-8 col-sm-5 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",console.log("controller go"),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),$scope.table_heading="Monthly data",$scope.chart_heading="Data  by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];$scope.filter_pie=[],$rootScope.canEdit_table=!1,columnDefs.push({field:"museum",name:"Museum",width:"40",pinnedLeft:!0},{field:"stat",name:"Statistic",width:"160",pinnedLeft:!0}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),$scope.museums=[],$scope.selected_chart_stats=["Net sales"],Monthly_welcomedesk.query({},function(team){$scope.rows=[],$scope._rows=[],$scope.data_rows=[],_.each(team,function(row){""!=row.museum&&($scope._rows.push(row),$scope.museums.indexOf(row.museum)==-1&&$scope.museums.push(row.museum),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum"),$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:"150",pinnedLeft:!0},{field:"stat",name:"Statistic",width:"180",pinnedLeft:!0}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum")}),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/welcome-desk/monthly-welcomedesk-controller.js","/../components/performance/welcome-desk")},{b55mWE:4,buffer:3}],135:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_welcomedesk_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,Raw_welcomedesk,data_table_reload,grid_ui_settings,get_table_data){$scope.onSubmit=function(){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),visit_form.cash.value="",visit_form.no_transactions.value="",visit_form.no_giftaid_envelopes.value="",visit_form.giftaid_amount.value="",get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)})}var kpis=new Raw_welcomedesk({museum_id:visit_form.museum.value,kpi_type:"visits",cash:visit_form.cash.value,no_transactions:visit_form.no_transactions.value,no_giftaid_envelopes:visit_form.no_giftaid_envelopes.value,giftaid_amount:visit_form.giftaid_amount.value,date_logged:new Date,date_value:visit_form.date_value.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={museum_id:visit_form.museum.value,date_value:visit_form.date_value.value,exact:!0};Raw_welcomedesk.query(query,function(visits){console.log("Raw_visits",visits.length),visits.length>0?confirm("we already have a figure of "+JSON.stringify(visits[0])+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Raw_welcomedesk.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/welcome-desk/performance-form-controller.js","/../components/performance/welcome-desk")},{b55mWE:4,buffer:3}],136:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_welcomedesk_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Raw_welcomedesk,data_table_reload,get_table_data,grid_ui_settings,table_security){$scope.show_all_Button=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.featured_collection=Raw_welcomedesk,$rootScope.featured_collection=Raw_welcomedesk;var columnDefs=[];$rootScope.canEdit_table=!0,$scope.show_all_Button=!0,columnDefs.push({field:"museum_id",name:"Museum",resizable:!0,width:"150"},{field:"date_value",name:"Date",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy'"},{field:"cash",name:"Cash",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"card",name:"Card",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"no_transactions",name:"No. of transactions",resizable:!0},{field:"no_giftaid_envelopes",name:"No. of gift aid envelopes",resizable:!0},{field:"giftaid_amount",name:"Gift aid amount",resizable:!0,cellFilter:'currency:"&pound;" : 2'},{field:"total",name:"Total",resizable:!0},{field:"total_inc_giftaid",name:"Total inc. gift aid",resizable:!0},{field:"comments",name:"Comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/welcome-desk/raw-welcomedesk-controller.js","/../components/performance/welcome-desk")},{b55mWE:4,buffer:3}],137:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_welcomedesk_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_welcomedesk,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-4 col-lg-4 col-sm-5",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"museum",name:"Museum",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:150,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_welcomedesk.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),console.log("visits"),$scope.data_rows.push(row))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"museum",name:"Museum",width:90},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/performance/welcome-desk/yearly-welcomedesk-controller.js","/../components/performance/welcome-desk")},{b55mWE:4,buffer:3}],138:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.edit_booking_controller=function($scope,$http,$q,Resources,Bookings,data_table_reload,get_table_data,timeline_functions,$routeParams){function save(query,update){setupArray=update,Bookings.update(query,setupArray,function(err,affected,resp){err&&console.log(err),affected&&console.log(affected),resp&&console.log(resp)})}if(console.log("routeParams",$routeParams),"rooms"==$routeParams.mode){var mode="room",mode_name="ROOM BOOKING";$scope.name_of_form="Select room"}else{var mode="equipment",mode_name="EQUIPMENT BOOKING";$scope.name_of_form="Select Equipment"}$scope.$watch("room",function(room){room&&(console.log(room),$scope.selected_room=room)}),$scope.extraQuery={museum_id:"#"},$scope.rooms=[],$scope.Resources=Resources;var query={name:"#",type:mode,exact:!1};Resources.query(query,function(rooms){_.each(rooms,function(room){var _room=[];_room.name=room.name,_room.value=room.name,$scope.rooms.push(_room)})});var query={_id:$routeParams.booking_id};Bookings.query(query,function(bookings){_.each(bookings,function(booking){visit_form.name.value=booking.name,visit_form.comments.value=booking.comments,$scope.room_change(booking.group),console.log("booking",booking),$("#room").val(booking.group),visit_form.type_radios.value=booking.internal_external,visit_form.payment.value=booking.payment,visit_form.approved.value=booking.approved,visit_form.confirmed.value=booking.confirmed,$scope.selected_room=booking.group,visit_form.start_date.value=moment(booking.start_date).format("YYYY-MM-DD HH:mm"),visit_form.end_date.value=moment(booking.end_date).format("YYYY-MM-DD HH:mm"),visit_form.deposit.value=booking.deposit,visit_form.balance.value=booking.balance,$scope.files=booking.files,$scope.files=booking.files})}),$scope.selected_room="",$scope.room_change=function(room){$scope.selected_room=room.name},$scope.onSubmit=function(){var files=$scope.files;_.each($("#upload-input").get(0).files,function(file){var _file={};_file.name=file.name,_file.type=file.type,files.push(_file),console.log(_file)}),console.log(files);var event_to_add={id:(new Date).getUTCMilliseconds(),name:visit_form.name.value,internal_external:visit_form.type_radios.value,showimage:"",image:"",start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),notes:visit_form.comments.value},query={
id:$routeParams.booking_id},update={start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),group:$scope.selected_room,_type:mode_name,className:"GREEN",files:files,internal_external:visit_form.type_radios.value,name:visit_form.name.value,deposit:visit_form.deposit.value,balance:visit_form.balance.value,payment:visit_form.payment.value,approved:visit_form.approved.value,confirmed:visit_form.confirmed.value,notes:visit_form.comments.value,showimage:"",content:timeline_functions.event_html(event_to_add),image:"",date_logged:new Date,comments:visit_form.comments.value,logger_user_name:$scope.user.username};save(query,update)},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}}),$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var files=$(this).get(0).files;if(files.length>0){for(var formData=new FormData,i=0;i<files.length;i++){var file=files[i];formData.append("uploads[]",file,file.name)}$.ajax({url:"/upload",type:"POST",data:formData,processData:!1,contentType:!1,success:function(data){console.log("upload successful!\n"+data)},xhr:function(){var xhr=new XMLHttpRequest;return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(100*percentComplete),$(".progress-bar").text(percentComplete+"%"),$(".progress-bar").width(percentComplete+"%"),100===percentComplete&&$(".progress-bar").html("Done")}},!1),xhr}})}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/edit-form-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],139:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_bookings_controller=function($scope,$http,$q,Resources,Bookings,data_table_reload,get_table_data,timeline_functions,$routeParams){function save(kpis){kpis.$save(function(err,user){err&&alert(err);var message="data saved successfully";message+="\n ",alert(message),$scope.message="data saved successfully",visit_form.name.value="",visit_form.group.value="",visit_form.start_date.value="",visit_form.end_date.value=""})}if($scope.dates=[],$scope.recurring=!1,$scope.approved=!1,"rooms"==$routeParams.mode){var mode="room",mode_name="ROOM BOOKING";$scope.name_of_form="Select room"}else{var mode="equipment",mode_name="EQUIPMENT BOOKING";$scope.name_of_form="Select Equipment"}$scope.extraQuery={museum_id:"#"},$scope.rooms=[],$scope.Resources=Resources,console.log("user",$scope.user);var query={name:"#",type:mode,exact:!1};Resources.query(query,function(rooms){_.each(rooms,function(room){var _room=[];_room.name=room.name,$scope.rooms.push(_room)})}),$scope.selected_room="",$scope.room_change=function(room){$scope.selected_room=room.name},$scope.onSubmit=function(){var files=[];_.each($("#upload-input").get(0).files,function(file){var _file={};_file.name=file.name,_file.type=file.type,files.push(_file),console.log(_file)}),console.log(files);var event_to_add={id:(new Date).getUTCMilliseconds(),name:visit_form.name.value,internal_external:visit_form.type_radios.value,showimage:"",image:"",start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),notes:visit_form.comments.value},kpis=new Bookings({start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),group:$scope.selected_room,_type:mode_name,className:"GREEN",files:files,approved:$scope.approved,internal_external:visit_form.type_radios.value,name:visit_form.name.value,deposit:visit_form.deposit.value,balance:visit_form.balance.value,notes:visit_form.comments.value,showimage:"",content:timeline_functions.event_html(event_to_add),image:"",date_logged:new Date,comments:visit_form.comments.value,logger_user_name:$scope.user.username,requested_by:$scope.user.username});$scope.dates.length>1&&(bookings=[],_.each($scope.dates,function(date){_date={start_date:new Date(date),end_date:new Date(date),group:$scope.selected_room,_type:mode_name,className:"GREEN",files:files,internal_external:visit_form.type_radios.value,name:visit_form.name.value,deposit:visit_form.deposit.value,balance:visit_form.balance.value,approved:$scope.approved,notes:visit_form.comments.value,showimage:"",content:timeline_functions.event_html(event_to_add),image:"",date_logged:new Date,comments:visit_form.comments.value,logger_user_name:$scope.user.username,requested_by:$scope.user.username},end_hours=new Date(visit_form.end_date.value).getHours(),end_minutes=new Date(visit_form.end_date.value).getMinutes(),_date.end_date.setHours(end_hours),_date.end_date.setMinutes(end_minutes),bookings.push(_date)}),async_save=function(i){_bookings=new Bookings(bookings[i]),_bookings.$save(function(err,user){err&&console.log(err),i++,i<bookings.length&&async_save(i)})},async_save(0));var query={name:visit_form.name.value,_type:mode_name,group:visit_form.room.value,start_date:visit_form.start_date.value,end_date:visit_form.end_date.value};Bookings.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,1==$scope.dates.length&&save(kpis)})},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}}),$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var files=$(this).get(0).files;if(files.length>0){for(var formData=new FormData,i=0;i<files.length;i++){var file=files[i];formData.append("uploads[]",file,file.name)}$.ajax({url:"/upload",type:"POST",data:formData,processData:!1,contentType:!1,success:function(data){console.log("upload successful!\n"+data)},xhr:function(){var xhr=new XMLHttpRequest;return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(100*percentComplete),$(".progress-bar").text(percentComplete+"%"),$(".progress-bar").width(percentComplete+"%"),100===percentComplete&&$(".progress-bar").html("Done")}},!1),xhr}})}}),$scope.$watch("ctrl.input_start",function(input_start){console.log("input_start",input_start)});var getFormValues,getOptionsCode,makeRows;getFormValues=function($form){var paramObj;return paramObj={},$.each($form.serializeArray(),function(_,kv){if("type_radios"!=kv.name&&"approved"!=kv.name)return paramObj.hasOwnProperty(kv.name)?(paramObj[kv.name]=$.makeArray(paramObj[kv.name]),paramObj[kv.name].push(kv.value)):paramObj[kv.name]=kv.value}),paramObj},getOptionsCode=function(options){var days,items,k,v;return days=["RRule.MO","RRule.TU","RRule.WE","RRule.TH","RRule.FR","RRule.SA","RRule.SU"],items=function(){var _results;_results=[];for(k in options){if(v=options[k],null===v)v="null";else if("freq"===k)v="RRule."+RRule.FREQUENCIES[v];else if("dtstart"===k||"until"===k)v="new Date("+[v.getFullYear(),v.getMonth(),v.getDate(),v.getHours(),v.getMinutes(),v.getSeconds()].join(", ")+")";else if("byweekday"===k)v=v instanceof Array?v.map(function(wday){var s;return console.log("wday",wday),s=days[wday.weekday],wday.n&&(s+=".nth("+wday.n+")"),s}):days[v.weekday];else if("wkst"===k){if(v===RRule.MO)continue;v=days[v.weekday]}v instanceof Array&&(v="["+v.join(", ")+"]"),console.log(k," =",v),_results.push(""+k+": "+v)}return _results}(),"{\n  "+items.join(",\n  ")+"\n}"},makeRows=function(dates){var cells,cls,date,i,index,part,parts,prevParts,prevStates,rows,states;return prevParts=[],prevStates=[],index=1,rows=function(){var _i,_len,_results;for(_results=[],_i=0,_len=dates.length;_i<_len;_i++)date=dates[_i],states=[],parts=date.toString().split(" "),cells=function(){var _j,_len1,_results1;for(_results1=[],i=_j=0,_len1=parts.length;_j<_len1;i=++_j)part=parts[i],part!==prevParts[i]?states[i]=!prevStates[i]:states[i]=prevStates[i],cls=states[i]?"a":"b",_results1.push("<td class='"+cls+"'>"+part+"</td>");return _results1}(),prevParts=parts,prevStates=states,_results.push("<tr><td>"+index++ +"</td>"+cells.join("\n")+"</tr>");return _results}(),rows.join("\n\n")},$(function(){var $tabs,activateTab,processHash;return $tabs=$("#tabs"),activateTab=function($a){var id;return id=$a.attr("href").split("#")[1],$tabs.find("a").removeClass("active"),$a.addClass("active"),$("#input-types section").hide(),$("#input-types #"+id).show().find("input:first").focus().change()},$("#input-types section").hide().each(function(){return $("<a />",{href:"#"+$(this).attr("id")}).text($(this).find("h3").hide().text()).appendTo($tabs).on("click",function(){return activateTab($(this)),!1})}),$(".examples code").on("click",function(){var $code;return $code=$(this),$code.parents("section:first").find("input").val($code.text()).change()}),$("input, select").on("keyup change",function(){var $in,$section,date,dates,days,e,getDay,html,init,inputMethod,key,makeRule,max,options,rfc,rule,text,v,value,values,_this=this;switch($in=$(this),$section=$in.parents("section:first"),inputMethod=$section.attr("id").split("-")[0]){case"text":makeRule=function(){return RRule.fromText($in.val())},init='RRule.fromText("'+this.value+'")';break;case"rfc":makeRule=function(){return RRule.fromString(_this.value)},init='RRule.fromString("'+this.value+'")';break;case"options":values=getFormValues($in.parents("form")),options={},days=[RRule.MO,RRule.TU,RRule.WE,RRule.TH,RRule.FR,RRule.SA,RRule.SU],getDay=function(i){return days[i]};for(key in values)value=values[key],value&&("dtstart"===key||"until"===key?(date=new Date(Date.parse(value)),value=new Date(date.getTime()+60*date.getTimezoneOffset()*1e3)):"byweekday"===key?value=value instanceof Array?value.map(getDay):getDay(value):/^by/.test(key)?(value instanceof Array||(value=value.split(/[,\s]+/)),value=function(){var _i,_len,_results;for(_results=[],_i=0,_len=value.length;_i<_len;_i++)v=value[_i],v&&_results.push(v);return _results}(),value=value.map(function(n){return parseInt(n,10)})):value=parseInt(value,10),"wkst"===key&&(value=getDay(value)),("interval"!==key||1!==value&&value)&&(options[key]=value));makeRule=function(){return new RRule(options)},init="new RRule("+getOptionsCode(options)+")",console.log(options)}$("#init").html(init),$("#rfc-output a").html(""),$("#text-output a").html(""),$("#options-output").html(""),$("#dates").html("");try{rule=makeRule()}catch(_error){return e=_error,void $("#init").append($('<pre class="error"/>').text("=> "+String(e||null)))}return rfc=rule.toString(),text=rule.toText(),$("#rfc-output a").text(rfc).attr("href","#/rfc/"+rfc),$("#text-output a").text(text).attr("href","#/text/"+text),$("#options-output").text(getOptionsCode(rule.origOptions)),"options"===inputMethod?$("#options-output").parents("tr").hide():$("#options-output").parents("tr").show(),max=500,dates=rule.all(function(date,i){return!(!rule.options.count&&i===max)}),console.log("dates",dates),$scope.dates=dates,html=makeRows(dates),rule.options.count||(html+="<tr><td colspan='7'><em>Showing first "+max+" dates, set\n<code>count</code> to see more.</em></td></tr>"),$("#dates").html(html)}),activateTab($tabs.find("a:first")),processHash=function(){var arg,hash,match,method;if(hash=location.hash.substring(1),hash&&(match=/^\/(rfc|text)\/(.+)$/.exec(hash)))return method=match[1],arg=match[2],activateTab($("a[href='#"+method+"-input']")),$("#"+method+"-input input:first").val(arg).change()},processHash(),$(window).on("hashchange",processHash)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/form-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],140:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.monthly_bookings_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Monthly_bookings,make_a_pie,make_a_line_chart,monthly_data_table_columns,grid_ui_settings,table_security){$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Monthly Bookings Stats",$scope.chart_class="col-md-8 col-lg-8 col-sm-8 pull-right",$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.chart_heading="Gallery visits by month",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"space",name:"Museum",width:80,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Monthly_bookings.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"gallery_visits"==row.stat&&(console.log("gallery_visits"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"space",name:"Space",width:200},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(monthly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),columnDefs.enableFiltering=!1,$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/monthly-bookings-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],141:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_bookings_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Bookings,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){if("rooms"==$routeParams.mode)var mode="room",mode_name="ROOM BOOKING";else var mode="equipment",mode_name="EQUIPMENT BOOKING";$scope.show_all_Button=!0,$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.featured_collection=Bookings,$rootScope.featured_collection=Bookings,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",_type:mode_name},$scope.rooms=[],$scope.filter_x_button=!0,$scope.filter_y_button=!0,$scope.filter_z_button=!0,$scope.filter_x="show pending bookings",$scope.filter_y="show unpaid bookings",$scope.filter_z="show confirmed bookings",$scope._filter_x=[{"false":"pending ","true":"approved",result:!1}],$scope._filter_y=[{"false":"unpaid","true":"paid ",result:!1}],$scope._filter_z=[{"false":"upconfirmed","true":"confirmed",result:!1}],$scope.onCompleteTodo=function(todo){console.log("onCompleteTodo -done: "+todo.done+" : "+todo.text),$scope.doneAfterClick=todo.done,$scope.todoText=todo.text};var columnDefs=[];$rootScope.canEdit_table=!0,(1==$scope.user.approve_room_bookings&&"/bookingslist/rooms"==$location.path()||1==$scope.user.approve_equipment_bookings&&"/bookings/equipment"==$location.path())&&columnDefs.push({name:"edit",resizable:!0,width:"40",cellTemplate:"<a target='_blank' href="+window.location.origin+'{{"#/edit-booking/rooms/"+row.entity._id}} >edit</a>'},{field:"approved",allowCellFocus:!0,type:"boolean",value:"Approved",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.approved==true ? 'approved' : 'pending'}}</div>"},{field:"confirmed",allowCellFocus:!0,type:"boolean",value:"Confirmed",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.confirmed==true ? 'confirmed' : 'no'}}</div>"},{field:"deposit",allowCellFocus:!0,type:"number",value:"Deposit amount",resizable:!0,visible:!0,width:"80"},{field:"balance",allowCellFocus:!0,type:"number",value:"Balance amount",resizable:!0,visible:!0,width:"80"},{field:"total",allowCellFocus:!1,type:"number",value:"Total amount",resizable:!0,visible:!0,width:"80"},{field:"payment",allowCellFocus:!0,type:"boolean",value:"Paid",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.payment==true ? 'paid' : 'no'}}</div>"}),columnDefs.push({field:"group",name:mode,resizable:!0,width:"150"},{field:"name",name:"Name",resizable:!0,width:"150"},{field:"internal_external",name:"Type",resizable:!0,width:"150"},{field:"start_date",name:"From",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",resizable:!0,width:"150"},{field:"end_date",name:"Until",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",width:"150"},{field:"comments",value:"comments",resizable:!0,visible:!0,width:"150"},{field:"calendarlink",name:"Outlook link",resizable:!0,width:"150",cellTemplate:"<a href="+window.location.origin+'{{"/bookings/calendar/"+row.entity.calendarlink}} >click for icalendar link</a>'},{field:"files",name:"Files",resizable:!0,width:"150",cellTemplate:"<a   ng-if='row.entity.files[0].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[0].name}} target='_blank'>{{row.entity.files[0].name}}</a><br><a   ng-if='row.entity.files[1].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[1].name}} target='_blank'>{{row.entity.files[1].name}}</a><br><a  ng-if='row.entity.files[2].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[2].name}} target='_blank'>{{row.entity.files[2].name}}</a>"},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!0,width:"150"},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!0}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/raw-bookings-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],142:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.recurring_events_controller=function($scope,$http,$q,Resources,Bookings,data_table_reload,get_table_data,timeline_functions,$routeParams){var getFormValues,getOptionsCode,makeRows;getFormValues=function($form){var paramObj;return paramObj={},$.each($form.serializeArray(),function(_,kv){return paramObj.hasOwnProperty(kv.name)?(paramObj[kv.name]=$.makeArray(paramObj[kv.name]),paramObj[kv.name].push(kv.value)):paramObj[kv.name]=kv.value}),paramObj},getOptionsCode=function(options){var days,items,k,v;return days=["RRule.MO","RRule.TU","RRule.WE","RRule.TH","RRule.FR","RRule.SA","RRule.SU"],items=function(){var _results;_results=[];for(k in options){if(v=options[k],null===v)v="null";else if("freq"===k)v="RRule."+RRule.FREQUENCIES[v];else if("dtstart"===k||"until"===k)v="new Date("+[v.getFullYear(),v.getMonth(),v.getDate(),v.getHours(),v.getMinutes(),v.getSeconds()].join(", ")+")";else if("byweekday"===k)v=v instanceof Array?v.map(function(wday){var s;return console.log("wday",wday),s=days[wday.weekday],wday.n&&(s+=".nth("+wday.n+")"),s}):days[v.weekday];else if("wkst"===k){if(v===RRule.MO)continue;v=days[v.weekday]}v instanceof Array&&(v="["+v.join(", ")+"]"),console.log(k," =",v),_results.push(""+k+": "+v)}return _results}(),"{\n  "+items.join(",\n  ")+"\n}"},makeRows=function(dates){var cells,cls,date,i,index,part,parts,prevParts,prevStates,rows,states;return prevParts=[],prevStates=[],index=1,rows=function(){var _i,_len,_results;for(_results=[],_i=0,_len=dates.length;_i<_len;_i++)date=dates[_i],states=[],parts=date.toString().split(" "),cells=function(){var _j,_len1,_results1;for(_results1=[],i=_j=0,_len1=parts.length;_j<_len1;i=++_j)part=parts[i],part!==prevParts[i]?states[i]=!prevStates[i]:states[i]=prevStates[i],cls=states[i]?"a":"b",_results1.push("<td class='"+cls+"'>"+part+"</td>");return _results1}(),prevParts=parts,prevStates=states,_results.push("<tr><td>"+index++ +"</td>"+cells.join("\n")+"</tr>");return _results}(),rows.join("\n\n")},$(function(){var $tabs,activateTab,processHash;return $tabs=$("#tabs"),activateTab=function($a){var id;return id=$a.attr("href").split("#")[1],$tabs.find("a").removeClass("active"),$a.addClass("active"),$("#input-types section").hide(),$("#input-types #"+id).show().find("input:first").focus().change()},$("#input-types section").hide().each(function(){return $("<a />",{href:"#"+$(this).attr("id")}).text($(this).find("h3").hide().text()).appendTo($tabs).on("click",function(){return activateTab($(this)),!1})}),$(".examples code").on("click",function(){var $code;return $code=$(this),$code.parents("section:first").find("input").val($code.text()).change()}),$("input, select").on("keyup change",function(){var $in,$section,date,dates,days,e,getDay,html,init,inputMethod,key,makeRule,max,options,rfc,rule,text,v,value,values,_this=this;switch($in=$(this),$section=$in.parents("section:first"),inputMethod=$section.attr("id").split("-")[0]){case"text":makeRule=function(){return RRule.fromText($in.val())},init='RRule.fromText("'+this.value+'")';break;case"rfc":makeRule=function(){return RRule.fromString(_this.value)},init='RRule.fromString("'+this.value+'")';break;case"options":values=getFormValues($in.parents("form")),options={},days=[RRule.MO,RRule.TU,RRule.WE,RRule.TH,RRule.FR,RRule.SA,RRule.SU],getDay=function(i){return days[i]};for(key in values)value=values[key],value&&("dtstart"===key||"until"===key?(date=new Date(Date.parse(value)),value=new Date(date.getTime()+60*date.getTimezoneOffset()*1e3)):"byweekday"===key?value=value instanceof Array?value.map(getDay):getDay(value):/^by/.test(key)?(value instanceof Array||(value=value.split(/[,\s]+/)),value=function(){var _i,_len,_results;for(_results=[],_i=0,_len=value.length;_i<_len;_i++)v=value[_i],v&&_results.push(v);return _results}(),value=value.map(function(n){return parseInt(n,10)})):value=parseInt(value,10),"wkst"===key&&(value=getDay(value)),("interval"!==key||1!==value&&value)&&(options[key]=value));makeRule=function(){return new RRule(options)},init="new RRule("+getOptionsCode(options)+")",console.log(options)}$("#init").html(init),$("#rfc-output a").html(""),$("#text-output a").html(""),$("#options-output").html(""),$("#dates").html("");try{rule=makeRule()}catch(_error){return e=_error,void $("#init").append($('<pre class="error"/>').text("=> "+String(e||null)))}return rfc=rule.toString(),text=rule.toText(),$("#rfc-output a").text(rfc).attr("href","#/rfc/"+rfc),$("#text-output a").text(text).attr("href","#/text/"+text),$("#options-output").text(getOptionsCode(rule.origOptions)),"options"===inputMethod?$("#options-output").parents("tr").hide():$("#options-output").parents("tr").show(),max=500,dates=rule.all(function(date,i){return!(!rule.options.count&&i===max)}),html=makeRows(dates),rule.options.count||(html+="<tr><td colspan='7'><em>Showing first "+max+" dates, set\n<code>count</code> to see more.</em></td></tr>"),$("#dates").html(html)}),activateTab($tabs.find("a:first")),processHash=function(){var arg,hash,match,method;if(hash=location.hash.substring(1),hash&&(match=/^\/(rfc|text)\/(.+)$/.exec(hash)))return method=match[1],arg=match[2],activateTab($("a[href='#"+method+"-input']")),$("#"+method+"-input input:first").val(arg).change()},processHash(),$(window).on("hashchange",processHash)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/recurring-events-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],143:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.yearly_bookings_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Yearly_bookings,make_a_pie,make_a_line_chart,yearly_data_table_columns,grid_ui_settings,table_security){$scope.table_class="col-md-7 col-lg-7 col-sm-7",$scope.monthWeek="month",$scope.show_all_Button=!1,console.log("controller go"),$scope.table_heading="Yearly stats",$scope.pie_date="Apr 2017",$scope.gridOptions=[],$scope.gridOptions.data=[],$rootScope.canEdit_table=!1;var columnDefs=[];$scope.filter_pie=[],columnDefs.push({field:"space",name:"Space",width:90,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90,pinnedLeft:!0}),$scope.start_date=new Date("01/04/2017"),$scope.end_date=new Date("01/04/2018"),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),console.log("columnDefs",columnDefs),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),console.log("getData"),Yearly_bookings.query({},function(team){$scope.rows=[],$scope.data_rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),""!=row.museum&&($scope._rows.push(row),"donations"==row.stat&&(console.log("donations"),$scope.data_rows.push(row)))}),$scope.gridOptions.data=$scope._rows,_.each([2016,2017,2018,2019],function(year){_.each(moment.monthsShort(),function(month){$scope.filter_pie.push({value:month+" "+year,name:month+" "+year})})}),make_a_pie.build($scope,"Apr 2017","museum"),make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits"),$scope.changedValue=function(item){$scope.pie_date=item,make_a_pie.build($scope,item,"museum")},$scope.$watchGroup(["end_date","start_date"],function(newValue,oldValue){columnDefs=[],columnDefs.push({field:"space",name:"Space",width:200,pinnedLeft:!0},{field:"stat",name:"Statistic",width:90}),columnDefs=columnDefs.concat(yearly_data_table_columns.build($scope,$scope.start_date,$scope.end_date)),$scope.gridOptions.columnDefs=columnDefs,make_a_line_chart.build($scope,columnDefs,"museum","gallery_visits")})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/bookings/yearly-bookings-controller.js","/../components/resource-bookings/bookings")},{b55mWE:4,buffer:3}],144:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.recurringEvent=function(){return{restrict:"E",scope:{},controller:"recurring_events_controller",templateUrl:"./components/resource-bookings/bookings/recurrance-form.html"}},exports.yearlyBookings=function(){return{restrict:"E",scope:{},controller:"yearly_bookings_controller",templateUrl:"./shared/templates/data_table.html"}},exports.bookingsDashboard=function(){return{templateUrl:"./components/resource-bookings/bookings/dashboard.html"}},exports.bookingsReport=function(){return{restrict:"E",scope:{},controller:"monthly_bookings_controller",templateUrl:"./shared/templates/data_table.html"}},exports.roomsFormdata=function(){return{templateUrl:"./components/resource-bookings/rooms/kpi-form-and-data.html"}},exports.rawRooms=function(){return{controller:"raw_rooms_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordRooms=function(){return{controller:"record_rooms_controller",templateUrl:"./components/resource-bookings/rooms/kpi-form.html"}},exports.equipmentFormdata=function(){return{templateUrl:"./components/resource-bookings/equipment/kpi-form-and-data.html"}},exports.rawEquipment=function(){return{controller:"raw_equipment_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordEquipment=function(){return{controller:"record_equipment_controller",templateUrl:"./components/resource-bookings/equipment/kpi-form.html"}},exports.bookingsData=function(){return{templateUrl:"./components/resource-bookings/bookings/data.html"}},exports.bookingsForm=function(){return{controller:"record_bookings_controller",templateUrl:"./components/resource-bookings/bookings/kpi-form.html"}},exports.rawBookings=function(){return{controller:"raw_bookings_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordBookings=function(){return{controller:"record_bookings_controller",templateUrl:"./components/resource-bookings/bookings/kpi-form.html"}},exports.editBooking=function(){return{controller:"edit_booking_controller",templateUrl:"./components/resource-bookings/bookings/kpi-form-edit.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/directive.js","/../components/resource-bookings")},{b55mWE:4,buffer:3}],145:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_equipment_controller=function($scope,$http,$q,Resources,data_table_reload,get_table_data,AuthService){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.room_name.value="",visit_form.asset_no.value="",visit_form.label_location.value="",visit_form.label_notes.value="",visit_form.serial_no.value="",visit_form.model_no.value="",visit_form.location.value="",visit_form.description.value=""})}$scope.extraQuery={museum_id:"#",type:"equipment"},$scope.haspermissions=!1,AuthService.isLoggedIn().then(function(user){$scope.user=user,$scope.isloggedin=!0,"ADMIN"==user.data.group&&($scope.haspermissions=!0),"AV"==user.data.group&&($scope.haspermissions=!0),"EXHIBITIONS"==user.data.group&&($scope.haspermissions=!0),"DIGITAL"==user.data.group&&($scope.haspermissions=!0),main_function(timeline_mode)}),$scope.Resources=Resources,$scope.onSubmit=function(){var kpis=new Resources({name:visit_form.asset_name.value+" ("+visit_form.asset_type.value+") "+visit_form.asset_no.value,asset_name:visit_form.asset_name.value,asset_type:visit_form.asset_type.value,asset_no:visit_form.asset_no.value,label_location:visit_form.label_location.value,label_notes:visit_form.label_notes.value,serial_no:visit_form.serial_no.value,model_no:visit_form.model_no.value,location:visit_form.location.value,description:visit_form.description.value,type:"equipment",date_logged:new Date,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={name:visit_form.asset_name.value,type:"equipment",exact:!1};Resources.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,save(kpis)})},
$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/equipment/form-controller.js","/../components/resource-bookings/equipment")},{b55mWE:4,buffer:3}],146:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_equipment_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Resources,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Resources,$rootScope.featured_collection=Resources,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",type:"equipment"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"asset_no",name:"asset_no",resizable:!0,width:"150"},{field:"asset_type",name:"Type",resizable:!0,width:"150"},{field:"asset_name",name:"Device",resizable:!0,width:"150"},{field:"description",name:"description",resizable:!0,width:"150"},{field:"location",name:"location",resizable:!0,width:"150"},{field:"model_no",name:"model_no",resizable:!0,width:"150"},{field:"serial_no",name:"serial_no",resizable:!0,width:"150"},{field:"label_location",name:"label_location",resizable:!0,width:"150"},{field:"label_notes",name:"label_notes",resizable:!0,width:"150"},{field:"comments",value:"comments",resizable:!0,visible:!1},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/equipment/raw-equipment-controller.js","/../components/resource-bookings/equipment")},{b55mWE:4,buffer:3}],147:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_rooms_controller=function($scope,$http,$q,Resources,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.room_name.value=""})}$scope.extraQuery={museum_id:"#"},$scope.Resources=Resources,$scope.onSubmit=function(){function guid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}var kpis=new Resources({name:visit_form.room_name.value,permission_category:"DEFAULT",type:"room",asset_no:guid(),date_logged:new Date,comments:visit_form.comments.value,location:visit_form.museum.value,permission_category:visit_form.priority.value,logger_user_name:$scope.user.username,requested_by:$scope.user.username}),query={name:visit_form.room_name.value,type:"room",exact:!1};Resources.query(query,function(visits){$scope.$emit("form_submit"),$scope.results=visits,save(kpis)})},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/rooms/form-controller.js","/../components/resource-bookings/rooms")},{b55mWE:4,buffer:3}],148:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_rooms_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Resources,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Resources,$rootScope.featured_collection=Resources,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={museum_id:"#",type:"room"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"name",name:"Room",resizable:!0,width:"150"},{field:"permission_category",name:"Priotity",resizable:!0,width:"150"},{field:"location",name:"Location",resizable:!0,width:"150"},{field:"comments",value:"comments",resizable:!0,visible:!0},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!1},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!1}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/rooms/raw-rooms-controller.js","/../components/resource-bookings/rooms")},{b55mWE:4,buffer:3}],149:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_resources_controller=function($compile,$scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,timeline_bookings_functions,get_trello_board,date_calc,Todos,Timeline,Bookings,Team,kiosk_activity,timeline_functions_resources,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate,Raw_visits,timeline_visitor_figures_functions,timeline_install_functions,$timeout,timeline_exhibitions_functions){for(var prop in $rootScope)console.log(prop),"user"!=prop&&"user"!=prop&&"function"!=typeof $rootScope[prop]&&prop.indexOf("$")==-1&&prop.indexOf("$$")==-1&&delete $rootScope[prop];$scope.locked=[],$scope.locked.add_item=!1,$scope.locked["true"]={status:" locked",value:!1},$scope.locked["false"]={status:" unlocked",value:!0},$scope.average_install_length=0,$scope.password=!1,$scope.lockstatus=!1,$scope.average_derig_length=0,$rootScope.addednames=[],$rootScope.track_groups=[],$rootScope.added_track_groups=[],$rootScope.datePicker=[],$scope.isloggedin=!1,$scope.isloggedin=!1,$scope.timeline_track=Timeline,$scope.haspermissions=!1,$scope.init=function(timeline_mode){console.log("timeline_mode",timeline_mode),$scope.mode=timeline_mode,setTimeout(function(){$scope.timeline_track=Bookings,AuthService.isLoggedIn().then(function(user){$(".colourkey").show(),$scope.user=user,$scope.isloggedin=!0,"ADMIN"==user.data.group&&($scope.haspermissions=!0),"COMMERCIAL"==user.data.group&&($scope.haspermissions=!0),"DIGITAL"==user.data.group&&($scope.haspermissions=!0),main_function(timeline_mode)}),setTimeout(function(){0==$scope.isloggedin&&main_function(timeline_mode)},1500)})},main_function=function(timeline_mode){timeline_track=Bookings,$scope.filter_pie=[],$scope.filter_pie.push({value:"2017 total_children",name:"No. children"}),$scope.filter_pie.push({value:"2017 total_sessions",name:"No. sessions"}),$scope.filter_pie.push({value:"2017 total_teachers",name:"No. teachers"}),$scope.filter_pieSelected=$scope.filter_pie[0].name,$scope.plot_graph=null,$rootScope.datePicker.date={startDate:null,endDate:null},$scope.dateRangeOptions={locale:{format:"DD/MM/YYYY"},eventHandlers:{"apply.daterangepicker":function(){if(date=$rootScope.datePicker.date,days=timeline_functions_resources.days(moment(date.startDate),moment(date.endDate)),colour="red",moment(date.startDate).isValid()){var event_to_add={id:$scope.selected_id,name:$scope.selected_item,showimage:"",image:"",className:colour||"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes+"("+days+" days)",days:days};html=timeline_functions_resources.event_html(event_to_add);var options={id:$scope.selected_timeline_id,className:colour||"",content:html,start:moment(date.startDate)._d,end:moment(date.endDate)._d,start_date:moment(date.startDate)._d,end_date:moment(date.endDate)._d};timeline_track.update({id:$scope.selected_id},options),console.log("updatedItem",options),timeline_functions_resources.updateItem(options)}}}},$scope.$watch("selected_notes",function(selected_note){timeline_functions_resources.event_edited($scope,selected_note)}),$scope.$watch("selected_item",function(selected_item){if(date=$rootScope.datePicker.date,days=timeline_functions_resources.days(moment(date.startDate),moment(date.endDate)),$scope.selected_start=moment(date.startDate).format("MMM Do"),$scope.selected_end=moment(date.endDate).format("MMM Do"),moment(date.startDate).isValid()){var event_to_add={id:$scope.selected_id,name:$scope.selected_item,showimage:"",image:"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes,days:days};html=timeline_functions_resources.event_html(event_to_add);var options={id:$scope.selected_timeline_id,content:html,name:selected_item,start:moment(date.startDate)._d,end:moment(date.endDate)._d};timeline_track.update({id:$scope.selected_id},options),timeline_functions_resources.updateItem(options)}}),$scope.$watch("stack",function(stack){"undefined"!=typeof stack&&(options={stack:stack},timeline_functions_resources.updateOptions(options))}),$scope.editing=[],$scope.timeline=Timeline.query(),$scope.removeTimeline=function(id){timeline_track.remove({id:id})},timeline_track.query({},function(team){_.each(team,function(row,index){var timeline=$scope.timeline[index];"Bristol Archives"==timeline.group&&timeline_track.remove({id:timeline._id},function(){})})}),$scope.save=function(){if($scope.newTimeline&&!($scope.newTimeline.length<1)){var timeline=new timeline_track({name:$scope.newTimeline,completed:!1});timeline.$save(function(){$scope.timeline.push(timeline),$scope.newTimeline=""})}},$scope.update=function(index){var timeline=$scope.timeline[index];timeline_track.update({id:timeline._id},timeline),$scope.editing[index]=!1},$scope.edit=function(index){$scope.editing[index]=angular.copy($scope.timeline[index])},$scope.cancel=function(index){$scope.timeline[index]=angular.copy($scope.editing[index]),$scope.editing[index]=!1},$scope.remove=function(index){var timeline=$scope.timeline[index];timeline_track.remove({id:timeline._id},function(){$scope.timeline.splice(index,1)})},$scope.datePicker="",$scope.datePicker.date={startDate:null,endDate:null},$scope.machine_types=[],$scope.type="all",$scope.changedValue=function(place){$rootScope.filter_pieSelected=place},$scope.machinesx=["all"],$scope.filterCondition={machine:"neq"},$scope.$watch("type",function(type){$scope.machinesx=["all"]}),$scope.machine_types_selection=[],$scope.categories=[],$scope.category_selection=[];new vis.DataSet,new vis.DataSet,new vis.DataSet;install_days_tally=0,install_instance_tally=0,derig_tally=0,derig_days_tally=0,$scope.total_install_derig=install_days_tally+derig_days_tally,$scope.average_install_length=Math.round(install_days_tally/install_instance_tally),$scope.average_derig_length=Math.round(derig_days_tally/derig_tally);var container=document.getElementById("example-timeline");timeline=new vis.Timeline(container),$rootScope.timeline=timeline,date={content:"STARTER",group:"STARTER",group_id:"STARTER",id:"STARTER",name:"STARTER",event_type:"STARTER",track:"STARTER",order:"STARTER",subgroup:"STARTER",start:new Date,end:new Date},timeline_functions_resources.setup($scope.timeline_track,$rootScope.groups,new vis.DataSet(date)),$scope.add_exhibitions=function(){timeline_functions_resources.populate_timeline_track_method_b($rootScope,timeline_exhibitions_functions,timeline_track)},$scope.add_installs_derigs=function(){timeline_functions_resources.populate_timeline_track($rootScope,Timeline,timeline_install_functions,timeline_track)},$scope.team_leave=function(){timeline_functions_resources.populate_timeline_track_method_b($rootScope,timeline_leave_functions,timeline_track)},$scope.visitor_figures=function(){timeline_functions_resources.populate_timeline_track($rootScope,Raw_visits,timeline_visitor_figures_functions,timeline_track)},$scope.Resources=function(){timeline_functions_resources.populate_timeline_track($rootScope,Bookings,timeline_bookings_functions,timeline_track)},$scope.shopify=function(){$rootScope.timeline_mode=timeline_mode,timeline_functions_resources.populate_timeline_track($rootScope,Shopify_aggregate,timeline_shopify_functions,timeline_track)},$scope.loans=function(){timeline_functions_resources.populate_timeline_track_method_b($rootScope,timeline_loans_functions,timeline_track)},$scope.learning_bookings=function(){timeline_functions_resources.populate_timeline_track_method_b($rootScope,timeline_learning_functions,timeline_track)},$scope.timeline_googlesheets_functions=function(data_settings){var groups=$rootScope.groups;$rootScope.timeline.setGroups(groups),timeline_googlesheets_functions.get_events(data_settings)},timeline_track=Bookings,$scope.Resources();var checked_event_types=[];checked_event_types.push("Tour"),checked_event_types.push("Walk"),checked_event_types.push("Rides"),checked_event_types.push("Tours"),checked_event_types.push("Talk"),checked_event_types.push("Lecture"),checked_event_types.push("Special Event"),checked_event_types.push("Event"),checked_event_types.push("Family"),Timeline_data.query({},function(data){_.each(data,function(data_settings){console.log("data_settings",data_settings),$scope.timeline_googlesheets_functions(data_settings)}),console.log("$scope.mode",$scope.mode),timeline_functions_resources.update_andCompile("",$scope.mode)}),$scope.$watch("track_groups|filter:{selected:true}",function(nv){var selection=nv.map(function(track_groups){return track_groups.track});$scope.selected_tracks=selection,timeline_functions_resources.changeTracks(selection)},!0),$scope.$watch("groups|filter:{selected:true}",function(nv){var selection=nv.map(function(group){return group.content});timeline_functions_resources.changeGroups(selection),$(".draggable,.iconbar").css({top:"0px"})},!0),$scope.exportCSV=function(){data_to_export=$rootScope.timeline.itemsData.getDataSet(),visibles=$rootScope.timeline.getVisibleItems(),events=[],_.each(data_to_export._data,function(event,index){if(visibles.indexOf(event.id)!=-1){console.log("in");var _event={id:event.id,name:event.name,start_date:moment(event.start).format("DD/MM/YYYY"),end_date:moment(event.end).format("DD/MM/YYYY"),event_type:event.track};events.push(_event)}}),timeline_functions_resources.export_JSON_to_CSV(events,"Timeline dates",!0)},$scope.list1={title:"PROVISIONAL DATE"},$scope.list2={title:"Meeting"},$scope.list3={title:"Event"},$scope.onDropComplete=function(data,evt){}}},exports.BasicDemoCtrl=function($mdDialog,$scope,$http,$q,$routeParams,$location){var originatorEv;this.openMenu=function($mdMenu,ev){originatorEv=ev,$mdMenu.open(ev)},this.notificationsEnabled=!1,this.toggleNotifications=function(){this.notificationsEnabled=!this.notificationsEnabled},this.redial=function(){},this.checkVoicemail=function(){}},exports.add_timeline_items_controller=function($scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,get_trello_board,date_calc,Todos,Timeline,Team,kiosk_activity,timeline_functions_resources,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate){$scope.unlocked=!1,$scope.$watch("locked",function(locked){$scope.locked=locked})},exports.add_timeline_info_box=function($scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,get_trello_board,date_calc,Todos,Timeline,Team,kiosk_activity,timeline_functions_resources,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate){}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/timeline-resources-controller.js","/../components/resource-bookings")},{b55mWE:4,buffer:3}],150:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_functions_resources=function($templateCache,$compile,$http,Bookings,$rootScope,$timeout){return{timeline_track:Bookings,loadgroups:function(items){var _groups=[];return _.each(items._data,function(value){"0000-00-00"!=value.start_date&&"0000-00-00"!=value.end_date&&""!=value.start_date&&""!=value.end_date&&""!=value.project_name&&$.inArray(value.group,$rootScope.addednames)==-1&&($rootScope.addednames.push(value.group),content=value.group||"NA",_groups.push({id:value.group,track:value.track,order:value.order,event_type:value.event_type,content:value.group_name,event_typeSORT:content,selected:value.select_group}),console.log(_groups))}),_groups},update_andCompile:function(item,mode){console.log("update_andCompile",mode);var self=this;setTimeout(function(){$compile($("timeline-databar"))($rootScope)},1700),setTimeout(function(){unique_groups=[],added_ids=[],_.each($rootScope.groups,function(group){added_ids.indexOf(group.id)==-1&&(added_ids.push(group.id),unique_groups.push(group))});var groups=new vis.DataSet(unique_groups);groups.get({filter:function(item){return 1==item.selected}});self.enable_event_drop(timeline_track,mode),$rootScope.timeline.redraw()},2e3)},populate_timeline_track:function(rootScope,dataset,dataset_functions,timeline_track){var self=this;$rootScope.groups=$rootScope.groups||[];var groups=rootScope.groups;rootScope.timeline.setGroups(groups),dataset.query({},function(datax){self.add_events_loop(rootScope,datax,dataset_functions,timeline_track),self.update_andCompile("",$rootScope.mode)})},populate_timeline_track_method_b:function(rootScope,data_functions,timeline_track){var self=this;$rootScope.groups=$rootScope.groups||[];var groups=rootScope.groups;rootScope.timeline.setGroups(groups),data_functions.get_events().then(function(datax){self.add_events_loop(rootScope,datax,data_functions,timeline_track)})},add_events_loop:function(rootScope,datax,dataset_functions,timeline_track){var self=this;dataset_functions.add_events(datax,function(public_dates){rootScope.leave_groups=self.loadgroups(public_dates),_.each(rootScope.leave_groups,function(_group){rootScope.groups.push(_group)}),_.each(public_dates._data,function(date){$rootScope.timeline.itemsData&&rootScope.timeline.itemsData.getDataSet().add(date)}),rootScope.timeline.fit({},function(){self.update_andCompile("",$rootScope.mode)})})},export_JSON_to_CSV:function(JSONData,ReportTitle,ShowLabel){var arrData="object"!=typeof JSONData?JSON.parse(JSONData):JSONData,CSV="";if(CSV+=ReportTitle+"\r\n\n",ShowLabel){var row="";for(var index in arrData[0])row+=index+",";row=row.slice(0,-1),CSV+=row+"\r\n"}for(var i=0;i<arrData.length;i++){var row="";for(var index in arrData[i])row+='"'+arrData[i][index]+'",';row.slice(0,row.length-1),CSV+=row+"\r\n"}if(""==CSV)return void alert("Invalid data");var fileName="MyReport_";fileName+=ReportTitle.replace(/ /g,"_");var uri="data:text/csv;charset=utf-8,"+escape(CSV),link=document.createElement("a");link.href=uri,link.style="visibility:hidden",link.download=fileName+".csv",document.body.appendChild(link),link.click(),document.body.removeChild(link)},prettyConfirm:function(title,text,callback){swal({title:title,text:text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55"},callback)},prettyPrompt:function(title,text,inputValue,callback){swal({title:title,text:text,type:"input",showCancelButton:!0,inputValue:inputValue},callback)},logEvent:function(event,properties){document.getElementById("log"),document.createElement("div")},enable_event_drop:function(event,track){var self=this;$(".vis-group").droppable({accept:".date_add",drop:function(event,ui){function add_item(dropped_group,group,time,value,colour,days,type,track){console.log("add_item",track),date_dropped=moment(time).startOf("day")._d;var id=ui.draggable[0].id;target_date=time,_days=self.days(moment(time).startOf("day")._d,moment(time).add(days,"days")._d);var event_to_add={id:id,name:value,showimage:"",image:"",start_date:moment(time).startOf("day").format("MMM Do"),end_date:moment(time).add(days,"days").format("MMM Do"),notes:"",days:_days},new_date={content:self.event_html(event_to_add),name:value,group:dropped_group,dropped_group:dropped_group,date_logged:new Date,className:colour||"",_type:track,start_date:new Date(moment(date_dropped).startOf("day")._d),end_date:new Date(moment(date_dropped).add(days,"days")._d),days:_days};console.log("save");new Bookings(new_date).$save(function(_item){new_date.start=_item.start_date,new_date.end=_item.end_date,new_date._id=_item._id,new_date._type=_item._type,timeline.itemsData.getDataSet().add(new_date),setTimeout(function(){$(ui.draggable[0]).show(),self.add_group_to_timeline(new_date)},1e3)})}event.preventDefault(),$(".already-dropped").length||($("body").addClass("already-dropped"),setTimeout(function(){$(".already-dropped").removeClass("already-dropped")},100),time=timeline.getEventProperties(event).time,group=timeline.getEventProperties(event).group,console.log(track),$(ui.draggable[0]).hide(),"PROVISIONAL DATE"==ui.draggable[0].innerHTML?self.prettyPrompt("Add a provisional date","Name:","",function(value){value&&add_item(group,group,time,value,"blue",30,ui.draggable[0].innerHTML,track)}):"INSTALL"==ui.draggable[0].innerHTML||"DERIG"==ui.draggable[0].innerHTML?add_item(group,group,time,ui.draggable[0].innerHTML,"red",7,ui.draggable[0].innerHTML,track):add_item(group,$rootScope.filter_pieSelected,time,ui.draggable[0].innerHTML,"orange",1,"PROVISIONAL DATE",track))}})},unlock:function(unlock){timeline.setOptions({editable:unlock,selectable:unlock}),timeline.options.editable=!0},add_group_to_timeline:function(new_group){console.log("add_group_to_timeline");var groups=new vis.DataSet($rootScope.groups),list=(new vis.DataSet($rootScope.leave_groups),groups.get());_.some(list,function(lookup_group){if(new_group.dropped_group==lookup_group.id){console.log("copy this ",lookup_group);var _new_group=lookup_group;return _new_group.track=new_group.track,_new_group.content=new_group.content,!0}}),this.update_andCompile("",$rootScope.mode)},changeTracks:function(selection){console.log("changeTracks selection",selection);var groups=new vis.DataSet($rootScope.groups),list=(new vis.DataSet($rootScope.leave_groups),groups.get({filter:function(item){return selection.indexOf(item.track)!=-1}}));timeline.setGroups(list),$rootScope.mode=selection[0],this.update_andCompile("",selection[0]),this.enable_event_drop()},changeGroups:function(selection){var groups=new vis.DataSet($rootScope.groups),list=groups.get({filter:function(item){return selection.indexOf(item.content)!=-1}});timeline.setGroups(list),this.enable_event_drop()},days:function(start,end){var a=moment(start),b=moment(end);return b.diff(a,"days")},event_html:function(event_to_add){var id=event_to_add.id,name=event_to_add.name,className=event_to_add.className,showimage=event_to_add.showimage,image=event_to_add.image,start_date=event_to_add.start_date,end_date=event_to_add.end_date,notes=event_to_add.notes||"",days=event_to_add.days,description=event_to_add.description||"",notes=notes||"",image=image||"",showimage=showimage||"",htmlContent="<timeline-databar     className='"+className+"' description='"+description+"' description='"+description+"' id='"+id+"' name='"+name+"' image='"+image+"' showimage='"+showimage+"' startdate='"+start_date+"' enddate='"+end_date+"' notes='"+notes+"' days='"+days+"'></timeline-databar>";return htmlContent},selected_data:function(event){selected_timeline_id=event.items[0],selected_timeline_id&&(selected_item=timeline.itemsData.getDataSet().get(selected_timeline_id),$rootScope.selected_timeline_id=selected_timeline_id,$rootScope.selected_item=selected_item.name,$rootScope.selected_type=selected_item._type,selected_item.days>0&&($rootScope.selected_days=" - "+selected_item.days+" days"),$rootScope.selected_id=selected_item._id,$rootScope.selected_notes=selected_item.notes,$rootScope.datePicker.date={startDate:new Date(selected_item.start),endDate:new Date(selected_item.end)})},get_events:function(){return $http.get("http://museums.bristol.gov.uk/sync/data/events.JSON")},updateOptions:function(options){$rootScope.timeline.setOptions(options)},event_edited:function(scope,selected_note){console.log("event_edited");var self=this;if(scope.locked.add_item){if(date=$rootScope.datePicker.date,days=self.days(moment(date.startDate),moment(date.endDate)),scope.selected_start=moment(date.startDate).format("MMM Do"),scope.selected_end=moment(date.endDate).format("MMM Do"),moment(date.startDate).isValid()){var event_to_add={id:scope.selected_id,name:scope.selected_item,showimage:"",image:"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes,days:days};html=self.event_html(event_to_add);var options={id:scope.selected_timeline_id,content:html,notes:selected_note,start:moment(date.startDate)._d,end:moment(date.endDate)._d};self.timeline_track.update({id:scope.selected_id},options,function(){self.updateItem(options)})}}else console.log("timeline locked")},updateItem:function(options){"undefined"!=typeof timeline&&timeline.itemsData&&(timeline.itemsData.getDataSet().update(options),console.log("updateItem - $rootScope.mode",$rootScope.mode),this.update_andCompile("",$rootScope.mode))},setup:function(Timeline,groups,dates,isloggedin){var self=this,options={min:new Date(2014,0,1),max:new Date(2022,0,1),zoomMin:864e5,zoomMax:13392e8,width:"100%",maxHeight:"900px",moveable:!0,itemsAlwaysDraggable:!0,snap:function(date,scale,step){return date},stack:!0,orientation:{axis:"top"},selectable:!0,editable:!1,groupOrder:"order",onMove:function(item,callback){if($rootScope.datePicker.date={startDate:new Date(item.start),endDate:new Date(item.end)},days=self.days(moment(item.start),moment(item.end)),$rootScope.selected_days=days,moment(item.start).isValid()){var event_to_add={id:item._id,name:item.name,showimage:"",image:"",className:item.className,group:item.group,start_date:moment(item.start).startOf("day").format("MMM Do"),end_date:moment(item.end).startOf("day").format("MMM Do"),notes:item.notes,days:days};html=self.event_html(event_to_add);var options={id:item.id,group:item.group,content:html,notes:event_to_add.notes,start:moment(item.start)._d,end:moment(item.end)._d,start_date:moment(item.start)._d,end_date:moment(item.end)._d};self.timeline_track.update({id:item._id},options,function(){self.updateItem(options)}),callback(item)}else console.log("invalid date"),callback(item)},onUpdate:function(item,callback){self.prettyPrompt("Update item","Edit items text:",item.content,function(value){if(value)if(item.content=value,days=self.days(item.start,item.end),moment(item.start).isValid()){var event_to_add={id:item.id,name:value,showimage:"",image:"",start_date:item.start,end_date:item.end,notes:item.notes,days:days},_timeline=new self.timeline_track({content:self.event_html(event_to_add),name:item.name,group:item.group,start_date:item.start,end_date:item.end,days:self.days(item.start,item.end)});self.timeline_track.update({id:item._id},_timeline);var _options={id:item._id,content:self.event_html(event_to_add),start:moment(event_to_add.startDate)._d,end:moment(event_to_add.endDate)._d,start_date:moment(event_to_add.startDate)._d,end_date:moment(event_to_add.endDate)._d};self.updateItem(_options,function(){self.update_andCompile("",item._type)}),callback(item)}else console.log("invalid date");else callback(null)})},onAdd:function(item,callback){self.prettyPrompt("Add note","Add some notes to this date:",item.content,function(value){if(value){item.content=value,callback(item),days=self.days(item.start,moment(item.start).add(5,"days"));var event_to_add={id:item.id,name:value,showimage:"",image:"",start_date:item.start,end_date:moment(item.start).add(5,"days"),notes:"",days:days};new self.timeline_track({content:self.event_html(event_to_add),name:value,date_logged:new Date,group:item.group,_type:"note",start_date:item.start,end_date:moment(item.start).add(1,"days"),className:"green"}).$save(function(_item){new_date.start=_item.start_date,new_date.end=_item.end_date,new_date._id=_item._id,new_date._type=ui.draggable[0].innerHTML,timeline.itemsData.getDataSet().add(new_date),setTimeout(function(){$(ui.draggable[0]).show(),console.log("bread")},1e3)})}else callback(null)})},onRemove:function(item,callback){return item._id?(self.timeline_track.remove({id:item._id}),void callback(item)):(sweetAlert("you can't remove this item from here, sorry :)"),!1)}},self=this;$("body").keydown(function(e){if(37==e.keyCode)move(.2);else if(39==e.keyCode)move(-.2);else if(38==e.keyCode)zoom(-.2);else if(40==e.keyCode)return zoom(.2),!1}),$rootScope.timeline.setOptions(options),$rootScope.timeline.on("select",function(properties){console.log("timeline selected"),self.selected_data(properties)}),$rootScope.timeline.setItems(dates),$rootScope.timeline.fit(),move=function(percentage){var range=this.timeline.getWindow(),interval=range.end-range.start;this.timeline.setWindow({start:range.start.valueOf()-interval*percentage,end:range.end.valueOf()-interval*percentage})},zoom=function(percentage){var range=this.timeline.getWindow(),interval=range.end-range.start;this.timeline.setWindow({start:range.start.valueOf()-interval*percentage,end:range.end.valueOf()+interval*percentage})},zoomIn=function(){this.zoom(-.2)},zoomOut=function(){this.zoom(.2)},moveLeft=function(){this.move(.2)},moveRight=function(){this.move(-.2)},dates.on("*",function(event,properties){}),self.enable_event_drop(),$compile($("timeline-databar"))($rootScope)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/resource-bookings/timeline-resources-services.js","/../components/resource-bookings")},{b55mWE:4,buffer:3}],151:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.shopify_controller=function(log_messages,$scope,AuthService,$http,$q,$routeParams,$location,$rootScope,shopify_app){AuthService.isLoggedIn().then(function(user){$scope.isloggedin=!0,$scope.report_running=!0}),console.log("controller go"),$scope.logging=!0,$scope.data_number=7,$scope.generate_order_forms=!1,$scope.update_product_types=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.gridOptions.columnDefs=[],$scope.gridOptions={columnDefs:[{field:"product_type",resizable:!0},{field:"price",resizable:!0},{field:"sales_value",resizable:!0},{field:"name",resizable:!0},{field:"count",resizable:!0},{field:"inventory_quantity",resizable:!0},{field:"order_status",resizable:!0},{field:"sku",resizable:!0},{field:"barcode",resizable:!0},{field:"vendor",resizable:!0},{field:"date_report_run",resizable:!0}],enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!0,enableCellEditOnFocus:!0,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{
pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){})}};var options=[];$scope.optionset=[],options.google_sheet_id="1UlDQNS6dTvQWlQs090HRrSoR49k0Th-ElxCaxTMleA0",options.created_at_min=moment(new Date).add(-$scope.data_number,"days").format(),options.title="last_"+$scope.data_number+"_days",$scope.optionset.push(options),$scope.save_to_sheets=!1,$scope.$watch("data_number",function(data_number){$scope.optionset=[];var options=[];options.google_sheet_id="1UlDQNS6dTvQWlQs090HRrSoR49k0Th-ElxCaxTMleA0",options.created_at_min=moment(new Date).add(-data_number,"days").format(),options.title="last_"+data_number+"_days",console.log("options.created_at_min",options.created_at_min),$scope.optionset.push(options)}),$scope.runShopify=function(selected_set,shop){$scope._rows=[],$scope.report_running=!1,$scope.selected_set=selected_set,$scope.optionset[selected_set].save_to_sheets=$scope.save_to_sheets,$scope.optionset[selected_set].update_product_types=$scope.update_product_types,$scope.optionset[selected_set].generate_order_forms=$scope.generate_order_forms,$scope.optionset[selected_set].shop=shop,console.log($scope.optionset[selected_set]),shopify_app.getData($scope.optionset[selected_set],function(team){$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.logging=!1,$scope.rows=$scope._rows,$scope.gridOptions.data=$scope.rows,$(window).resize(),$scope.report_running=!0})}},exports.shopify_buttons=function(log_messages,$scope,$http,$q,$routeParams,$location,$rootScope,shopify_app){$scope.report_running=!0,$scope.title1="Button",$scope.title4="Warn",$scope.isDisabled=!0,$scope.googleUrl="http://google.com",$scope.messages=[]}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/shopify/shopify-controller.js","/../components/shopify")},{b55mWE:4,buffer:3}],152:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.shopifyStatus=function(){return{controller:"shopify_controller",templateUrl:"./components/shopify/shopify-page.html"}},exports.shopifyButtonsmonthly=function(){return{controller:"shopify_monthly_buttons",templateUrl:"./components/shopify/shopify-buttons-monthly.html"}},exports.shopifyButtons=function(){return{controller:"shopify_buttons",templateUrl:"./components/shopify/shopify-buttons.html"}},exports.shopifyMonthly=function(){return{controller:"shopify_monthly_controller",templateUrl:"./components/shopify/shopify-page-monthly.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/shopify/shopify-directive.js","/../components/shopify")},{b55mWE:4,buffer:3}],153:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.shopify_monthly_controller=function(log_messages,$scope,AuthService,$http,$q,$routeParams,$location,$rootScope,Shopify_monthly_report){AuthService.isLoggedIn().then(function(user){$scope.isloggedin=!0,$scope.report_running=!0}),console.log("controller go"),$scope.logging=!0,$scope.data_number=7,$scope.generate_order_forms=!1,$scope.update_product_types=!0,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.gridOptions.columnDefs=[],$scope.gridOptions={columnDefs:[{field:"shop_id",resizable:!0,enableFiltering:!0},{field:"title",resizable:!0,enableFiltering:!0},{field:"vendor",resizable:!0,enableFiltering:!0},{field:"net_sales",resizable:!0,type:"number",enableFiltering:!0},{field:"quantity",resizable:!0,type:"number",enableFiltering:!0},{field:"year",resizable:!0,type:"number",enableFiltering:!0},{field:"month",resizable:!0,enableFiltering:!0},{field:"Nov",resizable:!0,type:"number",enableFiltering:!0},{field:"Dec",resizable:!0,type:"number",enableFiltering:!0},{field:"Jan",resizable:!0,type:"number",enableFiltering:!0},{field:"Feb",resizable:!0,type:"number",enableFiltering:!0},{field:"date_report_run",resizable:!0,enableFiltering:!0}],enableFiltering:!0,enableCellEdit:!0,enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!1,enableCellEditOnFocus:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))};var options=[];$scope.optionset=[],options.google_sheet_id="1UlDQNS6dTvQWlQs090HRrSoR49k0Th-ElxCaxTMleA0",options.created_at_min=moment(new Date).add(-$scope.data_number,"days").format(),options.title="last_"+$scope.data_number+"_days",$scope.optionset.push(options),$scope.save_to_sheets=!1,$scope.$watch("data_number",function(data_number){$scope.optionset=[];var options=[];options.google_sheet_id="1UlDQNS6dTvQWlQs090HRrSoR49k0Th-ElxCaxTMleA0",options.created_at_min=moment(new Date).add(-data_number,"days").format(),options.title="last_"+data_number+"_days",console.log("options.created_at_min",options.created_at_min),$scope.optionset.push(options)}),$scope.runShopify=function(selected_set,shop){$scope._rows=[],$scope.report_running=!1,$scope.selected_set=selected_set,$scope.optionset[selected_set].save_to_sheets=$scope.save_to_sheets,$scope.optionset[selected_set].update_product_types=$scope.update_product_types,$scope.optionset[selected_set].generate_order_forms=$scope.generate_order_forms,$scope.optionset[selected_set].shop=shop,console.log($scope.optionset[selected_set]),Shopify_monthly_report.query($scope.optionset[selected_set],function(team){$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.logging=!1,$scope.rows=$scope._rows,$scope.gridOptions.data=$scope.rows,$(window).resize(),$scope.report_running=!0})}},exports.shopify_monthly_buttons=function(log_messages,$scope,$http,$q,$routeParams,$location,$rootScope,Shopify_monthly_report){$scope.report_running=!0,$scope.title1="Button",$scope.title4="Warn",$scope.isDisabled=!0,$scope.googleUrl="http://google.com",$scope.messages=[]}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/shopify/shopify-monthly-controller.js","/../components/shopify")},{b55mWE:4,buffer:3}],154:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.rawPosters=function(){return{controller:"raw_posters_controller",templateUrl:"./shared/templates/data_table.html"}},exports.postersForm=function(){return{controller:"record_posters_controller",templateUrl:"./components/signage/posters/poster-form.html"}},exports.postersFormdata=function(){return{templateUrl:"./components/signage/posters/poster-form-and-data.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/signage/directive.js","/../components/signage")},{b55mWE:4,buffer:3}],155:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_posters_controller=function($scope,$http,$q,Resources,Posters,data_table_reload,get_table_data,timeline_functions,$routeParams){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully",visit_form.name.value="",visit_form.group.value="",visit_form.start_date.value="",visit_form.end_date.value=""})}if("rooms"==$routeParams.mode){var mode="room",mode_name="ROOM BOOKING";$scope.name_of_form="Select room"}else{var mode="equipment",mode_name="EQUIPMENT BOOKING";$scope.name_of_form="Select Equipment"}var mode_name="poster";$scope.extraQuery={museum_id:"#"},$scope.rooms=[];var _room=[];_room.name="BMAG",$scope.rooms.push(_room);var _room=[];_room.name="MSHED",$scope.rooms.push(_room);var _room=[];_room.name="ALL VENUES",$scope.rooms.push(_room),$scope.Posters=Posters,console.log("user",$scope.user);$scope.selected_room="",$scope.room_change=function(room){$scope.selected_room=room.name},$scope.onSubmit=function(){var files=[];_.each($("#upload-input").get(0).files,function(file){var _file={};_file.name=file.name,_file.type=file.type,files.push(_file),console.log(_file)}),console.log(files);var kpis=({id:(new Date).getUTCMilliseconds(),name:visit_form.name.value,internal_external:visit_form.type_radios.value,showimage:"",image:"",start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),notes:visit_form.comments.value},new Posters({start_date:new Date(visit_form.start_date.value),end_date:new Date(visit_form.end_date.value),venue:visit_form.type_radios.value,directory:"posters",_type:mode_name,className:"GREEN",files:files,name:visit_form.name.value,notes:visit_form.comments.value,showimage:"",image:"",date_logged:new Date,comments:visit_form.comments.value,logger_user_name:$scope.user.username})),query={name:visit_form.name.value,_type:mode_name,start_date:visit_form.start_date.value,end_date:visit_form.end_date.value};Posters.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,save(kpis)})},$(document).ready(function(){$scope.$emit("record_rooms_form"),$scope.savex=function(kpis){save(kpis)}}),$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var files=$(this).get(0).files;if(files.length>0){for(var formData=new FormData,i=0;i<files.length;i++){var file=files[i];formData.append("uploads[]",file,file.name)}$.ajax({url:"/upload/posters",type:"POST",data:formData,processData:!1,contentType:!1,success:function(data){console.log("upload successful!\n"+data)},xhr:function(){var xhr=new XMLHttpRequest;return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(100*percentComplete),$(".progress-bar").text(percentComplete+"%"),$(".progress-bar").width(percentComplete+"%"),100===percentComplete&&$(".progress-bar").html("Done")}},!1),xhr}})}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/signage/posters/form-controller.js","/../components/signage/posters")},{b55mWE:4,buffer:3}],156:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_posters_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Posters,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){if("rooms"==$routeParams.mode)var mode="room",mode_name="ROOM BOOKING";else var mode="equipment",mode_name="signage";var mode="signage";$scope.show_all_Button=!0,$scope.table_class="col-md-12 col-lg-12 col-sm-5",$scope.featured_collection=Posters,$rootScope.featured_collection=Posters,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={venue:"#",_type:mode_name},$scope.rooms=[],$scope.filter_x_button=!0,$scope.filter_y_button=!0,$scope.filter_z_button=!0,$scope.filter_x="show pending Posters",$scope.filter_y="show unpaid Posters",$scope.filter_z="show confirmed Posters",$scope._filter_x=[{"false":"pending ","true":"approved",result:!1}],$scope._filter_y=[{"false":"unpaid","true":"paid ",result:!1}],$scope._filter_z=[{"false":"upconfirmed","true":"confirmed",result:!1}],$scope.onCompleteTodo=function(todo){console.log("onCompleteTodo -done: "+todo.done+" : "+todo.text),$scope.doneAfterClick=todo.done,$scope.todoText=todo.text};var columnDefs=[];$rootScope.canEdit_table=!0,(1==$scope.user.approve_room_bookings&&"/bookingslist/rooms"==$location.path()||1==$scope.user.approve_equipment_bookings&&"/bookings/equipment"==$location.path())&&columnDefs.push({name:"edit",resizable:!0,width:"40",cellTemplate:"<a target='_blank' href="+window.location.origin+'{{"#/edit-booking/rooms/"+row.entity._id}} >edit</a>'},{field:"approved",allowCellFocus:!0,type:"boolean",value:"Approved",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.approved==true ? 'approved' : 'pending'}}</div>"},{field:"confirmed",allowCellFocus:!0,type:"boolean",value:"Confirmed",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.confirmed==true ? 'confirmed' : 'no'}}</div>"},{field:"deposit",allowCellFocus:!0,type:"number",value:"Deposit amount",resizable:!0,visible:!0,width:"80"},{field:"balance",allowCellFocus:!0,type:"number",value:"Balance amount",resizable:!0,visible:!0,width:"80"},{field:"total",allowCellFocus:!1,type:"number",value:"Total amount",resizable:!0,visible:!0,width:"80"},{field:"payment",allowCellFocus:!0,type:"boolean",value:"Paid",resizable:!0,visible:!0,width:"80",cellTemplate:"<div class='ui-grid-cell-contents'>{{row.entity.payment==true ? 'paid' : 'no'}}</div>"}),columnDefs.push({field:"venue",name:mode,resizable:!0,width:"150"},{field:"name",name:"Name",resizable:!0,width:"150"},{field:"internal_external",name:"Type",resizable:!0,width:"150"},{field:"start_date",name:"From",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",resizable:!0,width:"150"},{field:"end_date",name:"Until",resizable:!0,type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",width:"150"},{field:"comments",value:"comments",resizable:!0,visible:!0,width:"150"},{field:"calendarlink",name:"Outlook link",resizable:!0,width:"150",cellTemplate:"<a href="+window.location.origin+'{{"/bookings/calendar/"+row.entity.calendarlink}} >click for icalendar link</a>'},{field:"files",name:"Files",resizable:!0,width:"150",cellTemplate:"<a   ng-if='row.entity.files[0].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[0].name+\"/posters/\"}} target='_blank'>{{row.entity.files[0].name}}</a><br><a   ng-if='row.entity.files[1].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[1].name}} target='_blank'>{{row.entity.files[1].name}}</a><br><a  ng-if='row.entity.files[2].name' href="+window.location.origin+"{{\"/download/\"+row.entity.files[2].name}} target='_blank'>{{row.entity.files[2].name}}</a>"},{field:"logger_user_name",value:"Logged by",resizable:!0,visible:!0,width:"150"},{field:"date_logged",value:"Date logged",type:"date",cellFilter:"date:'dd/MM/yy HH:mm'",cellFilter:"date:'dd/MM/yy HH:mm'",visible:!0}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/signage/posters/raw-poster-controller.js","/../components/signage/posters")},{b55mWE:4,buffer:3}],157:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.TallyController=function($scope,Tallys){$scope.editing=[],$scope.tallys=Tallys.query(),$scope.save=function(){if($scope.newTally&&!($scope.newTally.length<1)){var tally=new Tallys({name:$scope.newTally,completed:!1});tally.$save(function(){$scope.tallys.push(tally),$scope.newTally=""})}},$scope.update=function(index){var tally=$scope.todos[index];Tallys.update({id:tally._id},tally),$scope.editing[index]=!1},$scope.edit=function(index){$scope.editing[index]=angular.copy($scope.tallys[index])},$scope.cancel=function(index){$scope.tallys[index]=angular.copy($scope.editing[index]),$scope.editing[index]=!1},$scope.remove=function(index){var tally=$scope.tallys[index];Tallys.remove({id:tally._id},function(){$scope.tallys.splice(index,1)})}},exports.TodoDetailCtrl=function($scope,$routeParams,Todos,$location){$scope.todo=Todos.get({id:$routeParams.id}),$scope.remove=function(){Todos.remove({id:$scope.todo._id},function(){$location.url("/")})}},exports.trello=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team){trello.auth(),$scope.removeTeam=function(id){Team.remove({id:id})},Team.query({},function(team){_.each(team,function(row){$scope.removeTeam(row._id)})}),kiosk_path=$routeParams.kiosk,screensaver="",$scope.start_screen_saver=function(){screen_saver_loop.start_screen_saver()},$scope.functionThatReturnsStyle=function(){},$scope.changeheadingcolor=function(){},1!=$rootScope.screensaver_on&&(console.log("start screensaver"),screen_saver_loop.start_screen_saver()),console.log($routeParams.view);var display_data=$rootScope[$routeParams.view];$scope.lists=[],loadMoreShots=function(display_data){angular.forEach(display_data,function(list,index){get_trello_board.get_data(list).then(function(response){cards=response.response,console.log("cards",cards),list._cards=[],tally=0,card_count=0,angular.forEach(cards,function(card,index){card_count++,card_to_print={name:card.name,tint:1-date_calc.diffDays(card.dateLastActivity)/10,age:date_calc.diffDays(card.dateLastActivity).toString(),dateLastActivity:card.dateLastActivity},tally+=date_calc.diffDays(card.dateLastActivity),list._cards.push(card_to_print)}),list.average=(tally/card_count).toFixed(2),list.tint=list.average/100,list.card_count=card_count,list.points=(card_count/(list.average/1+1)).toFixed(2),console.log("card_count",card_count),console.log("list.average ",list.average),console.log("list.average ",list.average+1),console.log("list.points ",list.points);var team=new Team({name:list.title,score:list.points,card_count:card_count,bonus:"",penalty:list.average});team.$save(function(){$scope.team.push(team)});var tally=new Tallys({name:list.title,date:new Date,points:list.points});$scope.tallys=Tallys.query(),tally.$save(function(){console.log(tally),$scope.tallys.push(tally),$scope.newTodo=""}),$scope.lists.push(list)})})},loadMoreShots(display_data),detect_dragging.drag_handler(),$scope.go=function(path){0==$rootScope.isDragging&&path>0&&($location.path("id/"+path+"/"+$routeParams.kiosk),detect_dragging.drag_handler())},$scope.pageClass="page-contact",$scope.save=function(){if($scope.newTally&&!($scope.newTally.length<1)){var tally=new Tallys({name:$scope.newTally,date:new Date});tally.$save(function(){$scope.todos.push(tally),$scope.newTodo=""})}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/team/app-controllers.js","/../components/team")},{b55mWE:4,buffer:3}],158:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.form_to_trellox=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team){trello.auth(),console.log($rootScope.team),boards=[],angular.forEach($rootScope.team,function(team,i){board={name:team.title,value:team.id},boards.push(board)}),$scope.form_to_trello=function(){function onSubmit(){formData=vm.model;var myList=formData.list_id,creationSuccess=function(data){if(console.log("Card created successfully. Data returned:"+JSON.stringify(data)),exampleInputFile.files[0]){var formData=new FormData;formData.append("token",Trello.token()),formData.append("key",Trello.key()),formData.append("file",exampleInputFile.files[0]),console.log(formData);var request=new XMLHttpRequest;request.open("POST","https://api.trello.com/1/cards/"+data.id+"/attachments"),request.send(formData),vm.options.resetModel()}},error=function(err){console.log(err.responseText)},newCard={name:formData.name,file:formData.file,desc:formData.description,idList:myList,pos:"top"};console.log("Trello",Trello),Trello.post("/cards/",newCard,creationSuccess,error);formData.key,formData.token}var vm=this;vm.onSubmit=onSubmit,vm.author={name:"#",url:"#"},vm.exampleTitle="Introduction",vm.env={angularVersion:angular.version.full},vm.model={name:"",file:"",list_id:"",description:""},vm.options={formState:{awesomeIsForced:!1}},vm.fields=[{key:"list_id",type:"select",templateOptions:{label:"Post to board",options:boards}},{key:"name",type:"textarea",templateOptions:{label:"Task",placeholder:"This will be the card name",description:""},expressionProperties:{"templateOptions.focus":"formState.awesomeIsForced","templateOptions.description":function(viewValue,modelValue,scope){if(scope.formState.awesomeIsForced)return"And look! This field magically got focus!"}}},{key:"description",type:"textarea",templateOptions:{label:"Description",placeholder:"This will be the card description",description:""},expressionProperties:{"templateOptions.focus":"formState.awesomeIsForced","templateOptions.description":function(viewValue,modelValue,scope){if(scope.formState.awesomeIsForced)return"And look! This field magically got focus!"}}},{key:"file",type:"file",templateOptions:{label:"File",placeholder:"This will be the card name",description:""},expressionProperties:{"templateOptions.focus":"formState.awesomeIsForced","templateOptions.description":function(viewValue,modelValue,scope){if(scope.formState.awesomeIsForced)return"And look! This field magically got focus!"}}},{key:"exampleDirective",template:"<div example-directive></div>",templateOptions:{label:"Example Directive"}}]}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/team/form-controller.js","/../components/team")},{b55mWE:4,buffer:3}],159:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.leave_controller=function($scope,$http,$q,$routeParams,$location,$rootScope,date_calc,Tallys,Team,Timeline,Leave){function dateRangeOverlaps(a_start,a_end,b_start,b_end){return a_start<=b_start&&b_start<=a_end||(a_start<=b_end&&b_end<=a_end||b_start<a_start&&a_end<b_end)}$scope.override=!0,$scope.ids_to_delete=[],$scope.datePicker=[],$scope.datePicker.date={startDate:"",endDate:""},$scope.dateRange={startDate:null,endDate:null},check_dates=function(viewValue){var overlap=[];""!=viewValue&&Team.query({},function(team){_.each(team,function(_team,i){_.each(_team.leave_taken,function(leave,i){StartDate1=new Date(leave.start_date),EndDate1=new Date(leave.end_date),StartDate2=new Date($scope.datePicker.date.startDate._d),EndDate2=new Date($scope.datePicker.date.endDate._d),1==dateRangeOverlaps(StartDate1,EndDate1,StartDate2,EndDate2)&&(overlap.type=leave._type,overlap.name=leave.name,overlap.id=leave._id,overlap.group=moment(StartDate1).format("MMM Do YYYY")+"-"+moment(EndDate1).format("MMM Do YYYY"),$scope.overlapalert.push(overlap),viewValue==_team._id&&(console.log("will be overwritten"+leave._id),$scope.ids_to_delete.push(overlap.id)))})})})},$scope.overlapalert=[],$scope.dateRangeOptions={locale:{format:"DD/MM/YYYY"},eventHandlers:{"apply.daterangepicker":function(){console.log("checking Dates"),$scope.overlapalert=[],Timeline.query({},function(team){_.each(team,function(row,index){var timeline=row;if(row.end_date||(row.end_date=row.start_date),StartDate1=new Date(timeline.start_date),EndDate1=new Date(timeline.end_date),StartDate2=new Date($scope.datePicker.date.startDate._d),EndDate2=new Date($scope.datePicker.date.endDate._d),1==dateRangeOverlaps(StartDate1,EndDate1,StartDate2,EndDate2)){console.log(row);var overlap=[];overlap.type=row._type,overlap.name=row.name,overlap.group=row.group,$scope.overlapalert.push(overlap)}})})}}},boards=[],leave_type=[],leave_type.push({name:"Full Day",value:"Full Day"}),leave_type.push({name:"Half Day",value:"Half Day"}),leave_type.push({name:"Flexi PM",value:"Flexi PM"}),leave_type.push({name:"Flexi AM",value:"Flexi AM"}),leave_type.push({name:"Flexi Day",value:"Flexi Day"}),Team.query({},function(team){_.each(team,function(team,i){board={name:team.username,value:team._id},boards.push(board)})}),check_names=function(){console.log("check names")},$scope.override_button=function(){console.log("override"),$scope.override=!1},$scope.form_to_trello=function(){function onSubmit(){formData=vm.model,console.log(formData),formData.start_date=moment($scope.datePicker.date.startDate._d).startOf("day"),formData.end_date=moment($scope.datePicker.date.endDate._d);var leave=new Leave(formData);Team.query({},function(team){_.each(team,function(_team,i){_team._id==formData.username&&(leave.team_member=_team._id,console.log("before",team[i].leave_taken),new_leave=[],new_ids=[],_.each(team[i].leave_taken,function(leave_me,index){$scope.ids_to_delete.indexOf(leave_me._id)==-1&&new_ids.indexOf(leave_me._id)==-1&&(new_leave.push(leave_me),new_ids.push(leave_me._id))}),team[i].leave_taken=new_leave,leave.$save(function(resp){console.log("response",resp),team[i].leave_taken.push(resp._id),console.log("after",team[i].leave_taken),Team.update({id:_team._id},team[i]),vm.options.resetModel(),$scope.overlapalert=[]}))})})}var vm=this;vm.onSubmit=onSubmit,vm.author={name:"#",url:"#"},vm.exampleTitle="Introduction",vm.env={angularVersion:angular.version.full},vm.model={username:"",notes:"",team:"",start_date:"",end_date:"",_type:""},vm.fields=[{key:"username",type:"select",expressionProperties:{"templateOptions.onChange":function($viewValue,$modelValue,$scope){check_dates($viewValue)}},templateOptions:{label:"Name",options:boards}},{key:"_type",type:"select",templateOptions:{label:"Type",options:leave_type}},{key:"notes",type:"textarea",templateOptions:{label:"Notes",placeholder:"",description:""}}]}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/team/leave-controller.js","/../components/team")},{b55mWE:4,buffer:3}],160:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_settings_controller=function($scope,$http,$q,$routeParams,$location,screen_saver_loop,$rootScope,detect_dragging,trello,get_trello_board,date_calc,Todos,Tallys,Team,Timeline,$mdEditDialog){$scope.rows=[],$scope.counter=0,$scope.addRow=function(){var team=new Team({name:$scope.counter});team.$save(function(){}),$scope.rows.push("Row "+$scope.counter),$scope.counter++},Team.query({},function(team){_.each(team,function(row,index){number_days_leave_taken=0,_.each(row.leave_taken,function(leave){leave.start_date>=row.leave_start&&leave.end_date<=row.leave_year_end&&(number_days_leave_taken+=leave.weekday_duration)}),row.number_days_leave_remaining=row.number_days_leave-number_days_leave_taken,$scope.rows.push(row),$scope.counter++})}),$scope.editComment=function(event,dessert){event.stopPropagation();var myArray=[],key="happyCount",obj={};obj[key]=event.target.attributes[0].nodeValue,myArray.push(obj);var promise=$mdEditDialog.small({modelValue:dessert.comment,placeholder:"Add a comment",save:function(input){event.target.innerHTML=input.$modelValue;var query={id:dessert._id};Team.update(query,{myArray:input.$modelValue},function(err,affected,resp){console.log(resp)})},targetEvent:event,validators:{"md-maxlength":30}});promise.then(function(ctrl){var input=ctrl.getInput();input.$viewChangeListeners.push(function(){input.$setValidity("test","test"!==input.$modelValue)})})}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/team/team-controller.js","/../components/team")},{b55mWE:4,buffer:3}],161:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){var async=require("async");exports.tech_support_controller=function($scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,tech_get_trello_board,date_calc,Tech_support){$scope.rows=[],$scope._rows=[],Tech_support.query({},function(team){async.forEach(team,function(row,callback2){row.editable=!0,$scope._rows.push(row),$scope.counter++,callback()},function(err){return err?next(err):void($scope.gridOptions.data=$scope._rows)})});var lists=[],list=[];list.id="5710a18fc2c7adc11a382e94",lists.push(list);var list=[];list.id="57c6f2715e4ad081f42204ec",lists.push(list);var list=[];list.id="57558712bec1ad7712beb29e",lists.push(list),trello.auth(),$scope.gridOptions=[],$scope.gridOptions.columnDefs=[],$scope.gridOptions={columnDefs:[{field:"list",resizable:!0},{field:"date_created",type:"date"},{field:"last_updated",type:"date"},{field:"name",width:"450",height:"50",resizable:!0},{field:"weekday_duration",displayName:"Age",type:"number"},{field:"category",enableCellEdit:!0,enableFiltering:!0,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"AV",value:"AV"},{id:"TECHNICIANS",value:"TECHNICIANS"},{id:"ELECTRICIAN",value:"ELECTRICIAN"},{id:"CONSERVATORS",value:"CONSERVATORS"},{id:"EXTERNAL",value:"EXTERNAL"},{id:"UNASSIGNED",value:"UNASSIGNED"}]},{field:"type",enableCellEdit:!0,enableFiltering:!0,editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"SOFTWARE",value:"SOFTWARE"},{id:"HARDWARE",value:"HARDWARE"},{id:"CONTENT",value:"CONTENT"},{id:"WEAR",value:"WEAR"}]},{field:"difficulty",resizable:!0,type:"number"},{field:"aknowledged",type:"date",resizable:!0},{field:"resolution",resizable:!0}],enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!0,enableCellEditOnFocus:!0,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){
$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){var myArray=[],key=colDef.field,obj={};obj[key]=newValue,myArray.push(obj);var query={id:rowEntity._id},query={id:rowEntity._id};Tech_support.update(query,obj,function(err,affected,resp){var comment_text=[colDef.field]+": "+newValue,data={text:comment_text};Trello.post("cards/"+rowEntity._id+"/actions/comments",data)})})}},get_list=function(row,cb){var query={id:row.id};Trello.get("cards/"+row.id+"?fields=idList,dateLastActivity",function(card){console.log("got card"),Trello.get("lists/"+card.idList+"?fields=name",function(list){console.log("got list"),row.editable=!0,$scope.rows.push(row),$scope.counter++,Tech_support.update(query,{list:list.name,last_updated:card.dateLastActivity},cb())})})},$scope.rows=[],$scope.column_headings=[],tech_get_trello_board.get_data(lists,function(){console.log("updated latest lists from trello",lists),Tech_support.query({},function(team){console.log(team);for(var key in team[0]){var dont_shows=["_id","__v","_id","$get","$save","$query","$remove","$delete","toJSON","$update"];dont_shows.indexOf(key)==-1&&$scope.column_headings.push(key)}async.forEach(team,function(row,callback){row.editable=!0,$scope._rows.push(row),$scope.counter++,callback()},function(err){return err?next(err):void($scope.gridOptions.data=$scope._rows)})})})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/tech-support/tech-support-controller.js","/../components/tech-support")},{async:1,b55mWE:4,buffer:3}],162:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.techSupport=function(){return{controller:"tech_support_controller",templateUrl:"./components/tech-support/tech-support-page.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/tech-support/tech-support-directive.js","/../components/tech-support")},{b55mWE:4,buffer:3}],163:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){var async=require("async");exports.tech_get_trello_board=function(date_calc,$http,Tech_support){var trello=[];return trello.get_data=function(listx,cb){console.log("trello.get_data");listx.length;async.forEach(listx,function(list,callback2){list_id=list.id,Trello.get("lists/"+list.id+"/cards",function(cards){console.log("get list data");var list=[];list._cards=[],tally=0,card_count=0,async.forEach(cards,function(card,callback){idBoard=card.id,console.log("trello card",card),support_card={id:card.id,name:card.name,list_id:card.idList,last_updated:card.dateLastActivity,tint:1-date_calc.diffDays(card.dateLastActivity)/10,dateLastActivity:card.dateLastActivity,link:card.shortUrl,date_created:new Date(1e3*parseInt(idBoard.substring(0,8),16))},Tech_support.update({id:card.id},support_card,callback())},function(err){return err?next(err):(console.log("done updating mongo"),void callback2())})})},function(err){return err?next(err):(console.log("all done "),void cb())})},trello}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/tech-support/trello-services.js","/../components/tech-support")},{async:1,b55mWE:4,buffer:3}],164:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.raw_timelinesettings_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Timeline_data,data_table_reload,get_table_data,grid_ui_settings,make_a_pie,make_a_line_chart,monthly_data_table_columns,table_security){$scope.show_all_Button=!0,$scope.featured_collection=Timeline_data,$rootScope.featured_collection=Timeline_data,$scope.gridOptions=[],$scope.gridOptions.data=[],$scope.extraQuery={googlesheet_id:"#",googlesheet_name:"#"};var columnDefs=[];$rootScope.canEdit_table=!0,columnDefs.push({field:"googlesheet_id",name:"googlesheet_id",resizable:!0,width:"150"},{field:"googlesheet_name",name:"googlesheet_name",resizable:!0,width:"150"},{field:"group_column",name:"group_column",resizable:!0,width:"150"},{field:"type",name:"type",resizable:!0,width:"150"},{field:"use_moment",name:"use_moment",resizable:!0,width:"150"},{field:"track",name:"track",resizable:!0,width:"150"},{field:"type_column",name:"type_column",resizable:!0,width:"150"},{field:"title_column",name:"title_column",resizable:!0,width:"150"},{field:"start_column",name:"start_column",resizable:!0,width:"150"},{field:"end_column",name:"end_column",resizable:!0,width:"150"}),$scope.gridOptions=grid_ui_settings.monthly(columnDefs,$scope),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope)}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline-settings/raw-timeline-settings-controller.js","/../components/timeline-settings")},{b55mWE:4,buffer:3}],165:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.record_timelinesettings_controller=function($scope,$http,$q,Timeline_data,data_table_reload,get_table_data){function save(kpis){kpis.$save(function(err,user){err&&console.log(err);var message="data saved successfully";message+="\n ",alert(message),get_table_data.getData(moment(new Date).subtract({months:1})._d,$scope),$scope.message="data saved successfully"})}$scope.extraQuery={googlesheet_id:"#",googlesheet_name:"#"},$scope.Timeline_data=Timeline_data,$scope.onSubmit=function(){var kpis=new Timeline_data({googlesheet_id:visit_form.googlesheet_id.value,googlesheet_name:visit_form.googlesheet_name.value,group_column:visit_form.group_column.value,type:visit_form.type.value,use_moment:visit_form.use_moment.value,track:visit_form.track.value,type_column:visit_form.type_column.value,title_column:visit_form.title_column.value,end_column:visit_form.end_column.value,start_column:visit_form.start_column.value,comments:visit_form.comments.value,logger_user_name:$scope.user.username}),query={googlesheet_id:visit_form.googlesheet_id.value,googlesheet_name:visit_form.googlesheet_name.value};Timeline_data.query(query,function(visits){$scope.$emit("form_submit"),console.log("Raw_visits",visits.length),$scope.results=visits,visits.length>0?confirm("we already have a figure of "+visits[0].value+" for that date - are you sure you wnt to overwrite it ?")&&(_.each(visits,function(visit){Timeline_data.remove({id:visit._id},function(){console.log("removed old data")})}),save(kpis)):save(kpis)})},$(document).ready(function(){$scope.$emit("donations_performance_form"),$scope.savex=function(kpis){save(kpis)}})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline-settings/settings-form-controller.js","/../components/timeline-settings")},{b55mWE:4,buffer:3}],166:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timelinesettingsFormdata=function(){return{templateUrl:"./components/timeline-settings/form-and-data.html"}},exports.rawTimelinesettings=function(){return{controller:"raw_timelinesettings_controller",templateUrl:"./shared/templates/data_table.html"}},exports.recordTimelinesettings=function(){return{controller:"record_timelinesettings_controller",templateUrl:"./components/timeline-settings/kpi-form.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline-settings/timeline-settings-directive.js","/../components/timeline-settings")},{b55mWE:4,buffer:3}],167:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_bookings_functions=function(timeline_functions,$http,Timeline,$rootScope,$location){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/team/digital/projects/scripts/php/emu/loans.php?start_date=2014-01-01";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){console.log("Current route name: "+$location.path());var visevents=new vis.DataSet;return tempdates=[],$rootScope.added_track_groups.indexOf("ROOM BOOKING")==-1&&"/room-hire"==$location.path()&&($rootScope.added_track_groups.push("ROOM BOOKING"),$rootScope.track_groups.push({track:"ROOM BOOKING",selected:!0})),$rootScope.added_track_groups.indexOf("EQUIPMENT BOOKING")==-1&&"/equipment-timeline"==$location.path()&&($rootScope.added_track_groups.push("EQUIPMENT BOOKING"),$rootScope.track_groups.push({track:"EQUIPMENT BOOKING",selected:!0})),console.log("BOOKINGS EVENTS",eventss),$.each(eventss,function(index,data){data.days=timeline_functions.days(data.start_date,data.end_date);var end_date;if(""!=data.group&&""!=data.start_date){"undefined"!=typeof data.end_date&&(end_date=moment(data.end_date).format("MMM Do YY")),"ROOM BOOKING"==data._type?(install_instance_tally++,install_days_tally+=data.days):"DERIG"==data._type&&(derig_tally++,derig_days_tally+=data.days),$rootScope.added_track_groups.indexOf(data._type)==-1&&$rootScope.added_track_groups.push(data._type);var event_to_add={id:data._id,name:data.name+" - "+data.internal_external,showimage:"",image:"",className:0==data.approved?"pending":"blue",start_date:moment(data.start_date).format("MMM Do"),end_date:end_date||"",notes:data.notes,approved:data.approved,days:data.days};console.log("event_to_add",event_to_add),visevents.add({_id:data._id,className:event_to_add.className,select_group:!1,name:data.name,_type:data._type,track:data._type,content:timeline_functions.event_html(event_to_add),group:data.group,order:data._type,notes:data.notes,approved:data.approved,start:data.start_date,days:data.days,end:data.end_date})}}),console.log("visevents",visevents),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-bookings-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],168:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_controller=function($compile,$scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,timeline_bookings_functions,Timeline_data,get_trello_board,date_calc,Todos,Timeline,Bookings,Team,kiosk_activity,timeline_functions,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate,Raw_visits,timeline_visitor_figures_functions,timeline_install_functions,$timeout,timeline_exhibitions_functions){$scope.locked=[],$scope.locked.add_item=!1,$scope.locked["true"]={status:" locked",value:!1},$scope.locked["false"]={status:" unlocked",value:!0},$scope.average_install_length=0,$scope.password=!1,$scope.lockstatus=!1,$scope.average_derig_length=0,$rootScope.addednames=[],$rootScope.track_groups=[],$rootScope.added_track_groups=[],$rootScope.datePicker=[],$scope.isloggedin=!1,$scope.isloggedin=!1,$scope.timeline_track=Timeline,$rootScope.installmodels=[],$rootScope.installmodels.push({name:"painting",selected:!1,icon:"picture"}),$rootScope.installmodels.push({name:"graphics",selected:!1,icon:"tint"}),$rootScope.installmodels.push({name:"av",selected:!1,icon:"volume-up"}),$rootScope.installmodels.push({name:"build",selected:!1,icon:"wrench"}),$rootScope.installmodels.push({name:"objects",selected:!1,icon:"tower"}),$scope.haspermissions=!1,$scope.init=function(timeline_mode){setTimeout(function(){"room-hire"==timeline_mode?$scope.timeline_track=Bookings:$scope.timeline_track=Timeline,AuthService.isLoggedIn().then(function(user){$scope.user=user,$scope.isloggedin=!0,"ADMIN"==user.data.group&&($scope.haspermissions=!0),"EXHIBITIONS"==user.data.group&&($scope.haspermissions=!0),"DIGITAL"==user.data.group&&($scope.haspermissions=!0),main_function(timeline_mode)}),setTimeout(function(){0==$scope.isloggedin&&main_function(timeline_mode)},2e3)})},main_function=function(timeline_mode){"room-hire"==timeline_mode?timeline_track=Bookings:timeline_track=Timeline,$scope.filter_pie=[],$scope.filter_pie.push({value:"2017 total_children",name:"No. children"}),$scope.filter_pie.push({value:"2017 total_sessions",name:"No. sessions"}),$scope.filter_pie.push({value:"2017 total_teachers",name:"No. teachers"}),$scope.filter_pieSelected=$scope.filter_pie[0].name,$scope.plot_graph=null,$rootScope.datePicker.date={startDate:null,endDate:null},$scope.dateRangeOptions={locale:{format:"DD/MM/YYYY"},eventHandlers:{"apply.daterangepicker":function(){if(date=$rootScope.datePicker.date,days=timeline_functions.days(moment(date.startDate),moment(date.endDate)),moment(date.startDate).isValid()){var event_to_add={id:$scope.selected_id,name:$scope.selected_item,showimage:"",image:"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes+"("+days+" days)",install_features:$rootScope.installmodels,days:days};html=timeline_functions.event_html(event_to_add);var options={id:$scope.selected_timeline_id,content:html,install_features:$rootScope.installmodels,start:moment(date.startDate)._d,end:moment(date.endDate)._d,start_date:moment(date.startDate)._d,end_date:moment(date.endDate)._d};timeline_track.update({id:$scope.selected_id},options),console.log("updatedItem",options),timeline_functions.updateItem(options)}}}},$scope.$watch("selected_notes",function(selected_note){console.log("selected_notes edited",selected_note),timeline_functions.event_edited($scope,selected_note)}),$scope.$watch("selected_approved",function(selected_approved){console.log("selected_approved edited",selected_approved),timeline_functions.event_edited($scope,selected_approved)}),$scope.$watch("selected_item",function(selected_item){if(1==timeline.options.editable&&(date=$rootScope.datePicker.date,days=timeline_functions.days(moment(date.startDate),moment(date.endDate)),$scope.selected_start=moment(date.startDate).format("MMM Do"),$scope.selected_end=moment(date.endDate).format("MMM Do"),moment(date.startDate).isValid())){var event_to_add={id:$scope.selected_id,name:$scope.selected_item,showimage:"",image:"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes,days:days};html=timeline_functions.event_html(event_to_add);var options={id:$scope.selected_timeline_id,content:html,name:selected_item,start:moment(date.startDate)._d,end:moment(date.endDate)._d};timeline_track.update({id:$scope.selected_id},options),console.log("called by selected_item"),timeline_functions.updateItem(options)}}),$scope.$watch("stack",function(stack){console.log("stack"),"undefined"!=typeof stack&&(options={stack:stack},timeline_functions.updateOptions(options))}),$scope.editing=[],$scope.timeline=Timeline.query(),$scope.removeTimeline=function(id){timeline_track.remove({id:id})},timeline_track.query({},function(team){_.each(team,function(row,index){var timeline=$scope.timeline[index];"Bristol Archives"==timeline.group&&timeline_track.remove({id:timeline._id},function(){})})}),$scope.save=function(){if($scope.newTimeline&&!($scope.newTimeline.length<1)){var timeline=new timeline_track({name:$scope.newTimeline,completed:!1});timeline.$save(function(){$scope.timeline.push(timeline),$scope.newTimeline=""})}},$scope.update=function(index){var timeline=$scope.timeline[index];timeline_track.update({id:timeline._id},timeline),$scope.editing[index]=!1},$scope.edit=function(index){$scope.editing[index]=angular.copy($scope.timeline[index])},$scope.cancel=function(index){$scope.timeline[index]=angular.copy($scope.editing[index]),$scope.editing[index]=!1},$scope.remove=function(index){var timeline=$scope.timeline[index];timeline_track.remove({id:timeline._id},function(){$scope.timeline.splice(index,1)})},$scope.datePicker="",$scope.datePicker.date={startDate:null,endDate:null},$scope.machine_types=[],$scope.type="all",$scope.changedValue=function(place){$rootScope.filter_pieSelected=place},$scope.machinesx=["all"],$scope.filterCondition={machine:"neq"},$scope.$watch("type",function(type){$scope.machinesx=["all"]}),$scope.machine_types_selection=[],$scope.categories=[],$scope.category_selection=[];new vis.DataSet,new vis.DataSet,new vis.DataSet;install_days_tally=0,install_instance_tally=0,derig_tally=0,derig_days_tally=0,$scope.total_install_derig=install_days_tally+derig_days_tally,$scope.average_install_length=Math.round(install_days_tally/install_instance_tally),$scope.average_derig_length=Math.round(derig_days_tally/derig_tally);var container=document.getElementById("example-timeline");timeline=new vis.Timeline(container),$rootScope.timeline=timeline,date={content:"STARTER",group:"STARTER",group_id:"STARTER",id:"STARTER",name:"STARTER",event_type:"STARTER",track:"STARTER",order:"STARTER",subgroup:"STARTER",start:new Date,end:new Date},timeline_functions.setup($scope.timeline_track,$rootScope.groups,new vis.DataSet(date)),$scope.add_exhibitions=function(){timeline_functions.populate_timeline_track_method_b($rootScope,timeline_exhibitions_functions,timeline_track)},$scope.add_installs_derigs=function(){timeline_functions.populate_timeline_track($rootScope,Timeline,timeline_install_functions,timeline_track)},$scope.team_leave=function(){timeline_functions.populate_timeline_track_method_b($rootScope,timeline_leave_functions,timeline_track)},$scope.visitor_figures=function(){timeline_functions.populate_timeline_track($rootScope,Raw_visits,timeline_visitor_figures_functions,timeline_track)},$scope.bookings=function(){timeline_functions.populate_timeline_track($rootScope,Bookings,timeline_bookings_functions,timeline_track)},$scope.shopify=function(){timeline_functions.populate_timeline_track($rootScope,Shopify_aggregate,timeline_shopify_functions,timeline_track)},$scope.loans=function(){timeline_functions.populate_timeline_track_method_b($rootScope,timeline_loans_functions,timeline_track)},$scope.learning_bookings=function(){timeline_functions.populate_timeline_track_method_b($rootScope,timeline_learning_functions,timeline_track)},$scope.timeline_googlesheets_functions=function(data_settings){var groups=$rootScope.groups;$rootScope.timeline.setGroups(groups),timeline_googlesheets_functions.get_events(data_settings)},"room-hire"==timeline_mode?(timeline_track=Bookings,$scope.bookings()):(timeline_track=Timeline,$scope.isloggedin&&(Timeline_data.query({},function(data){_.each(data,function(data_settings){""!=data_settings.googlesheet_id&&timeline_googlesheets_functions.get_events(data_settings)})}),$scope.add_installs_derigs(),$scope.visitor_figures()),$scope.add_exhibitions());var checked_event_types=[];checked_event_types.push("Tour"),checked_event_types.push("Walk"),checked_event_types.push("Rides"),checked_event_types.push("Tours"),checked_event_types.push("Talk"),checked_event_types.push("Lecture"),checked_event_types.push("Special Event"),checked_event_types.push("Event"),checked_event_types.push("Family"),$scope.$watch("installmodels|filter:{selected:true}",function(nv){timeline_functions.event_edited($scope)},!0),$scope.$watch("track_groups|filter:{selected:true}",function(nv){var selection=nv.map(function(track_groups){return track_groups.track});$scope.selected_tracks=selection,timeline_functions.changeTracks(selection)},!0),$scope.$watch("groups|filter:{selected:true}",function(nv){var selection=nv.map(function(group){return group.content});timeline_functions.changeGroups(selection),$(".draggable,.iconbar").css({top:"0px"})},!0),$scope.exportCSV=function(){data_to_export=$rootScope.timeline.itemsData.getDataSet(),visibles=$rootScope.timeline.getVisibleItems(),events=[],_.each(data_to_export._data,function(event,index){if(visibles.indexOf(event.id)!=-1){console.log("in");var _event={id:event.id,name:event.name,start_date:moment(event.start).format("DD/MM/YYYY"),end_date:moment(event.end).format("DD/MM/YYYY"),event_type:event.track};events.push(_event)}}),timeline_functions.export_JSON_to_CSV(events,"Timeline dates",!0)},$scope.list1={title:"PROVISIONAL DATE"},$scope.list2={title:"INSTALL"},$scope.list3={title:"DERIG"},$scope.onDropComplete=function(data,evt){}}},exports.BasicDemoCtrl=function(timeline_functions,$mdDialog,$scope,$http,$q,$routeParams,$location){$scope.$watch("track.stack",function(stack){console.log("stack"),"undefined"!=typeof stack&&(options={stack:stack},timeline_functions.updateOptions(options))});var originatorEv;this.openMenu=function($mdMenu,ev){originatorEv=ev,$mdMenu.open(ev)},this.notificationsEnabled=!1,this.toggleNotifications=function(){this.notificationsEnabled=!this.notificationsEnabled},this.redial=function(){},this.checkVoicemail=function(){}},exports.add_timeline_items_controller=function($scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,get_trello_board,date_calc,Todos,Timeline,Team,kiosk_activity,timeline_functions,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate){$scope.unlocked=!1,$scope.$watch("locked",function(locked){$scope.locked=locked})},exports.add_timeline_info_box=function($scope,$http,$q,$routeParams,$location,$location,$rootScope,trello,get_trello_board,date_calc,Todos,Timeline,Team,kiosk_activity,timeline_functions,timeline_leave_functions,timeline_learning_functions,timeline_loans_functions,timeline_googlesheets_functions,Timeline_data,AuthService,timeline_shopify_functions,Shopify_aggregate){}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-controller.js","/../components/timeline")},{b55mWE:4,buffer:3}],169:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeLine=function(){return{controller:"timeline_controller",templateUrl:"./components/timeline/timeline-page.html"}},exports.timelineBookings=function(){return{controller:"timeline_resources_controller",templateUrl:"./components/timeline/timeline-page.html"}},exports.timelineMenu=function(){return{controller:"BasicDemoCtrl",templateUrl:"./components/timeline/menu.html"}},exports.addtimelineItems=function(){return{controller:"add_timeline_items_controller",templateUrl:"./components/timeline/add-items-block.html"}},exports.timelineInfobox=function(){return{controller:"add_timeline_info_box",templateUrl:"./components/timeline/info-box.html"}},exports.timelineDatabar=function($compile){return{restrict:"E",link:function($scope,$el){var script=document.createElement("script");script.text="$(function() {;",script.text+=" $('#infobutton'+ '"+$scope.id+"').hide();",script.text+=" $('#miniicon'+ '"+$scope.id+"').show();",script.text+=" $('#timeline'+ '"+$scope.id+"').mouseover(function() {",script.text+=" $('#infobutton'+ '"+$scope.id+"').show();",script.text+=" $('#miniicon'+ '"+$scope.id+"').hide();",script.text+="});",script.text+=" $('#timeline'+ '"+$scope.id+"').mouseout(function() {",script.text+=" $('#infobutton'+ '"+$scope.id+"').hide();",script.text+=" $('#miniicon'+ '"+$scope.id+"').show();",script.text+="});",script.text+="$('#infobutton'+ '"+$scope.id+"').on('click', function(event){ ",script.text+=" $('#infobox_name').text('').append('"+$scope.name+"'); ",script.text+=" $('#infobox_description').text('').append('"+$scope.description+"');",script.text+="});});",$el.append(script)},templateUrl:"./components/timeline/timeline-item.html",scope:{startdate:"@",id:"@",enddate:"@",name:"@",description:"@",image:"@",showimage:"@",notes:"@",days:"@",painting:"@",av:"@",build:"@",objects:"@",graphics:"@"}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-directive.js","/../components/timeline")},{b55mWE:4,buffer:3}],170:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_exhibitions_functions=function(timeline_functions,$http,Timeline,$rootScope,$routeParams){return{get_events:function(){return $http.get("/assets/data/all_events.JSON")},add_events:function(eventss,fn){var visevents=new vis.DataSet,checked_event_types=(new vis.DataSet,[]);return $("#add_emu_exhibitions").is(":checked")&&(checked_event_types.push("Exhibition"),checked_event_types.push("Gallery")),checked_event_types.push("Family"),checked_event_types.push("Tour"),checked_event_types.push("Walk"),checked_event_types.push("Rides"),checked_event_types.push("Tours"),checked_event_types.push("Talk"),checked_event_types.push("Lecture"),checked_event_types.push("Special Event"),checked_event_types.push("Event"),$.each(eventss.data.events,function(index,event){if(""!=event.startDate&&("Exhibition"==event.type||"Gallery"==event.type||"Gallery Refurbishment"==event.type)){new Date(event.endDate);if(""==event.endDate||event.endDate==event.startDate){new Date(event.startDate)}var group="NA";"Exhibition"==event.type||"Gallery"==event.type||"Gallery Refurbishment"==event.type?(group=event.event_space||"NA","Bristol Museum & Art Gallery"==event.venue&&(venue_pic=176421),"Red Lodge Museum"==event.venue&&(venue_pic=37235),"Georgian House"==event.venue&&(venue_pic=189420),"Bristol Archives"==event.venue&&(venue_pic=217822),"M Shed"==event.venue&&(venue_pic=206079),group_name="<table><tr><td><b>"+event.event_space+"</b><br></br>",group_name+=event.venue+"</td><td>",group_name+='<img  class="pull-right" src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+venue_pic+'&height=50&format=jpeg" />',group_name+="</td></tr></table>"):group=event.type||"NA";var eventimages=!1;event.images[0]&&(eventimages=event.images[0].irn);var event_to_add={},event_to_add={id:event.ID,name:event.name,showimage:event.images[0],image:eventimages,start_date:event.startDate,end_date:event.endDate,notes:"",description:event.description,days:""},htmlContent=timeline_functions.event_html(event_to_add);$rootScope.added_track_groups.indexOf(event.venue)==-1&&($rootScope.added_track_groups.push(event.venue),$rootScope.track_groups.push({track:event.venue})),select_group=!0,$routeParams.track&&(select_group=!1,"Arts and Events"==$routeParams.track&&(select_group=!0)),event.startDate&&visevents.add({group:group,ID:event.ID,group_name:group_name,select_group:select_group,title:event.name,name:event.name,type:"background",content:htmlContent,order:event.venue+event.event_space,track:event.venue,start:new Date(event.startDate),end:new Date(event.endDate).setHours(23),className:"green",event_type:"WHATS ON"})}}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-exhibitions-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],171:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_googlesheets_functions=function(timeline_functions,$http,Timeline,$rootScope,$routeParams){return{get_events:function(data_settings,cb){var self=this;return data_settings.data_feed_url?$http.get(data_settings.data_feed_url).then(function(datax){self.add_events(data_settings,datax,function(public_dates){$rootScope.leave_groups=timeline_functions.loadgroups(public_dates),_.each($rootScope.leave_groups,function(_group){$rootScope.groups.push(_group)}),_.each(public_dates._data,function(date){$rootScope.timeline.itemsData.getDataSet().add(date)})})}):$http.get("https://script.google.com/macros/s/AKfycbzij_r2bTK6fiWU-h29rglHktd8pwbLfrti82Or68TkEjEHrOc/exec?id="+data_settings.googlesheet_id).then(function(datax){self.add_events(data_settings,datax,function(public_dates){$rootScope.leave_groups=timeline_functions.loadgroups(public_dates),_.each($rootScope.leave_groups,function(_group){$rootScope.groups.push(_group)}),_.each(public_dates._data,function(date){$rootScope.timeline.itemsData.getDataSet().add(date)})})},function(err){console.log(err)})},add_events:function(data_settings,eventss,fn){var visevents=new vis.DataSet,self=this;new Date;return $.each(eventss.data[data_settings.googlesheet_name].events||eventss.data[data_settings.googlesheet_name],function(index,event){if($rootScope.added_track_groups.indexOf(data_settings.track)==-1&&($rootScope.added_track_groups.push(data_settings.track),$rootScope.track_groups.push({track:data_settings.track})),"numerical"==data_settings.type)scale_class="",event[data_settings.value_column]>data_settings.val_1&&event[data_settings.value_column]<=data_settings.val_2&&(scale_class="scale_01"),event[data_settings.value_column]>data_settings.val_2&&event[data_settings.value_column]<=data_settings.val_3&&(scale_class="scale_02"),event[data_settings.value_column]>data_settings.val_3&&event[data_settings.value_column]<=data_settings.val_4&&(scale_class="scale_03"),event[data_settings.value_column]>data_settings.val_4&&event[data_settings.value_column]<=data_settings.val_5&&(scale_class="scale_05"),event[data_settings.value_column]>data_settings.val_5&&event[data_settings.value_column]<=data_settings.val_6&&(scale_class="scale_06"),event[data_settings.value_column]>data_settings.val_6&&event[data_settings.value_column]<=data_settings.val_7&&(scale_class="scale_07"),
event[data_settings.value_column]>data_settings.val_7&&event[data_settings.value_column]<=data_settings.val_8&&(scale_class="scale_08"),event[data_settings.value_column]>data_settings.val_8&&event[data_settings.value_column]<=data_settings.val_9&&(scale_class="scale_09"),event[data_settings.value_column]>data_settings.val_9&&event[data_settings.value_column]<=data_settings.val_10&&(scale_class="scale_09"),event[data_settings.value_column]>data_settings.val_10&&(scale_class="scale_10"),1==data_settings.use_moment?(start_date=moment(event[data_settings.date_column])._d,end_date=moment(event[data_settings.date_column])._d,end_date.setDate(end_date.getDate()+1)):(start_date=event[data_settings.start_column],end_date=event[data_settings.end_column],end_date.setDate(end_date.getDate()+1),end_date.setHours(15)),select_group=!0,$routeParams.track&&(select_group=!1,$routeParams.track==data_settings.track&&(select_group=!0)),__event={content:"",select_group:select_group,group:event[data_settings.group_column]||data_settings.group,group_id:event[data_settings.group_id_column]||data_settings.track,name:event[data_settings.value_column].toFixed(2),title:event[data_settings.value_column].toFixed(2),event_type:data_settings.track,track:data_settings.track,order:data_settings.track,type:data_settings.event_type||"",subgroup:event[data_settings.subgroup_column],start:start_date,end:end_date,className:scale_class},console.log("__event",__event),visevents.add(__event);else{1==data_settings.use_moment?(start_date=moment(event[data_settings.date_column])._d,end_date=moment(event[data_settings.date_column])._d,end_date.setDate(end_date.getDate()+1)):(start_date=new Date(event[data_settings.start_column]),end_date=new Date(event[data_settings.end_column]),end_date.setHours(23));var event_image_irn,event_image=!1;event.images&&event.images[0]&&(event_image=!0,event_image_irn=event.images[0].irn);var htmlContent=self.event_html(event[data_settings.title_column],event_image,event_image_irn,moment(start_date).startOf("day").format("MMM Do"),moment(end_date).startOf("day").format("MMM Do"));select_group=!1,$routeParams.track&&(select_group=!1,$routeParams.track==data_settings.track&&(select_group=!0));var colour="red";data_settings.colour&&(colour=data_settings.colour),data_settings.type_column&&(colour="MILESTONE"==event[data_settings.type_column]?"green":"red"),this_event={content:htmlContent,select_group:select_group,group_id:event[data_settings.group_column]+data_settings.track||data_settings.track,name:event[data_settings.title_column]||"NA",title:event[data_settings.title_column]||"NA",event_type:data_settings.track,track:data_settings.track,order:data_settings.track,type:data_settings.event_type||"",start:start_date,className:colour},""!=data_settings.subgroup_column&&(this_event.subgroup=event[data_settings.subgroup_column]),""!=data_settings.group&&(this_event.group=data_settings.group),data_settings.group_column&&(this_event.group=event[data_settings.group_column]),this_event.end=end_date,this_event.start&&this_event.group?visevents.add(this_event):console.log("no start or group",this_event)}}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+" - "+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-googlesheets-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],172:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_install_functions=function(timeline_functions,$http,Timeline,$rootScope){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/team/digital/projects/scripts/php/emu/loans.php?start_date=2014-01-01";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){var visevents=new vis.DataSet;return tempdates=[],$rootScope.added_track_groups.indexOf("Shopify product types")==-1,console.log("INSTALL EVENTS",eventss),$.each(eventss,function(index,data){data.days=timeline_functions.days(data.start_date,data.end_date);var end_date;if(""!=data.group&&""!=data.start_date){"undefined"!=typeof data.end_date&&(end_date=moment(data.end_date).format("MMM Do YY")),"INSTALL"==data._type?(install_instance_tally++,install_days_tally+=data.days):"DERIG"==data._type&&(derig_tally++,derig_days_tally+=data.days),$rootScope.added_track_groups.indexOf(data._type)==-1&&$rootScope.added_track_groups.push(data._type);var event_to_add={id:data._id,name:data.name,showimage:"",image:"",start_date:moment(data.start_date).format("MMM Do"),end_date:end_date||"",notes:data.notes,days:data.days,install_features:data.install_features};visevents.add({_id:data._id,className:data.className,select_group:!1,name:data.name,_type:data._type,track:data._type,content:timeline_functions.event_html(event_to_add),group:data.group||"NA",order:data._type,notes:data.notes,start:data.start_date,days:data.days,install_features:data.install_features,end:new Date(data.end_date).setHours(23)})}}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-installs-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],173:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_learning_functions=function($http,Timeline,$rootScope){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/~brlsmp4/learning/scripts/php/api/api.php?table=bookings";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){var visevents=new vis.DataSet;new Date;return tempdates=[],$rootScope.added_track_groups.indexOf("school visits")==-1&&($rootScope.added_track_groups.push("school visits"),$rootScope.track_groups.push({track:"school visits"})),console.log("eventss",eventss),$.each(eventss.data,function(index,event){end_date=new Date(event.event_date),end_date.setDate(end_date.getDate()+1),""!=event.school_name&&visevents.add({content:event.school_name,name:event.school_name,group:event.site,group_id:event.site+"school visits",event_type:"public holidays",track:"school visits",order:"school visits",className:"orange",start:event.event_date,end:end_date,subgroup:"na",notes:event.booking_form_info})}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-learning-bookings-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],174:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_leave_functions=function($http,Timeline,$rootScope){return{get_eventss:function(){return $http.get("https://script.google.com/macros/s/AKfycbzij_r2bTK6fiWU-h29rglHktd8pwbLfrti82Or68TkEjEHrOc/exec?id=1v69qKCc-8FYx8VuKPZMr1QkTMfJsh7qZTZJ7q7o3YTg")},add_events:function(eventss,fn){var mylastfrom_date,visevents=new vis.DataSet,names=(new Date,[]),name=[],oldName="",lastfrom_date="";return tempdates=[],$.each(eventss.data.tally,function(index,leave_record){if(leave_record.NAME!=oldName){""!=name.start_date&&(names.push(name),name=[]),oldName=leave_record.NAME,lastfrom_date=leave_record.DATE,mylastfrom_date=new Date(leave_record.DATE),name.start_date=new Date(leave_record.DATE),name.name=leave_record.NAME,name.group=leave_record.TYPE;var end_date=new Date(lastfrom_date);end_date.setDate(end_date.getDate()+1),name.end_date=end_date}else if(new Date(mylastfrom_date)-new Date(leave_record.DATE)==-864e5)mylastfrom_date=new Date(leave_record.DATE),name.end_date=new Date(leave_record.DATE),name.end_date.setDate(name.end_date.getDate()+1);else{names.push(name),name=[],name.name=leave_record.NAME,name.group=leave_record.TYPE,name.start_date=new Date(leave_record.DATE);var non_consecutive_end_date=new Date(leave_record.DATE);name.end_date=non_consecutive_end_date.setDate(non_consecutive_end_date.getDate()+1)}}),$.each(names,function(index,value){""!=value.name&&value.start_date&&($rootScope.added_track_groups.indexOf("leave")==-1&&($rootScope.added_track_groups.push("leave"),$rootScope.track_groups.push({track:"leave"})),visevents.add({content:value.name,group:value.group,group_id:value.group+"leave",id:value.id,name:value.name,event_type:"leave",track:"leave",order:"leave",subgroup:value.name,start:value.start_date,end:value.end_date,className:"orange"}))}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},get_events:function(){return $http.get("/data/events.JSON")},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-leave-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],175:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_loans_functions=function($http,Timeline,$rootScope){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/team/digital/projects/scripts/php/emu/loans.php?start_date=2014-01-01";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){var visevents=new vis.DataSet,start_date=(new Date,""),start_date="";return tempdates=[],$rootScope.added_track_groups.indexOf("loans")==-1&&($rootScope.added_track_groups.push("loans"),$rootScope.track_groups.push({track:"loans"})),console.log("eventss",eventss),$.each(eventss.data,function(index,event){start_date=new Date(event.start_date),end_date=new Date(event.end_date),end_date.setDate(end_date.getDate()+1),""!=event.title&&""!=start_date&&visevents.add({content:event.title,name:event.title,group:event.direction,event_type:"loans",track:"loans",order:"loans",className:"green",start:start_date,end:end_date,subgroup:"na",notes:event.event_type})}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-loans-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],176:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_functions=function($templateCache,$compile,$http,Timeline,Bookings,$rootScope,$timeout){return{timeline_track:Timeline,loadgroups:function(items){var _groups=[];return _.each(items._data,function(value){"0000-00-00"!=value.start_date&&"0000-00-00"!=value.end_date&&""!=value.start_date&&""!=value.end_date&&""!=value.project_name&&$.inArray(value.group,$rootScope.addednames)==-1&&($rootScope.addednames.push(value.group),content=value.group||"NA",_groups.push({id:value.group,track:value.track,order:value.order,event_type:value.event_type,content:value.group_name,event_typeSORT:content,selected:value.select_group}),console.log(_groups))}),console.log(_groups),_groups},update_andCompile:function(item){var self=this;$compile($("timeline-databar"))($rootScope),console.log("update_andCompile"),setTimeout(function(){unique_groups=[],added_ids=[],_.each($rootScope.groups,function(group){added_ids.indexOf(group.id)==-1&&(added_ids.push(group.id),unique_groups.push(group))});var groups=new vis.DataSet(unique_groups);groups.get({filter:function(item){return 1==item.selected}});self.enable_event_drop(timeline_track,timeline_track),$rootScope.timeline.redraw()},500)},populate_timeline_track:function(rootScope,dataset,dataset_functions,timeline_track){var self=this;$rootScope.groups=$rootScope.groups||[];var groups=rootScope.groups;rootScope.timeline.setGroups(groups),dataset.query({},function(datax){self.add_events_loop(rootScope,datax,dataset_functions,timeline_track),console.log("called by populate_timeline_track"),self.update_andCompile()})},populate_timeline_track_method_b:function(rootScope,data_functions,timeline_track){var self=this;$rootScope.groups=$rootScope.groups||[];var groups=rootScope.groups;rootScope.timeline.setGroups(groups),data_functions.get_events().then(function(datax){self.add_events_loop(rootScope,datax,data_functions,timeline_track)})},add_events_loop:function(rootScope,datax,dataset_functions,timeline_track){var self=this;dataset_functions.add_events(datax,function(public_dates){rootScope.leave_groups=self.loadgroups(public_dates),_.each(rootScope.leave_groups,function(_group){rootScope.groups.push(_group)}),_.each(public_dates._data,function(date){$rootScope.timeline.itemsData&&rootScope.timeline.itemsData.getDataSet().add(date)}),rootScope.timeline.fit({},function(){console.log("called by add_events_loop"),self.update_andCompile()})})},export_JSON_to_CSV:function(JSONData,ReportTitle,ShowLabel){var arrData="object"!=typeof JSONData?JSON.parse(JSONData):JSONData,CSV="";if(CSV+=ReportTitle+"\r\n\n",ShowLabel){var row="";for(var index in arrData[0])row+=index+",";row=row.slice(0,-1),CSV+=row+"\r\n"}for(var i=0;i<arrData.length;i++){var row="";for(var index in arrData[i])row+='"'+arrData[i][index]+'",';row.slice(0,row.length-1),CSV+=row+"\r\n"}if(""==CSV)return void alert("Invalid data");var fileName="MyReport_";fileName+=ReportTitle.replace(/ /g,"_");var uri="data:text/csv;charset=utf-8,"+escape(CSV),link=document.createElement("a");link.href=uri,link.style="visibility:hidden",link.download=fileName+".csv",document.body.appendChild(link),link.click(),document.body.removeChild(link)},prettyConfirm:function(title,text,callback){swal({title:title,text:text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55"},callback)},prettyPrompt:function(title,text,inputValue,callback){swal({title:title,text:text,type:"input",showCancelButton:!0,inputValue:inputValue},callback)},logEvent:function(event,properties){document.getElementById("log"),document.createElement("div")},enable_event_drop:function(event){var self=this;$(".vis-group").droppable({accept:".date_add",drop:function(event,ui){function add_item(dropped_group,group,time,value,colour,days,type){console.log("add_item"),date_dropped=moment(time).startOf("day")._d;var id=ui.draggable[0].id;target_date=time,_days=self.days(moment(time).startOf("day")._d,moment(time).add(days,"days")._d);var event_to_add={id:id,name:value,showimage:"",image:"",start_date:moment(time).startOf("day").format("MMM Do"),end_date:moment(time).add(days,"days").format("MMM Do"),notes:"",days:_days},new_date={content:self.event_html(event_to_add),name:value,group:group,dropped_group:dropped_group,date_logged:new Date,className:colour||"",_type:type,start_date:new Date(moment(date_dropped).startOf("day")._d),end_date:new Date(moment(date_dropped).add(days,"days")._d),days:_days};console.log("save");new Timeline(new_date).$save(function(_item){new_date.start=_item.start_date,new_date.end=_item.end_date,new_date._id=_item._id,new_date._type=_item._type,timeline.itemsData.getDataSet().add(new_date),setTimeout(function(){$(ui.draggable[0]).show(),self.add_group_to_timeline(new_date)},500)})}event.preventDefault(),$(".already-dropped").length||($("body").addClass("already-dropped"),setTimeout(function(){$(".already-dropped").removeClass("already-dropped")},50),time=timeline.getEventProperties(event).time,group=timeline.getEventProperties(event).group,$(ui.draggable[0]).hide(),"PROVISIONAL DATE"==ui.draggable[0].innerHTML?self.prettyPrompt("Add a provisional date","Name:","",function(value){value&&add_item(group,group,time,value,"blue",30,ui.draggable[0].innerHTML)}):"INSTALL"==ui.draggable[0].innerHTML||"DERIG"==ui.draggable[0].innerHTML?add_item(group,group,time,ui.draggable[0].innerHTML,"red",7,ui.draggable[0].innerHTML):add_item(group,$rootScope.filter_pieSelected,time,"placeholder","orange",1,"PROVISIONAL DATE"))}})},unlock:function(unlock){timeline.setOptions({editable:unlock,selectable:unlock}),timeline.options.editable=!0},add_group_to_timeline:function(new_group){var groups=new vis.DataSet($rootScope.groups),list=(new vis.DataSet($rootScope.leave_groups),groups.get());_.some(list,function(lookup_group){if(new_group.dropped_group==lookup_group.id){console.log("copy this ",lookup_group);var _new_group=lookup_group;return _new_group.track=new_group.track,_new_group.content=new_group.content,!0}}),console.log("called by add_group_to_timeline"),this.update_andCompile()},changeTracks:function(selection){console.log("changeTracks selection",selection);var groups=new vis.DataSet($rootScope.groups),list=(new vis.DataSet($rootScope.leave_groups),groups.get({filter:function(item){return selection.indexOf(item.track)!=-1}}));timeline.setGroups(list),console.log("called by changeTracks"),this.update_andCompile(),this.enable_event_drop()},changeGroups:function(selection){var groups=new vis.DataSet($rootScope.groups),list=groups.get({filter:function(item){return selection.indexOf(item.content)!=-1}});timeline.setGroups(list),this.enable_event_drop()},days:function(start,end){var a=moment(start),b=moment(end);return b.diff(a,"days")},event_html:function(event_to_add){var id=event_to_add.id,name=event_to_add.name,showimage=event_to_add.showimage,image=event_to_add.image,start_date=event_to_add.start_date,end_date=event_to_add.end_date,notes=event_to_add.notes||"",days=event_to_add.days,description=event_to_add.description||"",av=!1,build=!1,painting=!1,objects=!1,graphics=!1;_.each(event_to_add.install_features,function(feature){1==feature.selected&&("av"==feature.name&&(av=!0),"build"==feature.name&&(build=!0),"painting"==feature.name&&(painting=!0),"graphics"==feature.name&&(graphics=!0),"objects"==feature.name&&(objects=!0))});var notes=notes||"",image=image||"",showimage=showimage||"",htmlContent="<timeline-databar     graphics='"+graphics+"' objects='"+objects+"'  painting='"+painting+"' build='"+build+"'  av='"+av+"'  description='"+description+"' description='"+description+"' id='"+id+"' name='"+name+"' image='"+image+"' showimage='"+showimage+"' startdate='"+start_date+"' enddate='"+end_date+"' notes='"+notes+"' days='"+days+"'></timeline-databar>";return htmlContent},selected_data:function(event){selected_timeline_id=event.items[0],selected_timeline_id&&(selected_item=timeline.itemsData.getDataSet().get(selected_timeline_id),$rootScope.selected_timeline_id=selected_timeline_id,$rootScope.selected_item=selected_item.name,$rootScope.selected_type=selected_item._type,_.each($rootScope.installmodels,function(feature,i){$rootScope.installmodels[i].selected=!1}),selected_item.install_features&&_.each(selected_item.install_features,function(feature){1==feature.selected&&(console.log(feature.name+" is selected in the model"),_.each($rootScope.installmodels,function(_feature,i){console.log("checking "+_feature),_feature.name==feature.name&&(console.log($rootScope.installmodels[i].name+" is selected on the info box"+_feature.name),console.log("switching on "+$rootScope.installmodels[i]),$rootScope.installmodels[i].selected=!0)}))}),selected_item.days>0&&($rootScope.selected_days=" - "+selected_item.days+" days"),$rootScope.selected_id=selected_item._id,$rootScope.selected_notes=selected_item.notes,$rootScope.selected_approved=selected_item.approved,$rootScope.datePicker.date={startDate:new Date(selected_item.start),endDate:new Date(selected_item.end)})},get_events:function(){return $http.get("/assets/data/all_events.JSON")},updateOptions:function(options){$rootScope.timeline.setOptions(options)},event_edited:function(scope){console.log("event_edited");var self=this;if(scope.locked.add_item){if(date=$rootScope.datePicker.date,days=self.days(moment(date.startDate),moment(date.endDate)),scope.selected_start=moment(date.startDate).format("MMM Do"),scope.selected_end=moment(date.endDate).format("MMM Do"),moment(date.startDate).isValid()){var event_to_add={id:scope.selected_id,name:scope.selected_item,showimage:"",image:"",start_date:moment(date.startDate).format("MMM Do"),end_date:moment(date.endDate).format("MMM Do")||"",notes:$rootScope.selected_notes,approved:$rootScope.selected_approved,days:days,install_features:scope.installmodels};html=self.event_html(event_to_add);var options={id:scope.selected_timeline_id,content:html,approved:$rootScope.selected_approved,notes:$rootScope.selected_note,start:moment(date.startDate)._d,end:moment(date.endDate)._d,install_features:scope.installmodels};self.timeline_track.update({id:scope.selected_id},options,function(){console.log("called by event_edited"),self.updateItem(options)})}}else console.log("timeline locked")},updateItem:function(options){"undefined"!=typeof timeline&&timeline.itemsData&&(timeline.itemsData.getDataSet().update(options),console.log("called by updateItem"),this.update_andCompile())},setup:function(Timeline,groups,dates,isloggedin){var self=this,options={min:new Date(2014,0,1),max:new Date(2022,0,1),zoomMin:864e5,zoomMax:13392e8,width:"100%",maxHeight:"900px",moveable:!0,itemsAlwaysDraggable:!0,snap:function(date,scale,step){return date},stack:!1,orientation:{axis:"top"},selectable:!0,editable:!1,groupOrder:"order",onMove:function(item,callback){if(console.log("onmove called"),$rootScope.datePicker.date={startDate:new Date(item.start),endDate:new Date(item.end)},days=self.days(moment(item.start),moment(item.end)),$rootScope.selected_days=days,moment(item.start).isValid()){var event_to_add={id:item._id,name:item.name,showimage:"",image:"",group:item.group,start_date:moment(item.start).startOf("day").format("MMM Do"),end_date:moment(item.end).startOf("day").format("MMM Do"),notes:item.notes,days:days,install_features:$rootScope.installmodels};html=self.event_html(event_to_add);var options={id:item.id,group:item.group,content:html,notes:event_to_add.notes,start:moment(item.start)._d,end:moment(item.end)._d,start_date:moment(item.start)._d,end_date:moment(item.end)._d,install_features:$rootScope.installmodels};self.timeline_track.update({id:item._id},options,function(){console.log("called by setup"),self.updateItem(options)}),callback(item)}else console.log("invalid date"),callback(item)},onUpdate:function(item,callback){console.log("on update called"),self.prettyPrompt("Update item","Edit items text:",item.content,function(value){if(value)if(item.content=value,days=self.days(item.start,item.end),moment(item.start).isValid()){var event_to_add={id:item.id,name:value,showimage:"",image:"",start_date:item.start,end_date:item.end,notes:item.notes,days:days},_timeline=new self.timeline_track({content:self.event_html(event_to_add),name:item.name,group:item.group,start_date:item.start,end_date:item.end,days:self.days(item.start,item.end)});self.timeline_track.update({id:item._id},_timeline);var _options={id:item._id,content:self.event_html(event_to_add),start:moment(event_to_add.startDate)._d,end:moment(event_to_add.endDate)._d,start_date:moment(event_to_add.startDate)._d,end_date:moment(event_to_add.endDate)._d};console.log("called by event_edited"),self.updateItem(_options,function(){console.log("called by onUpdate"),self.update_andCompile()}),callback(item)}else console.log("invalid date");else callback(null)})},onAdd:function(item,callback){console.log("on add called"),self.prettyPrompt("Add note","Add some notes to this date:",item.content,function(value){if(value){item.content=value,callback(item),days=self.days(item.start,moment(item.start).add(5,"days"));var event_to_add={id:item.id,name:value,showimage:"",image:"",start_date:item.start,end_date:moment(item.start).add(5,"days"),notes:"",days:days};new self.timeline_track({content:self.event_html(event_to_add),name:value,date_logged:new Date,group:item.group,_type:"note",start_date:item.start,end_date:moment(item.start).add(1,"days"),className:"green"}).$save(function(_item){new_date.start=_item.start_date,new_date.end=_item.end_date,new_date._id=_item._id,new_date._type=ui.draggable[0].innerHTML,timeline.itemsData.getDataSet().add(new_date),setTimeout(function(){$(ui.draggable[0]).show(),console.log("bread")},500)})}else callback(null)})},onRemove:function(item,callback){return item._id?(self.timeline_track.remove({id:item._id}),void callback(item)):(sweetAlert("you can't remove this item from here, sorry :)"),!1)}},self=this;$("body").keydown(function(e){if(37==e.keyCode)move(.2);else if(39==e.keyCode)move(-.2);else if(38==e.keyCode)zoom(-.2);else if(40==e.keyCode)return zoom(.2),!1}),$rootScope.timeline.setOptions(options),console.log("adding select event handler"),$rootScope.timeline.off("select").on("select",function(properties){console.log("timeline selected"),self.selected_data(properties)}),$rootScope.timeline.setItems(dates),move=function(percentage){var range=this.timeline.getWindow(),interval=range.end-range.start;this.timeline.setWindow({start:range.start.valueOf()-interval*percentage,end:range.end.valueOf()-interval*percentage})},zoom=function(percentage){var range=this.timeline.getWindow(),interval=range.end-range.start;this.timeline.setWindow({start:range.start.valueOf()-interval*percentage,end:range.end.valueOf()+interval*percentage})},zoomIn=function(){this.zoom(-.2)},zoomOut=function(){this.zoom(.2)},moveLeft=function(){this.move(.2)},moveRight=function(){this.move(-.2)},dates.on("*",function(event,properties){}),self.enable_event_drop(),$compile($("timeline-databar"))($rootScope)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],177:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_shopify_functions=function($http,Timeline,$rootScope){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/team/digital/projects/scripts/php/emu/loans.php?start_date=2014-01-01";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){var visevents=new vis.DataSet;return tempdates=[],$rootScope.added_track_groups.indexOf("Shopify product types")==-1&&($rootScope.added_track_groups.push("Shopify product types"),$rootScope.track_groups.push({track:"Shopify product types"})),$.each(eventss,function(index,event){scale_class="";var val_1=0,val_2=2,val_3=4,val_4=6,val_5=8,val_6=10,val_7=20,val_8=30,val_9=40,val_10=50,count="count";event[count]>val_1&&event[count]<=val_2&&(scale_class="scale_01"),event[count]>val_2&&event[count]<=val_3&&(scale_class="scale_02"),event[count]>val_3&&event[count]<=val_4&&(scale_class="scale_03"),event[count]>val_4&&event[count]<=val_5&&(scale_class="scale_05"),event[count]>val_5&&event[count]<=val_6&&(scale_class="scale_06"),event[count]>val_6&&event[count]<=val_7&&(scale_class="scale_07"),event[count]>val_7&&event[count]<=val_8&&(scale_class="scale_08"),event[count]>val_8&&event[count]<=val_9&&(scale_class="scale_09"),event[count]>val_9&&event[count]<=val_10&&(scale_class="scale_09"),event[count]>val_10&&(scale_class="scale_10");var start_date=new Date(event._id.month+"/"+event._id.day+"/"+event._id.year),end_date=new Date(start_date);end_date.setDate(end_date.getDate()+1);var shopEvent={content:"",title:event.count,name:event.count,group:event._id.type,track:"Shopify product types",order:"Shopify product types",className:scale_class,start:start_date,end:end_date};visevents.add(shopEvent)}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){
timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-shopify-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],178:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.timeline_visitor_figures_functions=function($http,Timeline,$rootScope){return{get_events:function(){var SheetToJSONServiceURL="http://emudev-app1/team/digital/projects/scripts/php/emu/loans.php?start_date=2014-01-01";return console.log(SheetToJSONServiceURL),$http.get(SheetToJSONServiceURL)},add_events:function(eventss,fn){var visevents=new vis.DataSet;return tempdates=[],$rootScope.added_track_groups.indexOf("visitor figures")==-1&&($rootScope.added_track_groups.push("visitor figures"),$rootScope.track_groups.push({track:"visitor figures"})),$.each(eventss,function(index,event){scale_class="";var val_1=0,val_2=100,val_3=200,val_4=300,val_5=400,val_6=500,val_7=1e3,val_8=2e3,val_9=3e3,val_10=4e3,count="value";event[count]>val_1&&event[count]<=val_2&&(scale_class="scale_01"),event[count]>val_2&&event[count]<=val_3&&(scale_class="scale_02"),event[count]>val_3&&event[count]<=val_4&&(scale_class="scale_03"),event[count]>val_4&&event[count]<=val_5&&(scale_class="scale_05"),event[count]>val_5&&event[count]<=val_6&&(scale_class="scale_06"),event[count]>val_6&&event[count]<=val_7&&(scale_class="scale_07"),event[count]>val_7&&event[count]<=val_8&&(scale_class="scale_08"),event[count]>val_8&&event[count]<=val_9&&(scale_class="scale_09"),event[count]>val_9&&event[count]<=val_10&&(scale_class="scale_09"),event[count]>val_10&&(scale_class="scale_10");var start_date=new Date(event.date_value),end_date=new Date(start_date);end_date.setDate(end_date.getDate()+1);var shopEvent={content:"",title:"visitor count "+event.value,name:event.museum_id+" visitors",group:event.museum_id,track:"visitor figures",order:"museum",className:scale_class,start:start_date,end:end_date};visevents.add(shopEvent)}),fn(visevents)},event_html:function(name,showimage,image,start_date,end_date,notes){var notes=notes||"",htmlContent='<div class="titlediv" >';return htmlContent+='<div class="title_heading">',htmlContent+=name,htmlContent+="</div>",htmlContent+="<span> ",htmlContent+=start_date+"-"+end_date,htmlContent+="<span>",htmlContent+="<p>"+notes,showimage&&(htmlContent+='<div class="image_box">',htmlContent+='<img src="http://museums.bristol.gov.uk/multimedia/entry.php?request=resource&irn='+image+'&height=50&format=jpeg" />',htmlContent+="</div>"),htmlContent+="</div>"},updateOptions:function(options){timeline.setOptions(options)},updateItem:function(options){options.id=$rootScope.selected_t_id,timeline.itemsData.getDataSet().update(options)}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/timeline/timeline-visitor-figures-services.js","/../components/timeline")},{b55mWE:4,buffer:3}],179:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.turnstiles_controller=function(log_messages,$scope,AuthService,$http,$q,$routeParams,$location,$rootScope,turnstile_app){$scope.operation_in_progress=!1,$scope.settings=[],$scope.test_ticket="",$scope.venue=$routeParams.venue,$scope.settings.venue=$routeParams.venue,$scope.command="G2:01",$scope.open_turnstile=function(){$scope.settings.ticket=$scope.test_ticket,$scope.settings.venue=$scope.venue,$scope.settings.command=$scope.command,$scope.operation_in_progress=!0,turnstile_app.openGates($scope.settings,function(team){$scope.operation_in_progress=!1})}},exports.turnstiles_buttons=function(log_messages,$scope,$http,$q,$routeParams,$location,$rootScope,shopify_app){$scope.report_running=!0,$scope.title1="Button",$scope.title4="Warn",$scope.isDisabled=!0,$scope.googleUrl="http://google.com",$scope.messages=[],log_messages.query({},function(messages){})},exports.turnstiles_test=function(turnstile_app,check_com_port,check_ticket_database,check_ticket_file,shopify_app_test,log_messages,$scope,$http,$q,$routeParams,$location,$rootScope,shopify_app){$scope.test_results=[],$scope.settings=[],$scope.gridOptions=[],$scope.gridOptions.columnDefs=[],$scope.gridOptions={columnDefs:[{field:"test"},{field:"result",type:"text"},{field:"notes",type:"text"}],enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!0,enableCellEditOnFocus:!0,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},data:$scope.test_results,exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){})}};var options=[];options[0]=[],options[0].shop="MSHED",options[1]=[],options[1].shop="BMAG";var i=0;_.each(options,function(option){i++,test_result={test:i+"/6: connect to "+option.shop+" shopify",result:"FAIL"},shopify_app_test.query(option,function(result){test_result={test:i+"/6: connect to "+option.shop+" shopify",result:"OK",notes:result.count+" orders found"},i++,result.count>0&&$scope.test_results.push(test_result)},function(error){test_result={test:i+"/6: connect to "+option.shop+" shopify",result:"FAIL",notes:error},$scope.test_results.push(test_result)})}),test_result={test:"3/6: connect to ticket file",result:"FAIL"},check_ticket_file.query({},function(result){test_result={test:"3/6:connect to ticket file",result:"OK",notes:result.count+" tickets found"},$scope.test_results.push(test_result)},function(error){test_result={test:"2/6:connect to ticket file",result:"FAIL",notes:error},$scope.test_results.push(test_result)}),test_result={test:"3/6:connect to ticket database",result:"FAIL"},check_ticket_database.query({},function(result){test_result={test:"4/6: connect to ticket database",result:"OK",notes:result},$scope.test_results.push(test_result)},function(error){test_result={test:"4/6: connect to ticket database",result:"FAIL",notes:error},$scope.test_results.push(test_result)}),check_com_port.query({},function(value){test_result={test:"5/6: can open COM port",result:"OK"},$scope.test_results.push(test_result)},function(error){test_result={test:"5/6: can open COM port",result:"FAIL",notes:error},$scope.test_results.push(test_result)}),$scope.settings.command="test",$scope.settings.ticket="",turnstile_app.openGates($scope.settings,function(value){test_result={test:"6/6: can send OPEN command",result:"OK",notes:value},$scope.settings.command="G2:01",$scope.test_results.push(test_result)},function(error){test_result={test:"6/6: can send OPEN command",result:"FAIL",notes:error},$scope.test_results.push(test_result)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/turnstiles/turnstiles-controller.js","/../components/turnstiles")},{b55mWE:4,buffer:3}],180:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.turnstilesController=function(){return{controller:"turnstiles_controller",templateUrl:"./components/turnstiles/turnstiles-page.html"}},exports.turnstilesButtons=function(){return{controller:"turnstiles_buttons",templateUrl:"./components/turnstiles/turnstiles-buttons.html"}},exports.turnstilesTest=function(){return{controller:"turnstiles_test",templateUrl:"./components/turnstiles/turnstiles-test.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/turnstiles/turnstiles-directive.js","/../components/turnstiles")},{b55mWE:4,buffer:3}],181:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.users_controller=function($route,$scope,$http,$q,$routeParams,$location,$rootScope,Team){console.log("controller go"),console.log($route.routes),$scope.gridOptions=[],$scope.gridOptions.data=[];var columnDefs=[];columnDefs.push({field:"username",resizable:!0},{field:"email",resizable:!0},{field:"firstName",resizable:!0},{field:"lastName",resizable:!0},{field:"team",resizable:!0},{field:"group",resizable:!0},{field:"add_rooms",allowCellFocus:!0,type:"boolean",value:"add_rooms",resizable:!0,visible:!0,width:"100"},{field:"add_equipment",allowCellFocus:!0,type:"boolean",value:"add_equipment",resizable:!0,visible:!0,width:"100"},{field:"add_room_bookings",allowCellFocus:!0,type:"boolean",value:"add_room_bookings",resizable:!0,visible:!0,width:"100"},{field:"approve_room_bookings",allowCellFocus:!0,type:"boolean",value:"approve_room_bookings",resizable:!0,visible:!0,width:"100"},{field:"approve_equipment_bookings",allowCellFocus:!0,type:"boolean",value:"approve_equipment_bookings",resizable:!0,visible:!0,width:"100"},{field:"add_equipment_bookings",allowCellFocus:!0,type:"boolean",value:"add_equipment_bookings",resizable:!0,visible:!0,width:"100"}),$scope.gridOptions={columnDefs:columnDefs,enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!0,enableCellEditOnFocus:!0,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){vm.gridApi=gridApi},pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(currentPage,pageCount){return{text:currentPage.toString()+" of "+pageCount.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(docDefinition){return docDefinition.styles.headerStyle={fontSize:22,bold:!0},docDefinition.styles.footerStyle={fontSize:10,bold:!0},docDefinition},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit($scope,function(rowEntity,colDef,newValue,oldValue){var myArray=[],key=colDef.field,obj={};obj[key]=newValue,myArray.push(obj);var query={id:rowEntity._id};Team.update(query,obj,function(err,affected,resp){})})}},console.log("getData"),Team.query({},function(team){$scope.rows=[],$scope._rows=[],_.each(team,function(row){console.log(row),$scope._rows.push(row)}),$scope.gridOptions.data=$scope._rows})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/user-admin/users-controller.js","/../components/user-admin")},{b55mWE:4,buffer:3}],182:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.userAdmin=function(){return{controller:"users_controller",templateUrl:"./components/user-admin/users-page.html"}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../components/user-admin/users-directive.js","/../components/user-admin")},{b55mWE:4,buffer:3}],183:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function(app){return app.config(["$stateProvider","$routeProvider",function($stateProvider,$routeProvider){$routeProvider.when("/",{template:"<kpihome-dashboard></kpihome-dashboard>"}).when("/home",{template:"<kpihome-dashboard></kpihome-dashboard>",controller:"kpi_home_controller"}).when("/timeline",{template:'<time-line  timeline_mode="Timeline" ng-init="init(\'timeline\')"  ></time-line>'}).when("/master",{template:"<master-kpi></master-kpi>"}).when("/downtime/:kiosk",{templateUrl:"../components/machine-monitor/downtime.html",controller:"downtimeCtrl"}).when("/downtime",{templateUrl:"../components/machine-monitor/downtime.html",controller:"downtimeCtrl"}).when("/activity",{templateUrl:"../components/machine-monitor/downtime.html",controller:"downtimeCtrl"}).when("/feedback",{templateUrl:"../components/machine-monitor/feedback.html",controller:"feedbackCtrl"}).when("/satisfaction",{templateUrl:"../components/machine-monitor/satisfaction.html",controller:"satisfaction"}).when("/open_badges",{templateUrl:"../views/open_badges.html",controller:"open_badgesCtrl"}).when("/dead",{templateUrl:"../components/machine-monitor/dead.html",controller:"deadCtrl"}).when("/todo",{templateUrl:"../components/machine-monitor/page-feedback.html",controller:"form_to_trellox"}).when("/timeline_settings",{template:"<timelinesettings-formdata></timelinesettings-formdata>"}).when("/room-hire",{template:'<timeline-bookings timeline_mode="Bookings" ng-init="init(\'room-hire\')"  ></timeline-bookings>'}).when("/equipment-timeline",{template:'<timeline-bookings timeline_mode="Bookings" ng-init="init(\'equipment-booking\')"  ></timeline-bookings>'}).when("/shopify_app",{template:"<shopify-status></shopify-status>"}).when("/shopify_monthly",{template:"<shopify-monthly></shopify-monthly>"}).when("/doom",{template:"<i-frame></i-frame>"}).when("/turnstiles",{template:"<turnstiles-controller></turnstiles-controller>"}).when("/timeline/:track",{template:"<time-line></time-line>"}).when("/leave/:team",{templateUrl:"../components/team/leave-page.html",controller:"leave_controller"}).when("/team/:team",{templateUrl:"../components/team/team-page.html",controller:"team_controller"}).when("/tech-support",{template:"<tech-support></tech-support>"}).when("/-:view",{templateUrl:"../components/team/trello.html",controller:"trello"}).when("/raw-nominate",{template:"<nominate-data></nominate-data>"}).when("/raw-feedback",{template:"<feedback-data></feedback-data>"}).when("/people",{templateUrl:"../views/people.html",controller:"peoplecounter"}).when("/users",{template:"<user-admin></user-admin>"}).when("/record-visitor-numbers",{template:"<visits-formdata></visits-formdata>"}).when("/record-venue-hire",{template:"<venuehire-formdata></venuehire-formdata>"}).when("/record-visitor-numbers/:kpi",{template:"<performance-panel></performance-panel>"}).when("/record-kpi-events",{template:"<kpievents-formdata></kpievents-formdata>"}).when("/raw-kpi-events",{template:"<raw-kpieventsfilter></raw-kpieventsfilter>"}).when("/record-operations",{template:"<operations-formdata></operations-formdata>"}).when("/monthly-operations",{template:"<operations-dashboard></operations-dashboard>"}).when("/raw-operations",{template:"<raw-operations></raw-operations>"}).when("/record-retail-sales",{template:"<retail-formdata></retail-formdata>"}).when("/upload-retail-sales",{template:"<retail-uploader></retail-uploader>"}).when("/monthly-retail-sales",{template:"<retail-dashboard></retail-dashboard>"}).when("/raw-retail-sales",{template:"<raw-retailsalesfilter></raw-retailsalesfilter>"}).when("/record-exhibitions-pwyt",{template:"<exhibitionspwyt-formdata></exhibitionspwyt-formdata>"}).when("/monthly-exhibitions-pwyt",{template:"<exhibitionspwyt-dashboard></exhibitionspwyt-dashboard>"}).when("/raw-exhibitions-income",{template:"<data-exhibitionspwyt></data-exhibitionspwyt>"}).when("/raw-exhibitions-pwyt",{template:"<datax-exhibitionspwyt></datax-exhibitionspwyt>"}).when("/transformation-kpis",{template:'<standardkpieventstransformation-dashboard  team="TRANSFORMATION"  ></standardkpieventstransformation-dashboard>'}).when("/collections-kpis",{template:'<standardkpieventscollections-dashboard  team="TRANSFORMATION"  ></standardkpieventscollections-dashboard>'}).when("/engagement-kpis",{template:'<standardkpieventsengagement-dashboard  team="TRANSFORMATION"  ></standardkpieventsengagement-dashboard>'}).when("/raw-visits",{template:"<datax-visits></datax-visits>"}).when("/monthly-visits",{template:"<visits-dashboard></visits-dashboard>"}).when("/raw-venue-hire",{template:"<datax-venuehire></datax-venuehire>"}).when("/monthly-venue-hire",{template:"<venuehire-dashboard></venuehire-dashboard>"}).when("/record-learning",{template:"<learning-Formdata></learning-Formdata>"}).when("/raw-learning",{template:"<raw-learning></raw-learning>"}).when("/monthly-learning",{template:"<learning-dashboard></learning-dashboard>"}).when("/age-learning",{template:"<learning-dashboard></learning-dashboard>"}).when("/record-giftaid",{template:"<giftaid-Formdata></giftaid-Formdata>"}).when("/record-directdebit",{template:"<directdebit-Formdata></directdebit-Formdata>"}).when("/raw-directdebit",{template:"<raw-directdebit></raw-directdebit>"}).when("/monthly-directdebit",{template:"<directdebit-dashboard></directdebit-dashboard>"}).when("/record-treasure",{template:"<treasure-Formdata></treasure-Formdata>"}).when("/raw-treasure",{template:"<raw-treasure></raw-treasure>"}).when("/monthly-treasure",{template:"<treasure-dashboard></treasure-dashboard>"}).when("/record-donors",{template:"<donors-Formdata></donors-Formdata>"}).when("/raw-donors",{template:"<raw-donors></raw-donors>"}).when("/monthly-donors",{template:"<donors-dashboard></donors-dashboard>"}).when("/record-online",{template:"<online-Formdata></online-Formdata>"}).when("/raw-online",{template:"<raw-online></raw-online>"}).when("/monthly-online",{template:"<online-dashboard></online-dashboard>"}).when("/record-general",{template:"<donationsgeneral-Formdata></donationsgeneral-Formdata>"}).when("/raw-general",{template:"<raw-donationsgeneral></raw-donationsgeneral>"}).when("/monthly-general",{template:"<donationsgeneral-dashboard></donationsgeneral-dashboard>"}).when("/record-trusts",{template:"<trusts-Formdata></trusts-Formdata>"}).when("/raw-trusts",{template:"<raw-trusts></raw-trusts>"}).when("/monthly-trusts",{template:"<trusts-dashboard></trusts-dashboard>"}).when("/gift-aid-customers",{templateUrl:"./components/gift-aid/data.html"}).when("/record-votes",{template:"<votes-Formdata></votes-Formdata>"}).when("/raw-votes",{template:"<raw-votes></raw-votes>"}).when("/raw-giftaid",{templateUrl:"./components/performance/gift-aid/data.html"}).when("/monthly-giftaid",{template:"<giftaid-dashboard></giftaid-dashboard>"}).when("/record-donations",{template:"<donations-Formdata></donations-Formdata>"}).when("/record-donations-other",{template:"<donationsother-Formdata></donationsother-Formdata>"}).when("/record-donations-kiosk",{template:"<donationskiosk-Formdata></donationskiosk-Formdata>"}).when("/raw-donations-kiosk",{templateUrl:"./components/performance/donations-kiosk/data.html"}).when("/day-donations-kiosk",{templateUrl:"./components/performance/donations-kiosk/day-data.html"}).when("/monthly-donations",{template:"<donations-dashboard></donations-dashboard>"}).when("/monthly-donation-boxes",{template:"<donationboxes-dashboard></donationboxes-dashboard>"}).when("/record-patron",{template:"<patron-Formdata></patron-Formdata>"}).when("/raw-patron",{templateUrl:"./components/performance/patron/data.html"}).when("/monthly-patron",{template:"<patron-dashboard></patron-dashboard>"}).when("/record-site-permissions",{template:"<sitepermissions-Formdata></sitepermissions-Formdata>"}).when("/raw-site-permissions",{templateUrl:"./components/performance/site_permissions/data.html"}).when("/monthly-site-permissions",{template:"<sitepermissions-dashboard></sitepermissions-dashboard>"}).when("/record-corporate",{template:"<corporate-Formdata></corporate-Formdata>"}).when("/raw-corporate",{templateUrl:"./components/performance/corporate/data.html"}).when("/monthly-corporate",{template:"<corporate-dashboard></corporate-dashboard>"}).when("/raw-donations",{templateUrl:"./components/performance/donations/data.html"}).when("/monthly-donations",{template:"<donations-dashboard></donations-dashboard>"}).when("/monthly-donations-box",{template:"<donationsboxes-dashboard></donationsboxes-dashboard>"}).when("/raw-donations-other",{templateUrl:"./components/performance/donations-other/data.html"}).when("/monthly-donations-other",{template:"<donations_otherdashboard></donations_otherdashboard>"}).when("/raw-donations-kiosk",{templateUrl:"./components/performance/donations-kiosk/data.html"}).when("/monthly-donations-kiosk",{template:"<donations_kioskdashboard></donations_kioskdashboard>"}).when("/upload-kiosk-donations",{template:"<kiosk-uploader></kiosk-uploader>"}).when("/record-events",{template:"<events-Formdata></events-Formdata>"}).when("/raw-events",{template:"<raw-eventsfilter></raw-eventseventsfilter>"}).when("/monthly-events",{template:"<events-dashboard></events-dashboard>"}).when("/participation-dashboard",{template:"<participation-Dashboard></participation-Dashboard>"}).when("/record-welcomedesk",{template:"<welcomedesk-Formdata></welcomedesk-Formdata>"}).when("/raw-welcomedesk",{templateUrl:"./components/performance/welcome-desk/data.html"}).when("/monthly-welcomedesk",{template:"<welcomedesk-dashboard></welcomedesk-dashboard>"}).when("/monthly-teg",{template:"<teg-dashboard></teg-dashboard>"}).when("/record-teg",{template:"<teg-Formdata></teg-Formdata>"}).when("/raw-teg",{template:"<raw-teg></raw-teg>"}).when("/exhibitions-summary",{template:"<exhibitions-dashboard></exhibitions-dashboard>"}).when("/analyser",{template:"<analyser-dashboard></analyser-dashboard>"}).when("/raw-turnstiles",{template:"<raw-turnstiles></raw-turnstiles>"}).when("/monthly-turnstiles",{template:"<monthly-turnstiles></monthly-turnstiles>"}).when("/add-poster",{template:"<posters-Form></posters-Form>"}).when("/posters",{template:"<raw-Posters></raw-Posters>"}).when("/recurring",{template:"<recurring-Event></recurring-Event>"}).when("/rooms",{template:"<rooms-Formdata></rooms-Formdata>"}).when("/bookings-report",{template:"<bookings-dashboard></bookings-dashboard>"}).when("/edit-booking/:mode/:booking_id",{template:"<edit-booking></edit-booking_id>"}).when("/equipment",{template:"<equipment-Formdata></equipment-Formdata>"}).when("/bookings/:mode",{template:"<bookings-Form></bookings-Form>"}).when("/bookingslist/:mode",{template:"<bookings-data></bookings-data>"}).when("/turnstiles/:venue",{template:"<turnstiles-controller></turnstiles-controller>"}).when("/tech-support:token",{templateUrl:"../components/tech-support/tech-support-page.html",controller:"tech_support_controller"}).when("/me/:member",{templateUrl:"../components/member/member-page.html",controller:"member_controller",data:{}})}]),app.config(function(formlyConfigProvider){formlyConfigProvider.setType([{name:"radio",overwriteOk:!0,templateUrl:"views/formly-radio.html"},{name:"button",templateUrl:'<button ng-click="options.templateOptions">{{options.label}}</button>'}]),app.config(function($mdIconProvider){$mdIconProvider.iconSet("call","img/icons/sets/communication-icons.svg",24).iconSet("social","img/icons/sets/social-icons.svg",24)}),formlyConfigProvider.setType({name:"input",overwriteOk:!0,template:'<input class="form-control_CHEESE" ng-model="model[options.key]">',wrapper:["helper","bootstrapLabel","bootstrapHasError"]}),formlyConfigProvider.setType({name:"file",templateUrl:"views/formly-file.html"})}),app.config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("")}]),app.config(["$qProvider",function($qProvider){$qProvider.errorOnUnhandledRejections(!1)}]),module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app-config.js","/")},{b55mWE:4,buffer:3}],184:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function(app){var controllers=require("../shared/controllers/controllers"),dead_controllers=require("../components/machine-monitor/dead-controller"),nav_controller=require("../shared/controllers/navbar-controller"),colourkey_controller=require("../shared/controllers/colourkey-controller"),tablefilter_controller=require("../shared/controllers/tablefilter-controller"),tech_support_controller=require("../components/tech-support/tech-support-controller"),customers_controller=require("../components/gift-aid/raw-giftaid-controller"),customersdirective=require("../components/gift-aid/customers-directive"),record_poster_controller=require("../components/signage/posters/form-controller"),raw_poster_controller=require("../components/signage/posters/raw-poster-controller"),signage_settings_directives=require("../components/signage/directive"),votes_form=require("../components/exhibitions/music/votes-form-controller"),raw_votes_controller=require("../components/exhibitions/music/raw-votes-controller"),monthly_votes_controller=require("../components/exhibitions/music/monthly-votes-controller"),votes_directive=require("../components/exhibitions/directive"),rooms_controller=require("../components/resource-bookings/rooms/raw-rooms-controller"),record_rooms_controller=require("../components/resource-bookings/rooms/form-controller"),equipment_controller=require("../components/resource-bookings/equipment/raw-equipment-controller"),record_equipment_controller=require("../components/resource-bookings/equipment/form-controller"),record_bookings_controller=require("../components/resource-bookings/bookings/form-controller"),recurring_events_controller=require("../components/resource-bookings/bookings/recurring-events-controller"),edit_bookings_controller=require("../components/resource-bookings/bookings/edit-form-controller"),bookings_controller=require("../components/resource-bookings/bookings/raw-bookings-controller"),monthly_bookings_controller=require("../components/resource-bookings/bookings/monthly-bookings-controller"),yearly_bookings_controller=require("../components/resource-bookings/bookings/yearly-bookings-controller"),timeline_resources_controller=require("../components/resource-bookings/timeline-resources-controller"),feedback_controllers=(require("../components/machine-monitor/dashboard-controller"),require("../components/machine-monitor/feedback-controller")),satisfaction_controllers=require("../components/machine-monitor/satisfaction-controller"),downtime_controllers=require("../components/machine-monitor/downtime-controller"),performance_dashboard_controllers=require("../components/performance/dashboard-controllers"),analyser_controller=require("../components/performance/analyser/analyser-controller"),raw_visitor_numbers_controller=require("../components/performance/visits/raw-visits-controller"),monthly_visitor_numbers_controller=require("../components/performance/visits/monthly-visits-controller"),yearly_visitor_numbers_controller=require("../components/performance/visits/yearly-visits-controller"),raw_venue_hire_controller=require("../components/performance/venue-hire/raw-visits-controller"),monthly_venue_hire_controller=require("../components/performance/venue-hire/monthly-visits-controller"),yearly_venue_hire_controller=require("../components/performance/venue-hire/yearly-visits-controller"),raw_turnstiles_controller=require("../components/performance/turnstiles/raw-turnstiles-controller"),kpi_home_controller=(require("../components/performance/turnstiles/monthly-turnstiles-controller"),require("../components/performance/home/kpi-home-controller")),master_kpi_home_controller=require("../components/performance/home/master-kpi-home-controller"),yearly_retail_sales_controller=require("../components/performance/retail/yearly-retail-sales-controller"),monthly_retail_sales_controller=require("../components/performance/retail/monthly-retail-sales-controller"),raw_retail_sales_controller=require("../components/performance/retail/raw-retail-sales-controller"),yearly_donations_controller=require("../components/performance/donations/yearly-donations-controller"),monthly_donations_controller=require("../components/performance/donations/monthly-donations-controller"),raw_donations_controller=require("../components/performance/donations/raw-donations-controller"),donations_performance_form=require("../components/performance/donations/performance-form-controller"),yearly_donations_other_controller=require("../components/performance/donations-other/yearly-donations_other-controller"),monthly_donations_other_controller=require("../components/performance/donations-other/monthly-donations_other-controller"),raw_donations_other_controller=require("../components/performance/donations-other/raw-donations_other-controller"),donations_other_performance_form=require("../components/performance/donations-other/performance-form-controller"),monthly_donations_kiosk_controller=require("../components/performance/donations-kiosk/monthly-donations_kiosk-controller"),monthly_donations_box_controller=require("../components/performance/donations-boxes/monthly-donations-controller"),raw_donations_donors_controller=require("../components/performance/donations-donors/raw-controller"),monthly_donors_controller=require("../components/performance/donations-donors/monthly-controller"),donations_donors_performance_form=require("../components/performance/donations-donors/performance-form-controller"),raw_donations_directdebit_controller=require("../components/performance/donations-directdebit/raw-controller"),monthly_directdebit_controller=require("../components/performance/donations-directdebit/monthly-controller"),donations_directdebit_performance_form=require("../components/performance/donations-directdebit/performance-form-controller"),raw_donations_treasure_controller=require("../components/performance/donations-treasure/raw-controller"),monthly_treasure_controller=require("../components/performance/donations-treasure/monthly-controller"),donations_treasure_performance_form=require("../components/performance/donations-treasure/performance-form-controller"),raw_donations_trusts_controller=require("../components/performance/donations-trusts/raw-controller"),monthly_trusts_controller=require("../components/performance/donations-trusts/monthly-controller"),donations_trusts_performance_form=require("../components/performance/donations-trusts/performance-form-controller"),raw_donations_online_controller=require("../components/performance/donations-online/raw-controller"),monthly_online_controller=require("../components/performance/donations-online/monthly-controller"),donations_online_performance_form=require("../components/performance/donations-online/performance-form-controller"),raw_donations_general_controller=require("../components/performance/donations-general/raw-controller"),monthly_generaldonations_controller=require("../components/performance/donations-general/monthly-controller"),donations_general_performance_form=require("../components/performance/donations-general/performance-form-controller"),raw_donations_kiosk_controller=require("../components/performance/donations-kiosk/raw-donations_kiosk-controller"),donations_kiosk_performance_form=require("../components/performance/donations-kiosk/performance-form-controller"),kiosk_uploader=require("../components/performance/donations-kiosk/kiosk-uploader-controller"),daily_donations_kiosk_controller=require("../components/performance/donations-kiosk/daily-donations_kiosk-controller"),yearly_corporate_controller=require("../components/performance/corporate/yearly-corporate-controller"),monthly_corporate_controller=require("../components/performance/corporate/monthly-corporate-controller"),raw_corporate_controller=require("../components/performance/corporate/raw-corporate-controller"),corporate_performance_form=require("../components/performance/corporate/performance-form-controller"),yearly_patron_controller=require("../components/performance/patron/yearly-patron-controller"),monthly_patron_controller=require("../components/performance/patron/monthly-patron-controller"),raw_patron_controller=require("../components/performance/patron/raw-patron-controller"),patron_performance_form=require("../components/performance/patron/performance-form-controller"),yearly_site_permissions_controller=require("../components/performance/site_permissions/yearly-site_permissions-controller"),monthly_site_permissions_controller=require("../components/performance/site_permissions/monthly-site_permissions-controller"),raw_site_permissions_controller=require("../components/performance/site_permissions/raw-site_permissions-controller"),site_permissions_performance_form=require("../components/performance/site_permissions/performance-form-controller"),yearly_operations_controller=require("../components/performance/operations/yearly-operations-controller"),monthly_operationss_controller=require("../components/performance/operations/monthly-operations-controller"),raw_operations_controller=require("../components/performance/operations/raw-operations-controller"),operations_performance_form=require("../components/performance/operations/performance-form-controller"),monthly_exhibitions_pwyt_controller=require("../components/performance/exhibitions-pwyt/monthly-donations-controller"),raw_exhibitions_pwyt_controller=require("../components/performance/exhibitions-pwyt/raw-donations-controller"),exhibitions_pwyt_performance_form=require("../components/performance/exhibitions-pwyt/performance-form-controller"),monthly_giftaid_controller=require("../components/performance/gift-aid/monthly-giftaid-controller"),monthly_all_giftaid_controller=require("../components/performance/gift-aid/monthly-allgiftaid-controller"),raw_giftaid_controller=require("../components/performance/gift-aid/raw-giftaid-controller"),giftaid_performance_form=require("../components/performance/gift-aid/performance-form-controller"),yearly_welcomedesk_controller=require("../components/performance/welcome-desk/yearly-welcomedesk-controller"),monthly_welcomedesk_controller=require("../components/performance/welcome-desk/monthly-welcomedesk-controller"),raw_welcomedesk_controller=require("../components/performance/welcome-desk/raw-welcomedesk-controller"),welcomedesk_performance_form=require("../components/performance/welcome-desk/performance-form-controller"),yearly_events_controller=require("../components/performance/events/yearly-events-controller"),monthly_events_controller=require("../components/performance/events/monthly-events-controller"),raw_events_controller=require("../components/performance/events/raw-events-controller"),events_performance_form=require("../components/performance/events/performance-form-controller"),raw_kpi_events_controller=require("../components/performance/kpi-events/raw-events-controller"),events_kpi_performance_form=require("../components/performance/kpi-events/performance-form-controller"),monthly_kpi_events_controller=require("../components/performance/kpi-events/monthly-events-controller"),standard_monthly_kpi_events_controller=require("../components/performance/kpi-events/standard-monthly-events-controller"),team_monthly_kpi_events_controller=require("../components/performance/team-kpis/standard-monthly-events-controller"),yearly_participation_controller=require("../components/performance/participation/yearly-participation-controller"),monthly_participation_controller=require("../components/performance/participation/monthly-participation-controller"),raw_participation_controller=require("../components/performance/participation/raw-participation-controller"),participation_performance_form=require("../components/performance/participation/performance-form-controller"),target_audience_controller=require("../components/performance/participation/target-audience-controller"),exhibition_teg_controller=require("../components/performance/gallery-visits/exhibitions-teg-controller"),yearly_teg_controller=require("../components/performance/gallery-visits/yearly-teg-controller"),weekly_teg_controller=require("../components/performance/gallery-visits/weekly-teg-controller"),monthly_teg_controller=require("../components/performance/gallery-visits/monthly-teg-controller"),raw_teg_controller=require("../components/performance/gallery-visits/raw-teg-controller"),teg_performance_form=require("../components/performance/gallery-visits/performance-form-controller"),yearly_learning_controller=require("../components/performance/learning/yearly-learning-controller"),monthly_learning_controller=require("../components/performance/learning/monthly-learning-controller"),age_learning_controller=require("../components/performance/learning/age-learning-controller"),raw_learning_controller=require("../components/performance/learning/raw-learning-controller"),learning_performance_form=require("../components/performance/learning/performance-form-controller"),exhibitions_summary_controllers=require("../components/performance/exhibitions/exhibitions-summary-controller"),app_controllers=require("../components/team/app-controllers"),leave_controllers=require("../components/team/leave-controller"),team_controllers=require("../components/team/team-controller"),member_controllers=require("../components/member/member-controller"),form_controllers=require("../components/team/form-controller"),timeline_controllers=require("../components/timeline/timeline-controller"),shopify_controllers=require("../components/shopify/shopify-controller"),shopify_monthly_controllers=require("../components/shopify/shopify-monthly-controller"),performance_form=require("../components/performance/visits/visits-form-controller"),venue_hire_form=require("../components/performance/venue-hire/visits-form-controller"),retail_uploader=require("../components/performance/retail/retail-uploader-controller"),retail_performance_form=require("../components/performance/retail/performance-form-controller"),raw_timelinesettings_controller=require("../components/timeline-settings/raw-timeline-settings-controller"),timeline_settings_form=require("../components/timeline-settings/settings-form-controller"),users_controller=require("../components/user-admin/users-controller"),iframe_controller=require("../components/iframe/iframe-controller"),turnstiles_controller=require("../components/turnstiles/turnstiles-controller"),raw_feedback_controller=require("../components/feedback/raw-feedback-controller"),raw_nominate_controller=require("../components/feedback/raw-nominate-controller"),controllersArray=[kpi_home_controller,nav_controller,turnstiles_controller,iframe_controller,timeline_resources_controller,timeline_settings_form,yearly_events_controller,monthly_events_controller,raw_events_controller,events_performance_form,raw_kpi_events_controller,events_kpi_performance_form,customers_controller,monthly_kpi_events_controller,standard_monthly_kpi_events_controller,team_monthly_kpi_events_controller,yearly_participation_controller,monthly_participation_controller,raw_participation_controller,participation_performance_form,target_audience_controller,votes_form,raw_votes_controller,monthly_votes_controller,votes_directive,customersdirective,controllers,feedback_controllers,satisfaction_controllers,operations_performance_form,raw_operations_controller,monthly_operationss_controller,yearly_operations_controller,giftaid_performance_form,raw_giftaid_controller,monthly_giftaid_controller,monthly_all_giftaid_controller,monthly_welcomedesk_controller,yearly_welcomedesk_controller,raw_welcomedesk_controller,welcomedesk_performance_form,yearly_learning_controller,monthly_learning_controller,age_learning_controller,monthly_exhibitions_pwyt_controller,raw_exhibitions_pwyt_controller,exhibitions_pwyt_performance_form,exhibition_teg_controller,yearly_teg_controller,weekly_teg_controller,monthly_teg_controller,raw_teg_controller,teg_performance_form,raw_learning_controller,learning_performance_form,exhibitions_summary_controllers,dead_controllers,nav_controller,colourkey_controller,tablefilter_controller,tech_support_controller,edit_bookings_controller,record_bookings_controller,recurring_events_controller,yearly_bookings_controller,monthly_bookings_controller,bookings_controller,record_equipment_controller,equipment_controller,record_rooms_controller,signage_settings_directives,raw_poster_controller,record_poster_controller,rooms_controller,downtime_controllers,raw_visitor_numbers_controller,performance_dashboard_controllers,analyser_controller,raw_turnstiles_controller,yearly_visitor_numbers_controller,raw_venue_hire_controller,monthly_venue_hire_controller,yearly_venue_hire_controller,monthly_visitor_numbers_controller,yearly_retail_sales_controller,monthly_retail_sales_controller,raw_retail_sales_controller,raw_corporate_controller,yearly_corporate_controller,monthly_corporate_controller,corporate_performance_form,raw_donations_controller,yearly_donations_controller,monthly_donations_controller,yearly_site_permissions_controller,monthly_site_permissions_controller,raw_site_permissions_controller,site_permissions_performance_form,patron_performance_form,raw_patron_controller,yearly_patron_controller,monthly_patron_controller,donations_performance_form,yearly_donations_other_controller,monthly_donations_other_controller,raw_donations_other_controller,donations_other_performance_form,monthly_donations_box_controller,monthly_donations_kiosk_controller,raw_donations_kiosk_controller,daily_donations_kiosk_controller,donations_kiosk_performance_form,kiosk_uploader,monthly_events_controller,raw_events_controller,events_performance_form,master_kpi_home_controller,app_controllers,leave_controllers,team_controllers,member_controllers,users_controller,turnstiles_controller,form_controllers,timeline_controllers,shopify_controllers,shopify_monthly_controllers,venue_hire_form,performance_form,retail_performance_form,retail_uploader,raw_timelinesettings_controller,monthly_directdebit_controller,raw_donations_directdebit_controller,donations_directdebit_performance_form,raw_donations_treasure_controller,monthly_treasure_controller,donations_treasure_performance_form,raw_donations_donors_controller,monthly_donors_controller,donations_donors_performance_form,raw_donations_trusts_controller,monthly_trusts_controller,donations_trusts_performance_form,raw_donations_online_controller,monthly_online_controller,donations_online_performance_form,raw_donations_general_controller,monthly_generaldonations_controller,donations_general_performance_form,raw_nominate_controller,raw_feedback_controller];
return _.each(controllersArray,function(controllers,names){_.each(controllers,function(controller,name){app.controller(name,controller)})}),module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app-controllers.js","/")},{"../components/exhibitions/directive":8,"../components/exhibitions/music/monthly-votes-controller":9,"../components/exhibitions/music/raw-votes-controller":10,"../components/exhibitions/music/votes-form-controller":11,"../components/feedback/raw-feedback-controller":13,"../components/feedback/raw-nominate-controller":14,"../components/gift-aid/customers-directive":15,"../components/gift-aid/raw-giftaid-controller":16,"../components/iframe/iframe-controller":17,"../components/machine-monitor/dashboard-controller":19,"../components/machine-monitor/dead-controller":20,"../components/machine-monitor/downtime-controller":21,"../components/machine-monitor/feedback-controller":23,"../components/machine-monitor/satisfaction-controller":25,"../components/member/member-controller":26,"../components/performance/analyser/analyser-controller":27,"../components/performance/corporate/monthly-corporate-controller":28,"../components/performance/corporate/performance-form-controller":29,"../components/performance/corporate/raw-corporate-controller":30,"../components/performance/corporate/yearly-corporate-controller":31,"../components/performance/dashboard-controllers":32,"../components/performance/donations-boxes/monthly-donations-controller":33,"../components/performance/donations-directdebit/monthly-controller":35,"../components/performance/donations-directdebit/performance-form-controller":36,"../components/performance/donations-directdebit/raw-controller":37,"../components/performance/donations-donors/monthly-controller":39,"../components/performance/donations-donors/performance-form-controller":40,"../components/performance/donations-donors/raw-controller":41,"../components/performance/donations-general/monthly-controller":43,"../components/performance/donations-general/performance-form-controller":44,"../components/performance/donations-general/raw-controller":45,"../components/performance/donations-kiosk/daily-donations_kiosk-controller":46,"../components/performance/donations-kiosk/kiosk-uploader-controller":47,"../components/performance/donations-kiosk/monthly-donations_kiosk-controller":48,"../components/performance/donations-kiosk/performance-form-controller":49,"../components/performance/donations-kiosk/raw-donations_kiosk-controller":50,"../components/performance/donations-online/monthly-controller":51,"../components/performance/donations-online/performance-form-controller":53,"../components/performance/donations-online/raw-controller":54,"../components/performance/donations-other/monthly-donations_other-controller":55,"../components/performance/donations-other/performance-form-controller":56,"../components/performance/donations-other/raw-donations_other-controller":57,"../components/performance/donations-other/yearly-donations_other-controller":58,"../components/performance/donations-treasure/monthly-controller":59,"../components/performance/donations-treasure/performance-form-controller":60,"../components/performance/donations-treasure/raw-controller":61,"../components/performance/donations-trusts/monthly-controller":63,"../components/performance/donations-trusts/performance-form-controller":64,"../components/performance/donations-trusts/raw-controller":65,"../components/performance/donations/monthly-donations-controller":67,"../components/performance/donations/performance-form-controller":68,"../components/performance/donations/raw-donations-controller":69,"../components/performance/donations/yearly-donations-controller":70,"../components/performance/events/monthly-events-controller":71,"../components/performance/events/performance-form-controller":72,"../components/performance/events/raw-events-controller":73,"../components/performance/events/yearly-events-controller":74,"../components/performance/exhibitions-pwyt/monthly-donations-controller":75,"../components/performance/exhibitions-pwyt/performance-form-controller":76,"../components/performance/exhibitions-pwyt/raw-donations-controller":77,"../components/performance/exhibitions/exhibitions-summary-controller":78,"../components/performance/gallery-visits/exhibitions-teg-controller":79,"../components/performance/gallery-visits/monthly-teg-controller":80,"../components/performance/gallery-visits/performance-form-controller":81,"../components/performance/gallery-visits/raw-teg-controller":82,"../components/performance/gallery-visits/weekly-teg-controller":83,"../components/performance/gallery-visits/yearly-teg-controller":84,"../components/performance/gift-aid/monthly-allgiftaid-controller":85,"../components/performance/gift-aid/monthly-giftaid-controller":86,"../components/performance/gift-aid/performance-form-controller":87,"../components/performance/gift-aid/raw-giftaid-controller":88,"../components/performance/home/kpi-home-controller":89,"../components/performance/home/master-kpi-home-controller":90,"../components/performance/kpi-events/monthly-events-controller":91,"../components/performance/kpi-events/performance-form-controller":92,"../components/performance/kpi-events/raw-events-controller":93,"../components/performance/kpi-events/standard-monthly-events-controller":94,"../components/performance/learning/age-learning-controller":95,"../components/performance/learning/monthly-learning-controller":96,"../components/performance/learning/performance-form-controller":97,"../components/performance/learning/raw-learning-controller":98,"../components/performance/learning/yearly-learning-controller":99,"../components/performance/operations/monthly-operations-controller":100,"../components/performance/operations/performance-form-controller":101,"../components/performance/operations/raw-operations-controller":102,"../components/performance/operations/yearly-operations-controller":103,"../components/performance/participation/monthly-participation-controller":104,"../components/performance/participation/performance-form-controller":105,"../components/performance/participation/raw-participation-controller":106,"../components/performance/participation/target-audience-controller":107,"../components/performance/participation/yearly-participation-controller":108,"../components/performance/patron/monthly-patron-controller":109,"../components/performance/patron/performance-form-controller":110,"../components/performance/patron/raw-patron-controller":111,"../components/performance/patron/yearly-patron-controller":112,"../components/performance/retail/monthly-retail-sales-controller":114,"../components/performance/retail/performance-form-controller":115,"../components/performance/retail/raw-retail-sales-controller":116,"../components/performance/retail/retail-uploader-controller":117,"../components/performance/retail/yearly-retail-sales-controller":118,"../components/performance/site_permissions/monthly-site_permissions-controller":119,"../components/performance/site_permissions/performance-form-controller":120,"../components/performance/site_permissions/raw-site_permissions-controller":121,"../components/performance/site_permissions/yearly-site_permissions-controller":122,"../components/performance/team-kpis/standard-monthly-events-controller":123,"../components/performance/turnstiles/monthly-turnstiles-controller":124,"../components/performance/turnstiles/raw-turnstiles-controller":125,"../components/performance/venue-hire/monthly-visits-controller":126,"../components/performance/venue-hire/raw-visits-controller":127,"../components/performance/venue-hire/visits-form-controller":128,"../components/performance/venue-hire/yearly-visits-controller":129,"../components/performance/visits/monthly-visits-controller":130,"../components/performance/visits/raw-visits-controller":131,"../components/performance/visits/visits-form-controller":132,"../components/performance/visits/yearly-visits-controller":133,"../components/performance/welcome-desk/monthly-welcomedesk-controller":134,"../components/performance/welcome-desk/performance-form-controller":135,"../components/performance/welcome-desk/raw-welcomedesk-controller":136,"../components/performance/welcome-desk/yearly-welcomedesk-controller":137,"../components/resource-bookings/bookings/edit-form-controller":138,"../components/resource-bookings/bookings/form-controller":139,"../components/resource-bookings/bookings/monthly-bookings-controller":140,"../components/resource-bookings/bookings/raw-bookings-controller":141,"../components/resource-bookings/bookings/recurring-events-controller":142,"../components/resource-bookings/bookings/yearly-bookings-controller":143,"../components/resource-bookings/equipment/form-controller":145,"../components/resource-bookings/equipment/raw-equipment-controller":146,"../components/resource-bookings/rooms/form-controller":147,"../components/resource-bookings/rooms/raw-rooms-controller":148,"../components/resource-bookings/timeline-resources-controller":149,"../components/shopify/shopify-controller":151,"../components/shopify/shopify-monthly-controller":153,"../components/signage/directive":154,"../components/signage/posters/form-controller":155,"../components/signage/posters/raw-poster-controller":156,"../components/team/app-controllers":157,"../components/team/form-controller":158,"../components/team/leave-controller":159,"../components/team/team-controller":160,"../components/tech-support/tech-support-controller":161,"../components/timeline-settings/raw-timeline-settings-controller":164,"../components/timeline-settings/settings-form-controller":165,"../components/timeline/timeline-controller":168,"../components/turnstiles/turnstiles-controller":179,"../components/user-admin/users-controller":181,"../shared/controllers/colourkey-controller":188,"../shared/controllers/controllers":189,"../shared/controllers/navbar-controller":190,"../shared/controllers/tablefilter-controller":194,b55mWE:4,buffer:3}],185:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function(app){var directives=require("../shared/directives/directives"),timeline_settings_directives=require("../components/timeline-settings/timeline-settings-directive"),tech_support_directives=require("../components/tech-support/tech-support-directive"),users_directives=require("../components/user-admin/users-directive"),timeline_directives=require("../components/timeline/timeline-directive"),shopify_directives=require("../components/shopify/shopify-directive"),performance_directives=require("../components/performance/performance-directive"),iframe_directives=require("../components/iframe/iframe-directive"),turnstiles_directives=require("../components/turnstiles/turnstiles-directive"),resources_directives=require("../components/resource-bookings/directive"),giftaid_directives=require("../components/gift-aid/customers-directive"),directdebit_directives=require("../components/performance/donations-directdebit/directdebit-directive"),treasure_directives=require("../components/performance/donations-treasure/treasure-directive"),donors_directives=require("../components/performance/donations-donors/donors-directive"),donors_trusts=require("../components/performance/donations-trusts/trusts-directive"),donors_online=require("../components/performance/donations-online/online-directive"),donors_general=require("../components/performance/donations-general/donors-directive"),feedback_directives=require("../components/feedback/directives"),directiveArray=[timeline_settings_directives,directives,tech_support_directives,users_directives,timeline_directives,shopify_directives,performance_directives,iframe_directives,turnstiles_directives,resources_directives,giftaid_directives,directdebit_directives,treasure_directives,donors_directives,donors_trusts,donors_online,donors_general,feedback_directives];return _.each(directiveArray,function(directives,names){_.each(directives,function(directive,name){app.directive(name,directive)})}),module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app-directives.js","/")},{"../components/feedback/directives":12,"../components/gift-aid/customers-directive":15,"../components/iframe/iframe-directive":18,"../components/performance/donations-directdebit/directdebit-directive":34,"../components/performance/donations-donors/donors-directive":38,"../components/performance/donations-general/donors-directive":42,"../components/performance/donations-online/online-directive":52,"../components/performance/donations-treasure/treasure-directive":62,"../components/performance/donations-trusts/trusts-directive":66,"../components/performance/performance-directive":113,"../components/resource-bookings/directive":144,"../components/shopify/shopify-directive":152,"../components/tech-support/tech-support-directive":162,"../components/timeline-settings/timeline-settings-directive":166,"../components/timeline/timeline-directive":169,"../components/turnstiles/turnstiles-directive":180,"../components/user-admin/users-directive":182,"../shared/directives/directives":195,b55mWE:4,buffer:3}],186:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function(app){return app.filter("valueFilter_retail",function(){return function(value,entity){if(value)return isNaN(value)||"retail"!=entity.typex&&"currency"!=entity.typex?isNaN(value)||"Average transaction"!=entity.stat?" % net_sales last year"==entity.stat?value:"function"==typeof value.replace?(value=value.replace("M-SHED","M Shed"),value=value.replace("GEORGIAN-HOUSE","Georgian House"),value=value.replace("RED-LODGE","Red Lodge"),value=value.replace("BLAISE","Blaise Museum"),value=value.replace("BRISTOL-ARCHIVES","Bristol Archives"),value=value.replace("ROMAN-VILLA","Kings Weston")):value:""+value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):""+Math.round(value).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}),app.filter("valueFilter",function(){return function(value,entity){return isNaN(value)||"retail"!=entity.typex&&"currency"!=entity.typex?isNaN(value)?value?(value=value.replace("M-SHED","M Shed"),value=value.replace("GEORGIAN-HOUSE","Georgian House"),value=value.replace("RED-LODGE","Red Lodge"),value=value.replace("BLAISE","Blaise Museum"),value=value.replace("BRISTOL-ARCHIVES","Bristol Archives"),value=value.replace("ROMAN-VILLA","Kings Weston")):void 0:value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):""+Math.round(value).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}),app.filter("orderByDayNumber",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),app.filter("propsFilter",function(){return function(items,props){var out=[];if(angular.isArray(items)){var keys=Object.keys(props);items.forEach(function(item){for(var itemMatches=!1,i=0;i<keys.length;i++){var prop=keys[i],text=props[prop].toLowerCase();if(item[prop].toString().toLowerCase().indexOf(text)!==-1){itemMatches=!0;break}}itemMatches&&out.push(item)})}else out=items;return out}}),module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app-filters.js","/")},{b55mWE:4,buffer:3}],187:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function(app){var data_services=require("../shared/services/data-services"),app_services=require("../shared/services/app-services"),timeline_services=require("../components/timeline/timeline-services"),timeline_leave_services=require("../components/timeline/timeline-leave-services"),timeline_shopify_functions=require("../components/timeline/timeline-shopify-services"),timeline_install_functions=require("../components/timeline/timeline-installs-services"),timeline_exhibitions_functions=require("../components/timeline/timeline-exhibitions-services"),timeline_visitor_figures_functions=require("../components/timeline/timeline-visitor-figures-services"),timeline_googlesheets_functions=require("../components/timeline/timeline-googlesheets-services"),timeline_learning_services=require("../components/timeline/timeline-learning-bookings-services"),timeline_loans_services=require("../components/timeline/timeline-loans-services"),tech_trello_services=require("../components/tech-support/trello-services"),timeline_bookings_services=require("../components/timeline/timeline-bookings-services"),timeline_functions_resources=require("../components/resource-bookings/timeline-resources-services"),downtime_services=require("../components/machine-monitor/downtime-services"),feedback_services=require("../components/machine-monitor/feedback-services"),servicesArray=[data_services,app_services,downtime_services,feedback_services,timeline_services,timeline_leave_services,timeline_shopify_functions,timeline_install_functions,timeline_exhibitions_functions,timeline_functions_resources,timeline_bookings_services,timeline_visitor_figures_functions,timeline_googlesheets_functions,timeline_learning_services,timeline_loans_services,tech_trello_services];return _.each(servicesArray,function(services,names){_.each(services,function(service,name){app.factory(name,service)})}),module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app-services.js","/")},{"../components/machine-monitor/downtime-services":22,"../components/machine-monitor/feedback-services":24,"../components/resource-bookings/timeline-resources-services":150,"../components/tech-support/trello-services":163,"../components/timeline/timeline-bookings-services":167,"../components/timeline/timeline-exhibitions-services":170,"../components/timeline/timeline-googlesheets-services":171,"../components/timeline/timeline-installs-services":172,"../components/timeline/timeline-learning-bookings-services":173,"../components/timeline/timeline-leave-services":174,"../components/timeline/timeline-loans-services":175,"../components/timeline/timeline-services":176,"../components/timeline/timeline-shopify-services":177,"../components/timeline/timeline-visitor-figures-services":178,"../shared/services/app-services":197,"../shared/services/data-services":198,b55mWE:4,buffer:3}],188:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.ColourKeycontroller=function($location,AuthService,$scope,$http){}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/colourkey-controller.js","/controllers")},{b55mWE:4,buffer:3}],189:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.ProductDetailsController=function($location,$scope,$routeParams,$http){encodeURIComponent($routeParams.id);$http.get("/api/v1/product/id/"+encoded).success(function(data){$scope.product=data.product}),setTimeout(function(){$scope.$emit("ProductDetailsController")},0)},exports.RadioController=function($location,$scope,$routeParams,$http){$scope.formData={},$scope.monthWeek="month"},exports.date_select_controller=function($location,$scope,$routeParams,$http){$scope.start_date=new Date("04/01/2019"),$scope.end_date=moment($scope.start_date).add("years",1).format("DD/MM/YYYY")},exports.refreshButtonKeycontroller=function($location,$scope,$routeParams,$http){}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/controllers.js","/controllers")},{b55mWE:4,buffer:3}],190:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.NavController=function($location,AuthService,$scope,$http){function sortFunction(a,b){return a.value===b.value?0:a.value<b.value?-1:1}$scope.path=$location.path(),$scope.a=10;try{$scope.user="not logged in",$scope.$location=$location,default_permissions=[{add_rooms:!1,add_equipment:!1,approve_room_bookings:!1,approve_equipment_bookings:!1}];var views={};$scope.user_groups=[],$scope.user_groups.AV=[],$scope.user_groups.RETAIL=[],$scope.user_groups.DIGITAL=[],$scope.user_groups.DEFAULT=[],$scope.user_groups["VENUE HIRE"]=[],$scope.user_groups.LEARNING=[],$scope.user_groups.EXHIBITIONS=[],$scope.user_groups["ARTS AND EVENTS"]=[],$scope.user_groups.OPERATIONS=[],$scope.user_groups.COMMERCIAL=[];var timeline={teamx:"_DONATIONS",link:"timeline",value:"Timeline"};views.timeline=timeline;var masterkpi={teamx:"MASTER",link:"master",value:"Master KPIs"};views.masterkpi=masterkpi;var dead={teamx:"_DONATIONS",link:"dead",value:"Downtime"};views.dead=dead;var activity={teamx:"_DONATIONS",link:"activity",value:"Machine Activity"};views.activity=activity;var feedback={teamx:"_DONATIONS",link:"raw-feedback",value:"Kiosk feedback"};views.feedback=feedback;var nominate={teamx:"_DONATIONS",link:"raw-nominate",value:"Youmake Bristol"};views.nominate=nominate;var tech_support={teamx:"_DONATIONS",link:"tech-support",value:"Tech-support"};views.tech_support=tech_support;var shopify={teamx:"_DONATIONS",link:"shopify_app",value:"Shopify"};views.shopify=shopify;var users={teamx:"_DONATIONS",link:"users",value:"ADMIN: Users"};views.users=users;var timeline_settings={teamx:"_DONATIONS",link:"timeline_settings",value:"Timeline settings"};views.timeline_settings=timeline_settings;var doom={teamx:"_DONATIONS",link:"doom",value:"DOOM!"};views.doom=doom;var analyser={teamx:"_DONATIONS",link:"analyser",value:"Performance analyser (BETA)"};views.analyser=analyser;var rooms={teamx:"_DONATIONS",link:"rooms",value:"Add rooms"};views.rooms=rooms;var equipment={teamx:"_DONATIONS",link:"equipment",value:"Add equipment"};views.equipment=equipment;var equipment_bookings={teamx:"_DONATIONS",link:"bookings/equipment",value:"Equipment booking"};views.equipment_bookings=equipment_bookings;var room_bookings={teamx:"_DONATIONS",link:"bookings/rooms",value:"Add a room booking"};views.room_bookings=room_bookings;var room_bookings_list={teamx:"_DONATIONS",link:"bookingslist/rooms",value:"Room bookings list"};views.room_bookings_list=room_bookings_list;var bookings_report={teamx:"_DONATIONS",link:"bookings-report",value:"Bookings report"};views.bookings_report=bookings_report;var posters_list={teamx:"_DONATIONS",link:"posters",value:"Posters list"};views.posters_list=posters_list;var add_posters={teamx:"_DONATIONS",link:"add-poster",value:"Add poster"};views.add_posters=add_posters;var room_hire={teamx:"_DONATIONS",link:"room-hire",value:"Room booking timeline"};views.room_hire=room_hire;var equipment_booking_timeline={teamx:"_DONATIONS",link:"equipment-timeline",value:"Equipment booking timeline"};views.equipment_booking_timeline=equipment_booking_timeline;var participation={teamx:"PARTICIPATION",link:"participation-dashboard",value:"Participation dashboard"};views.participation=participation;var performance={teamx:"VISITS",link:"record-visitor-numbers",value:"Record visitor figures"};views.performance=performance;var record_retail_sales={teamx:"RETAIL",link:"record-retail-sales",value:"Record retail sales"};views.record_retail_sales=record_retail_sales;var upload_retail_sales={teamx:"RETAIL",link:"upload-retail-sales",value:"Upload retail sales"};views.upload_retail_sales=upload_retail_sales;var raw_retail_sales={teamx:"RETAIL",link:"raw-retail-sales",value:"Raw retail sales"};views.raw_retail_sales=raw_retail_sales;var monthly_retail_sales={teamx:"RETAIL",link:"monthly-retail-sales",value:"Monthly retail sales"};views.monthly_retail_sales=monthly_retail_sales;var record_donations_other={teamx:"DONATIONS",link:"record-donations-other",value:"Record exhibition ticket donations"};views.record_donations_other=record_donations_other;var donations_other={teamx:"DONATIONS",link:"raw-donations-other",value:"Raw exhibition ticket donations"};views.donations_other=donations_other;var gift_aid_customers={teamx:"DONATIONS",link:"gift-aid-customers",value:"Gift Aid Customers"};views.gift_aid_customers=gift_aid_customers;var monthly_donations_other={teamx:"DONATIONS",link:"monthly-donations-other",value:"Monthly exhibition ticket donations"};views.monthly_donations_other=monthly_donations_other;views.record_donations_kiosk=monthly_donations_other;var upload_kiosk_donations={teamx:"DONATIONS",link:"upload-kiosk-donations",value:"Upload kiosk donations"};views.upload_kiosk_donations=upload_kiosk_donations;var donations_kiosk={teamx:"DONATIONS",link:"raw-donations-kiosk",value:"Raw kiosk donation data"};views.donations_kiosk=donations_kiosk;var daily_donations_kiosk={teamx:"DONATIONS",link:"day-donations-kiosk",value:"Daily kiosk donation data"};views.daily_donations_kiosk=daily_donations_kiosk;var monthly_donations_kiosk={teamx:"DONATIONS",link:"monthly-donations-kiosk",value:"Monthly kiosk donations"};views.monthly_donations_kiosk=monthly_donations_kiosk;var monthly_donations_box={teamx:"DONATIONS",link:"monthly-donations-box",value:"Monthly donations boxes"};views.monthly_donations_box=monthly_donations_box;var record_site_permissions={teamx:"ARTS AND EVENTS",link:"record-site-permissions",value:"Record  site permissions"};views.record_site_permissions=record_site_permissions;var site_permissions={teamx:"ARTS AND EVENTS",link:"raw-site-permissions",value:"Raw site permissions data"};views.site_permissions=site_permissions;var monthly_site_permissions={teamx:"ARTS AND EVENTS",link:"monthly-site-permissions",value:"Monthly site permissions"};views.monthly_site_permissions=monthly_site_permissions;var record_donations={teamx:"DONATIONS",link:"record-donations",value:"Record donation boxes"};views.record_donations=record_donations;var donations={teamx:"DONATIONS",link:"raw-donations",value:"Raw donation boxes data"};views.donations=donations;var monthly_donations_boxes={teamx:"DONATIONS",link:"monthly-donations-kiosks",value:"Monthly donation boxes and kiosks"};views.monthly_donations_boxes=monthly_donations_boxes;var monthly_donations={teamx:"DONATIONS",link:"monthly-donations",value:" Monthly total income"};views.monthly_donations=monthly_donations;var record_patron={teamx:"DONATIONS",link:"record-patron",value:"Record patron"};views.record_patron=record_patron;var raw_patron={teamx:"DONATIONS",link:"raw-patron",value:"Raw patron data"};views.raw_patron=raw_patron;var monthly_patron={teamx:"DONATIONS",link:"monthly-patron",value:"Monthly patron"};views.monthly_patron=monthly_patron;var record_corporate={teamx:"DONATIONS",link:"record-corporate",value:"Record corporate"};views.record_corporate=record_corporate;var raw_corporate={teamx:"DONATIONS",link:"raw-corporate",value:"Raw corporate data"};views.raw_corporate=raw_corporate;var monthly_corporate={teamx:"DONATIONS",link:"monthly-corporate",value:"Monthly corporate"};views.monthly_corporate=monthly_corporate;var transformation_kpis={teamx:"TEAM",link:"transformation-kpis",value:"Transformation"};views.transformation_kpis=transformation_kpis;var engagement_kpis={teamx:"TEAM",link:"engagement-kpis",value:"Engagement"};views.engagement_kpis=engagement_kpis;var collections_kpis={teamx:"TEAM",link:"collections-kpis",value:"Collections"};views.collections_kpis=collections_kpis;var record_operations={teamx:"OPERATIONS",link:"record-operations",value:"Record operations"};views.record_operations=record_operations;var operations={teamx:"OPERATIONS",link:"raw-operations",value:"OPERATIONS: Raw operations data"};views.operations=operations;var monthly_operations={teamx:"OPERATIONS",link:"monthly-operations",value:"Monthly operations"};views.monthly_operations=monthly_operations;var record_events={teamx:"EVENTS",link:"record-events",value:"Record events"};views.record_events=record_events;var record_kpi_events={teamx:"TEAM",link:"record-kpi-events",value:"record income, enquiries, etc"};views.record_kpi_events=record_kpi_events;var events={teamx:"EVENTS",link:"raw-events",value:"EVENTS: Raw events data"};views.events=events;var kpi_events={teamx:"TEAM",link:"raw-kpi-events",value:"enquiries,income, sessions"};views.kpi_events=kpi_events;var monthly_events={teamx:"EVENTS",link:"monthly-events",value:"Monthly events"};views.monthly_events=monthly_events;var record_teg={teamx:"EXHIBITIONS",link:"record-teg",value:"Record TEG figures"};views.record_teg=record_teg;var teg={teamx:"EXHIBITIONS",link:"raw-teg",value:"Raw TEG figures"};views.teg=teg;var monthly_teg={teamx:"EXHIBITIONS",link:"monthly-teg",value:"Monthly TEG figures"};views.monthly_teg=monthly_teg;var record_exhibitions_pwyt={teamx:"EXHIBITIONS",link:"record-exhibitions-pwyt",value:"Record income"};views.record_exhibitions_pwyt=record_exhibitions_pwyt;var raw_exhibitions_pwyt={teamx:"EXHIBITIONS",link:"raw-exhibitions-pwyt",value:"income"};views.raw_exhibitions_pwyt=raw_exhibitions_pwyt;var record_learning={teamx:"LEARNING",link:"record-learning",value:"Record learning"};views.record_learning=record_learning;var learning={teamx:"LEARNING",link:"raw-learning",value:"Raw learning data"};views.learning=learning;var monthly_learning={teamx:"LEARNING",link:"monthly-learning",value:"Monthly learning"};views.monthly_learning=monthly_learning;var raw_visits={teamx:"VISITS",link:"raw-visits",value:"Raw visits data"};views.raw_visits=raw_visits;var monthly_visits={teamx:"VISITS",link:"monthly-visits",value:"Monthly visits"};views.monthly_visits=monthly_visits;var record_venue_hire={teamx:"VENUE HIRE",link:"record-venue-hire",value:"Record venue hire"};views.record_venue_hire=record_venue_hire;var raw_venue_hire={teamx:"VENUE HIRE",link:"raw-venue-hire",value:"Raw venue hire"};views.raw_venue_hire=raw_venue_hire;var monthly_venue_hire={teamx:"VENUE HIRE",link:"monthly-venue-hire",value:"Monthly venue hire"};views.monthly_venue_hire=monthly_venue_hire;var record_giftaid={teamx:"DONATIONS",link:"record-giftaid",value:"Record gift aid"};views.record_giftaid=record_giftaid;var raw_giftaid={teamx:"DONATIONS",link:"raw-giftaid",value:"Raw gift aid"};views.raw_giftaid=raw_giftaid;var monthly_giftaid={teamx:"DONATIONS",link:"monthly-giftaid",value:"Monthly gift aid"};views.monthly_giftaid=monthly_giftaid;var raw_directdebit={teamx:"DONATIONS",link:"raw-directdebit",value:"Raw direct debit"};views.raw_giftaid=raw_directdebit;var monthly_directdebit={teamx:"DONATIONS",link:"monthly-directdebit",value:"Monthly direct debit"};views.monthly_directdebit=monthly_directdebit;var record_directdebit={teamx:"DONATIONS",link:"record-directdebit",value:"Record direct debit"};views.record_directdebit=record_directdebit;var raw_donors={teamx:"DONATIONS",link:"raw-donors",value:"Raw Major Donors"};views.raw_donors=raw_donors;var monthly_donors={teamx:"DONATIONS",link:"monthly-donors",value:"Monthly Major Donors"};views.monthly_donors=monthly_donors;var record_donors={teamx:"DONATIONS",link:"record-donors",value:"Record Major Donors"};views.record_donors=record_donors;var raw_trusts={teamx:"DONATIONS",link:"raw-trusts",value:"Raw Trusts and foundations"};views.raw_trusts=raw_trusts;var monthly_trusts={teamx:"DONATIONS",link:"monthly-trusts",value:"Monthly Trusts and foundations"
};views.monthly_trusts=monthly_trusts;var record_trusts={teamx:"DONATIONS",link:"record-trusts",value:"Record Trusts and foundationss"};views.record_trusts=record_trusts;var raw_online={teamx:"DONATIONS",link:"raw-online",value:"Raw online donations"};views.raw_online=raw_online;var monthly_online={teamx:"DONATIONS",link:"monthly-online",value:"Monthly online donations"};views.monthly_online=monthly_online;var record_online={teamx:"DONATIONS",link:"record-online",value:"Record online donations"};views.record_online=record_online;var raw_general={teamx:"DONATIONS",link:"raw-general",value:"Raw general donations"};views.raw_general=raw_general;var monthly_general={teamx:"DONATIONS",link:"monthly-general",value:"Monthly general donations"};views.monthly_general=monthly_general;var record_general={teamx:"DONATIONS",link:"record-general",value:"Record general donations"};views.record_general=record_general;var raw_treasure={teamx:"DONATIONS",link:"raw-treasure",value:"Raw treasure"};views.raw_treasure=raw_treasure;var monthly_treasure={teamx:"DONATIONS",link:"monthly-treasure",value:"Monthly treasure"};views.monthly_treasure=monthly_treasure;var record_treasure={teamx:"DONATIONS",link:"record-treasure",value:"Record treasure"};views.record_treasure=record_treasure;var record_welcomedesk={teamx:"DONATIONS",link:"record-welcomedesk",value:"Record Welcome desk"};views.record_welcomedesk=record_welcomedesk;var raw_welcomedesk={teamx:"DONATIONS",link:"raw-welcomedesk",value:"Raw Welcome desk"};views.raw_welcomedesk=raw_welcomedesk;var monthly_welcomedesk={teamx:"DONATIONS",link:"monthly-welcomedesk",value:"Monthly Welcome desk"};views.monthly_welcomedesk=monthly_welcomedesk;var signage=[];signage.push(posters_list),signage.push(add_posters);var resources=[];resources.push(rooms),resources.push(equipment),resources.push(equipment_bookings),resources.push(bookings_report),resources.push(room_hire),resources.push(equipment_booking_timeline);var performance_data=[];performance_data.push(room_hire),$scope.user_groups.COMMERCIAL.views=[],$scope.user_groups.COMMERCIAL.enter_data=[],$scope.user_groups.COMMERCIAL.resources=[],$scope.user_groups.COMMERCIAL.permissions=default_permissions,$scope.user_groups.COMMERCIAL.resources=resources,$scope.user_groups.COMMERCIAL.performance=performance_data;var enter_data=[];enter_data.push(record_site_permissions);var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(monthly_site_permissions),performance_data.push(site_permissions),performance_data.push(events),$scope.user_groups["ARTS AND EVENTS"].permissions=default_permissions,$scope.user_groups["ARTS AND EVENTS"].views=[],$scope.user_groups["ARTS AND EVENTS"].enter_data=[],$scope.user_groups["ARTS AND EVENTS"].resources=[],$scope.user_groups["ARTS AND EVENTS"].views.push(masterkpi),$scope.user_groups["ARTS AND EVENTS"].views.push(timeline),$scope.user_groups["ARTS AND EVENTS"].views.push(analyser),$scope.user_groups["ARTS AND EVENTS"].enter_data=enter_data,$scope.user_groups["ARTS AND EVENTS"].performance=performance_data,require("./navigation/admin")($scope,views),require("./navigation/development")($scope,views),require("./navigation/staff")($scope,views);var enter_data=[];enter_data.push(record_exhibitions_pwyt),enter_data.push(record_teg),enter_data.push(record_events),enter_data.push(record_kpi_events),enter_data.push(record_venue_hire);var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(monthly_retail_sales),performance_data.push(monthly_donations),performance_data.push(transformation_kpis),performance_data.push(engagement_kpis),performance_data.push(collections_kpis),performance_data.push(monthly_learning),performance_data.push(raw_exhibitions_pwyt),performance_data.push(teg),performance_data.push(monthly_teg),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(monthly_events),performance_data.push(participation),$scope.user_groups.EXHIBITIONS.views=[],$scope.user_groups.EXHIBITIONS.enter_data=enter_data,$scope.user_groups.EXHIBITIONS.resources=[],$scope.user_groups.EXHIBITIONS.permissions=default_permissions,$scope.user_groups.EXHIBITIONS.views.push(masterkpi),$scope.user_groups.EXHIBITIONS.views.push(timeline),$scope.user_groups.EXHIBITIONS.views.push(analyser),$scope.user_groups.EXHIBITIONS.performance=performance_data,$scope.user_groups.EXHIBITIONS.views.push(room_hire),$scope.user_groups.EXHIBITIONS.resources=resources;var enter_data=[];enter_data.push(record_learning),enter_data.push(record_events),enter_data.push(record_kpi_events),enter_data.push(record_venue_hire);var performance_data=[];performance_data.push(raw_visits),performance_data.push(learning),performance_data.push(monthly_learning),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(monthly_events),performance_data.push(participation),$scope.user_groups.LEARNING.views=[],$scope.user_groups.LEARNING.enter_data=[],$scope.user_groups.LEARNING.resources=[],$scope.user_groups.LEARNING.permissions=default_permissions,$scope.user_groups.LEARNING.views.push(masterkpi),$scope.user_groups.LEARNING.views.push(timeline),$scope.user_groups.LEARNING.views.push(analyser),$scope.user_groups.LEARNING.enter_data=enter_data,$scope.user_groups.LEARNING.performance=performance_data,$scope.user_groups.LEARNING.resources=resources,$scope.user_groups.LEARNING.views.push(room_hire);var enter_data=[];enter_data.push(performance),enter_data.push(record_retail_sales),enter_data.push(upload_retail_sales),enter_data.push(record_donations),enter_data.push(record_giftaid),enter_data.push(record_welcomedesk),enter_data.push(record_learning),enter_data.push(record_exhibitions_pwyt),enter_data.push(record_teg),enter_data.push(record_events),enter_data.push(record_kpi_events),enter_data.push(record_venue_hire),enter_data.push(record_operations),enter_data=enter_data.sort();var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(teg),performance_data.push(monthly_teg),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(participation),performance_data=performance_data.sort(),$scope.user_groups.AV.views=[],$scope.user_groups.AV.enter_data=[],$scope.user_groups.AV.resources=[],$scope.user_groups.AV.views.push(room_hire),$scope.user_groups.AV.views.push(timeline),$scope.user_groups.AV.views.push(analyser),$scope.user_groups.AV.views.push(dead),$scope.user_groups.AV.views.push(activity),$scope.user_groups.AV.views.push(feedback),$scope.user_groups.AV.views.push(tech_support),$scope.user_groups.AV.enter_data=enter_data,$scope.user_groups.AV.performance=performance_data,$scope.user_groups.AV.resources=resources,$scope.user_groups.AV.permissions=[];var enter_data=[];enter_data.push(performance),enter_data.push(record_retail_sales),enter_data.push(upload_retail_sales),enter_data.push(record_donations),enter_data.push(record_giftaid),enter_data.push(record_events),enter_data.push(record_kpi_events),enter_data.push(record_venue_hire);var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(raw_retail_sales),performance_data.push(monthly_retail_sales),performance_data.push(raw_giftaid),performance_data.push(monthly_giftaid),performance_data.push(monthly_donations),performance_data.push(transformation_kpis),performance_data.push(engagement_kpis),performance_data.push(collections_kpis),performance_data.push(donations),performance_data.push(monthly_welcomedesk),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(monthly_events),performance_data.push(participation),$scope.user_groups.DIGITAL.views=[],$scope.user_groups.DIGITAL.enter_data=[],$scope.user_groups.DIGITAL.resources=[],$scope.user_groups.DIGITAL.permissions=default_permissions,$scope.user_groups.DIGITAL.views.push(masterkpi),$scope.user_groups.DIGITAL.views.push(timeline),$scope.user_groups.DIGITAL.views.push(analyser),$scope.user_groups.DIGITAL.views.push(dead),$scope.user_groups.DIGITAL.views.push(activity),$scope.user_groups.DIGITAL.views.push(tech_support),$scope.user_groups.DIGITAL.views.push(shopify),$scope.user_groups.DIGITAL.enter_data=enter_data,$scope.user_groups.DIGITAL.performance=performance_data,$scope.user_groups.DIGITAL.resources=[],$scope.user_groups.DIGITAL.resources=resources;var performance_data=[],enter_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(monthly_retail_sales),performance_data.push(monthly_donations),performance_data.push(transformation_kpis),performance_data.push(engagement_kpis),performance_data.push(collections_kpis),performance_data.push(monthly_events),performance_data.push(participation),$scope.user_groups.DEFAULT.views=[],$scope.user_groups.DEFAULT.enter_data=[],$scope.user_groups.DEFAULT.resources=[],$scope.user_groups.DEFAULT.permissions=default_permissions,$scope.user_groups.DEFAULT.views.push(masterkpi),$scope.user_groups.DEFAULT.views.push(timeline),$scope.user_groups.DEFAULT.views.push(analyser),$scope.user_groups.DEFAULT.views.push(monthly_visits),$scope.user_groups.DEFAULT.performance=performance_data,$scope.user_groups.DEFAULT.enter_data=enter_data;var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(monthly_retail_sales),performance_data.push(monthly_donations),performance_data.push(transformation_kpis),performance_data.push(engagement_kpis),performance_data.push(collections_kpis),performance_data.push(raw_exhibitions_pwyt),performance_data.push(monthly_teg),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(monthly_events),performance_data.push(operations),performance_data.push(monthly_operations),performance_data.push(monthly_welcomedesk),performance_data.push(participation),enter_data.push(record_teg),enter_data.push(record_operations),enter_data.push(record_exhibitions_pwyt),$scope.user_groups["VENUE HIRE"].views=[],$scope.user_groups["VENUE HIRE"].enter_data=[],$scope.user_groups["VENUE HIRE"].resources=[],$scope.user_groups["VENUE HIRE"].permissions=default_permissions,$scope.user_groups["VENUE HIRE"].views.push(masterkpi),$scope.user_groups["VENUE HIRE"].views.push(timeline),$scope.user_groups["VENUE HIRE"].views.push(room_hire),$scope.user_groups["VENUE HIRE"].views.push(analyser),$scope.user_groups["VENUE HIRE"].enter_data=enter_data,$scope.user_groups["VENUE HIRE"].performance=performance_data,$scope.user_groups["VENUE HIRE"].resources=[],$scope.user_groups["VENUE HIRE"].resources=resources;var performance_data=[];performance_data.push(raw_visits),performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(monthly_retail_sales),performance_data.push(monthly_donations),performance_data.push(transformation_kpis),performance_data.push(engagement_kpis),performance_data.push(collections_kpis),performance_data.push(raw_exhibitions_pwyt),performance_data.push(monthly_teg),performance_data.push(events),performance_data.push(kpi_events),performance_data.push(monthly_events),performance_data.push(operations),performance_data.push(monthly_operations),performance_data.push(monthly_welcomedesk),performance_data.push(participation),enter_data.push(record_teg),enter_data.push(record_operations),enter_data.push(record_exhibitions_pwyt),$scope.user_groups.OPERATIONS.views=[],$scope.user_groups.OPERATIONS.enter_data=[],$scope.user_groups.OPERATIONS.resources=[],$scope.user_groups.OPERATIONS.permissions=default_permissions,$scope.user_groups.OPERATIONS.views.push(masterkpi),$scope.user_groups.OPERATIONS.views.push(timeline),$scope.user_groups.OPERATIONS.views.push(room_hire),$scope.user_groups.OPERATIONS.views.push(analyser),$scope.user_groups.OPERATIONS.enter_data=enter_data,$scope.user_groups.OPERATIONS.performance=performance_data,$scope.user_groups.OPERATIONS.resources=[],$scope.user_groups.OPERATIONS.resources=resources;var enter_data=[];enter_data.push(record_retail_sales),enter_data.push(upload_retail_sales),enter_data.push(record_events),enter_data.push(record_kpi_events);var performance_data=[];performance_data.push(monthly_visits),performance_data.push(raw_venue_hire),performance_data.push(monthly_venue_hire),performance_data.push(raw_retail_sales),performance_data.push(monthly_retail_sales),performance_data.push(participation),$scope.user_groups.RETAIL.views=[],$scope.user_groups.RETAIL.enter_data=[],$scope.user_groups.RETAIL.resources=[],$scope.user_groups.RETAIL.performance=[],$scope.user_groups.RETAIL.permissions=default_permissions,$scope.user_groups.RETAIL.views.push(masterkpi),$scope.user_groups.RETAIL.views.push(timeline),$scope.user_groups.RETAIL.enter_data=enter_data,$scope.user_groups.RETAIL.performance=performance_data,AuthService.isLoggedIn().then(function(user){user.data.group?(user.data.permissions=$scope.user_groups[user.data.group].permissions,user.data.views=$scope.user_groups[user.data.group].views,user.data.views=user.data.views.sort(sortFunction),user.data.resources=$scope.user_groups[user.data.group].resources,user.data.resources=user.data.resources.sort(sortFunction),$scope.user_groups[user.data.group].signage&&(user.data.signage=$scope.user_groups[user.data.group].signage,user.data.signage=user.data.signage.sort(sortFunction)),user.data.performance=$scope.user_groups[user.data.group].performance,user.data.performance=user.data.performance.sort(sortFunction),user.data.enter_data=$scope.user_groups[user.data.group].enter_data,user.data.enter_data=user.data.enter_data.sort(sortFunction),"pace"==user.data.lastName.toLowerCase()&&user.data.views.push(doom)):user.data.views=$scope.user_groups.DEFAULT.views,$scope.user=user.data})}catch(err){err&&console.log(err)}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/navbar-controller.js","/controllers")},{"./navigation/admin":191,"./navigation/development":192,"./navigation/staff":193,b55mWE:4,buffer:3}],191:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function($scope,views){var signage=[];signage.push(views.posters_list),signage.push(views.add_posters);var resources=[];resources.push(views.rooms),resources.push(views.equipment),resources.push(views.equipment_bookings),resources.push(views.bookings_report),resources.push(views.room_hire),resources.push(views.equipment_booking_timeline),$scope.user_groups.ADMIN=[];var enter_data=[];enter_data.push(views.performance),enter_data.push(views.record_retail_sales),enter_data.push(views.upload_retail_sales),enter_data.push(views.record_donations),enter_data.push(views.record_site_permissions),enter_data.push(views.record_donations_other),enter_data.push(views.upload_kiosk_donations),enter_data.push(views.record_corporate),enter_data.push(views.record_directdebit),enter_data.push(views.record_treasure),enter_data.push(views.record_trusts),enter_data.push(views.record_online),enter_data.push(views.record_general),enter_data.push(views.record_donors),enter_data.push(views.record_patron),enter_data.push(views.record_welcomedesk),enter_data.push(views.record_learning),enter_data.push(views.record_exhibitions_pwyt),enter_data.push(views.record_teg),enter_data.push(views.record_events),enter_data.push(views.record_kpi_events),enter_data.push(views.record_venue_hire),enter_data.push(views.record_operations),enter_data=enter_data.sort();var performance_data=[];return performance_data.push(views.raw_visits),performance_data.push(views.monthly_visits),performance_data.push(views.raw_venue_hire),performance_data.push(views.monthly_venue_hire),performance_data.push(views.raw_retail_sales),performance_data.push(views.monthly_retail_sales),performance_data.push(views.monthly_site_permissions),performance_data.push(views.site_permissions),performance_data.push(views.raw_giftaid),performance_data.push(views.raw_patron),performance_data.push(views.raw_general),performance_data.push(views.raw_corporate),performance_data.push(views.raw_directdebit),performance_data.push(views.raw_treasure),performance_data.push(views.raw_donors),performance_data.push(views.raw_trusts),performance_data.push(views.raw_online),performance_data.push(views.monthly_giftaid),performance_data.push(views.monthly_donations),performance_data.push(views.monthly_patron),performance_data.push(views.monthly_directdebit),performance_data.push(views.monthly_treasure),performance_data.push(views.monthly_donors),performance_data.push(views.monthly_general),performance_data.push(views.monthly_trusts),performance_data.push(views.monthly_online),performance_data.push(views.monthly_corporate),performance_data.push(views.monthly_donations_other),performance_data.push(views.monthly_donations_kiosk),performance_data.push(views.monthly_donations_box),performance_data.push(views.donations),performance_data.push(views.donations_kiosk),performance_data.push(views.daily_donations_kiosk),performance_data.push(views.donations_other),performance_data.push(views.raw_welcomedesk),performance_data.push(views.monthly_welcomedesk),performance_data.push(views.participation),performance_data.push(views.learning),performance_data.push(views.monthly_learning),performance_data.push(views.raw_exhibitions_pwyt),performance_data.push(views.teg),performance_data.push(views.monthly_teg),performance_data.push(views.events),performance_data.push(views.kpi_events),performance_data.push(views.monthly_events),performance_data.push(views.operations),performance_data.push(views.monthly_operations),performance_data.push(views.transformation_kpis),performance_data.push(views.engagement_kpis),performance_data.push(views.collections_kpis),performance_data.push(views.gift_aid_customers),performance_data=performance_data.sort(),$scope.user_groups.ADMIN.views=[],$scope.user_groups.ADMIN.enter_data=[],$scope.user_groups.ADMIN.resources=[],$scope.user_groups.ADMIN.signage=[],$scope.user_groups.ADMIN.permissions=default_permissions,$scope.user_groups.ADMIN.views.push(views.masterkpi),$scope.user_groups.ADMIN.views.push(views.room_hire),$scope.user_groups.ADMIN.views.push(views.timeline),$scope.user_groups.ADMIN.views.push(views.analyser),$scope.user_groups.ADMIN.views.push(views.dead),$scope.user_groups.ADMIN.views.push(views.activity),$scope.user_groups.ADMIN.views.push(views.feedback),$scope.user_groups.ADMIN.views.push(views.nominate),$scope.user_groups.ADMIN.views.push(views.tech_support),$scope.user_groups.ADMIN.views.push(views.shopify),$scope.user_groups.ADMIN.views.push(views.users),$scope.user_groups.ADMIN.views.push(views.timeline_settings),$scope.user_groups.ADMIN.enter_data=enter_data,$scope.user_groups.ADMIN.performance=performance_data,$scope.user_groups.ADMIN.resources=resources,$scope.user_groups.ADMIN.signage=signage,module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/navigation/admin.js","/controllers/navigation")},{b55mWE:4,buffer:3}],192:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function($scope,views){var signage=[];signage.push(views.posters_list),signage.push(views.add_posters);var resources=[];resources.push(views.rooms),resources.push(views.equipment),resources.push(views.equipment_bookings),resources.push(views.bookings_report),resources.push(views.room_hire),resources.push(views.equipment_booking_timeline);var enter_data=[];enter_data.push(views.performance),enter_data.push(views.record_corporate),enter_data.push(views.record_patron),enter_data.push(views.record_donations),enter_data.push(views.record_donations_other),enter_data.push(views.upload_kiosk_donations),enter_data.push(views.record_welcomedesk),enter_data.push(views.record_directdebit),enter_data.push(views.record_treasure),enter_data.push(views.record_donors),enter_data.push(views.record_trusts),enter_data.push(views.record_online),enter_data.push(views.record_general),enter_data.push(views.record_events),enter_data.push(views.record_kpi_events),enter_data.push(views.record_venue_hire);var performance_data=[];return performance_data.push(views.raw_visits),performance_data.push(views.monthly_visits),performance_data.push(views.raw_venue_hire),performance_data.push(views.monthly_venue_hire),performance_data.push(views.gift_aid_customers),performance_data.push(views.monthly_retail_sales),performance_data.push(views.raw_giftaid),performance_data.push(views.raw_patron),performance_data.push(views.raw_trusts),performance_data.push(views.raw_directdebit),performance_data.push(views.raw_treasure),performance_data.push(views.raw_donors),performance_data.push(views.raw_online),performance_data.push(views.raw_general),performance_data.push(views.raw_corporate),performance_data.push(views.monthly_giftaid),performance_data.push(views.monthly_directdebit),performance_data.push(views.monthly_treasure),performance_data.push(views.monthly_donors),performance_data.push(views.monthly_trusts),performance_data.push(views.monthly_online),performance_data.push(views.monthly_general),performance_data.push(views.monthly_donations),performance_data.push(views.monthly_donations_other),performance_data.push(views.monthly_donations_kiosk),performance_data.push(views.monthly_donations_box),performance_data.push(views.monthly_patron),performance_data.push(views.monthly_corporate),performance_data.push(views.transformation_kpis),performance_data.push(views.engagement_kpis),performance_data.push(views.collections_kpis),performance_data.push(views.donations_kiosk),performance_data.push(views.daily_donations_kiosk),performance_data.push(views.donations),performance_data.push(views.donations_other),performance_data.push(views.monthly_welcomedesk),performance_data.push(views.raw_welcomedesk),performance_data.push(views.participation),performance_data.push(views.events),performance_data.push(views.kpi_events),performance_data.push(views.monthly_events),$scope.user_groups.DEVELOPMENT=[],$scope.user_groups.DEVELOPMENT.views=[],$scope.user_groups.DEVELOPMENT.enter_data=[],$scope.user_groups.DEVELOPMENT.resources=[],$scope.user_groups.DEVELOPMENT.views.push(views.masterkpi),$scope.user_groups.DEVELOPMENT.views.push(views.timeline),$scope.user_groups.DEVELOPMENT.views.push(views.analyser),$scope.user_groups.DEVELOPMENT.enter_data=enter_data,$scope.user_groups.DEVELOPMENT.performance=performance_data,$scope.user_groups.DEVELOPMENT.permissions=default_permissions,module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/navigation/development.js","/controllers/navigation")},{b55mWE:4,buffer:3}],193:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){module.exports=function($scope,views){$scope.user_groups.STAFF=[];var signage=[];signage.push(views.posters_list),signage.push(views.add_posters);var resources=[];resources.push(views.rooms),resources.push(views.equipment),resources.push(views.equipment_bookings),resources.push(views.bookings_report),resources.push(views.room_hire),resources.push(views.equipment_booking_timeline);var enter_data=[];enter_data.push(views.performance),enter_data.push(views.record_exhibitions_pwyt),enter_data.push(views.record_events),enter_data.push(views.record_kpi_events),enter_data.push(views.record_venue_hire),enter_data.push(views.record_operations),enter_data.push(views.record_teg);var resources=[],performance_data=[];return performance_data.push(views.teg),performance_data.push(views.raw_visits),performance_data.push(views.monthly_visits),performance_data.push(views.raw_venue_hire),performance_data.push(views.monthly_venue_hire),performance_data.push(views.monthly_retail_sales),performance_data.push(views.monthly_donations),performance_data.push(views.transformation_kpis),performance_data.push(views.engagement_kpis),performance_data.push(views.collections_kpis),performance_data.push(views.raw_exhibitions_pwyt),performance_data.push(views.monthly_teg),performance_data.push(views.events),performance_data.push(views.kpi_events),performance_data.push(views.monthly_events),performance_data.push(views.participation),$scope.user_groups.STAFF.views=[],$scope.user_groups.STAFF.enter_data=[],$scope.user_groups.STAFF.resources=[],$scope.user_groups.STAFF.permissions=default_permissions,$scope.user_groups.STAFF.views.push(views.masterkpi),$scope.user_groups.STAFF.views.push(views.timeline),$scope.user_groups.STAFF.views.push(views.feedback),$scope.user_groups.STAFF.views.push(views.nominate),$scope.user_groups.STAFF.views.push(views.analyser),$scope.user_groups.STAFF.enter_data=enter_data,$scope.user_groups.STAFF.performance=performance_data,$scope.user_groups.STAFF.resources=resources,module}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/navigation/staff.js","/controllers/navigation")},{b55mWE:4,buffer:3}],194:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.TableFilterController=function(getDateService,$location,AuthService,tableFilterService,$scope,$http,get_table_data){$scope.start_date=new Date("2019/04/01"),$scope.end_date=new Date(moment($scope.start_date).add("years",1).format("YYYY/MM/DD")),$scope.end_date.setDate($scope.end_date.getDate()-1),$scope.start=$scope.start_date,$scope.end=$scope.end_date,$scope.$watchGroup(["end","start"],function(newValue,oldValue){getDateService.setDate($scope.start,$scope.end)})}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/controllers/tablefilter-controller.js","/controllers")},{b55mWE:4,buffer:3}],195:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.colourKey=function(){return{controller:"ColourKeycontroller",templateUrl:"./shared/templates/colour_key.html"}},exports.refreshButton=function(){return{controller:"refreshButtonKeycontroller",templateUrl:"./shared/templates/refreshbutton.html"}},exports.tableFilter=function(){return{controller:"TableFilterController",templateUrl:"./shared/templates/table_filter.html"}},exports.userMenu=function(){return{controller:"NavController",templateUrl:"./shared/templates/user_menu.html"}},exports.optionSelect=function(){return{templateUrl:"./shared/templates/option_select.html"}},exports.radioSelect=function(){return{controller:"RadioController",templateUrl:"./shared/templates/radio_select.html"}},exports.optionSelect2=function(){return{templateUrl:"./shared/templates/option_select2.html"}},exports.checkBox=function(){return{templateUrl:"./shared/templates/checkbox.html",replace:!0,scope:{ngModel:"="}}}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/directives.js","/directives")},{b55mWE:4,buffer:3}],196:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){"use strict";var underscore=angular.module("underscore",[]);require("underscore"),require("async");underscore.factory("_",["$window",function($window){return $window._}]);var app=angular.module("app",["ng","ui.select","ngRoute","ngAnimate","ngResource","ngSanitize","angularUtils.directives.dirPagination","underscore","ngScrollbar","ngMaterial","angularGrid","ngSanitize","formly","formlyBootstrap","chart.js","daterangepicker","ngDragDrop","md.data.table","ui.router","ui.grid","ui.bootstrap","ui.grid.selection","ui.grid.exporter","ui.grid.edit","ui.grid.resizeColumns","ui.grid.pinning","ui.grid.autoResize","ngMessages","material.svgAssetsCache","moment-picker"]);require("../shared/app-controllers")(app),require("../shared/app-directives")(app),require("../shared/app-services")(app),require("../shared/app-filters")(app),require("../shared/app-config")(app)}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_31ca5493.js","/")},{"../shared/app-config":183,"../shared/app-controllers":184,"../shared/app-directives":185,"../shared/app-filters":186,"../shared/app-services":187,async:1,b55mWE:4,buffer:3,underscore:7}],197:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){exports.tableFilterService=function(AuthService,$rootScope){return{}},exports.dynamicTableCellFilter_donations_other=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.csstype)return"bold"==row.entity.csstype?"bold":""}}},exports.dynamicTableCellFilter_donations_kiosk=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.csstype)return"bold"==row.entity.csstype?"bold":""}}},exports.dynamicTableCellFilter_donations=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.csstype)return"bold"==row.entity.csstype?"bold":""}}},exports.dynamicTableCellFilter_corporate=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.stat)return"retail"==row.entity.typex?"bold":""}}},exports.dynamicTableCellFilter_retail=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.stat)return"retail"==row.entity.typex?"bold":""}}},exports.dynamicTableCellFilter=function(){return function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity){if(row.entity.csstype)return row.entity.csstype;if(row.entity.stat)return"Summary"==row.entity.stat?"summary_row":"Visits"==row.entity.stat?"bold":""}}},exports.getDateService=function($rootScope){function getDate(){var date=[];return date.push(start_date),date.push(end_date),date}function setDate(start_date,end_date){var date=[];date.push(start_date),date.push(end_date),$rootScope.$broadcast("date:updated",date),start_date=start_date,end_date=end_date}return start_date=new Date("2020/04/01"),end_date=new Date(moment(start_date).add("years",1).format("YYYY/MM/DD")),end_date.setDate(end_date.getDate()-1),{getDate:getDate,setDate:setDate}},exports.data_table_reload=function(){function getDate(){return date}function setDate(newDate){date=newDate}var date=moment().startOf("day")._d;return{getDate:getDate,setDate:setDate}},exports.table_security=function(AuthService,$rootScope){return $rootScope.pageOptions={isView:!1},$rootScope.canEdit=function(){
return $rootScope.pageOptions.isView},$rootScope.isloggedin=!1,AuthService.isLoggedIn().then(function(user){1==$rootScope.canEdit_table&&($rootScope.pageOptions={isView:!0}),$rootScope.isloggedin=!0}),this},exports.get_table_data_team=function($rootScope,data_table_reload){var myScope,array={};return array.filter_x=function(filter_key,filter_value,$scope){console.log("filter_x"),$scope&&(myScope=$scope);var query={team_id:"#",exact:!1};query[filter_key]=filter_value,$scope.extraQuery&&_.extend(query,$scope.extraQuery),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})})},array.getData=function(filterdate,$scope){if($scope&&(myScope=$scope),filterdate){console.log("all dates after",filterdate),console.log(filterdate);var filter_month=moment().month();console.log("filter_month",filter_month),filterdate=moment(filterdate)._d}else{var filter_month=moment().month();filterdate=moment(new Date).subtract({years:1}),filterdate=moment(filterdate)._d,console.log("all dates after",filterdate)}var end_date=$scope.end||new Date;end_date.setDate(end_date.getDate()+1);var query={team_id:"#",date_value:moment(filterdate).format("YYYY-MM-DD"),exact:!1,end_value:end_date};$scope.extraQuery&&_.extend(query,$scope.extraQuery),console.log("query",query),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){if(filterdate){moment(row.date_value).month();moment(row.date_value)._d>=moment(filterdate)._d&&""!=row.team_id&&(console.log("pushing row",row),$scope._rows.push(row))}else console.log("displaying all data"),$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})}),$rootScope.alldata=function(val){if(console.log("alldata"),"month"==val){console.log("show month data");var date=new Date,y=date.getFullYear(),m=date.getMonth(),firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay),array.getData(firstDay,myScope)}else if(val){console.log("show month data");var date=new Date(val),y=date.getFullYear(val),m=date.getMonth(val);console.log("filtering on month",m);var firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay)._d,array.getData(firstDay,myScope)}else console.log("show all data"),array.getData("",myScope)},$rootScope.dynamic_filter=function(filter_key,filter_value){console.log("dynamic_filter"),array.filter_x(filter_key,filter_value,myScope)}},array},exports.get_table_data_nomusem_notype=function($rootScope,data_table_reload){var myScope,array={};return array.filter_x=function(filter_key,filter_value,$scope){$scope&&(myScope=$scope);var query={exact:!1};query[filter_key]=filter_value,$scope.extraQuery&&_.extend(query,$scope.extraQuery),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})})},array.getData=function(filterdate,$scope){if(console.log("getData"),console.log("filterdate",filterdate),$scope&&(myScope=$scope),filterdate){console.log("all dates after",filterdate),console.log(filterdate);var filter_month=moment().month();console.log("filter_month",filter_month),filterdate=moment(filterdate)._d}else{var filter_month=moment().month();filterdate=moment(new Date).subtract({years:1}),filterdate=moment(filterdate)._d,console.log("all dates after",filterdate)}var query={date_value:moment(filterdate).format("YYYY-MM-DD"),exact:!1,end_value:moment($scope.end).format("YYYY-MM-DD")};$scope.extraQuery&&_.extend(query,$scope.extraQuery),console.log("query",query),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){if(filterdate){moment(row.date_value).month();moment(row.date_value)._d>=moment(filterdate)._d&&""!=row.museum_id&&$scope._rows.push(row)}else console.log("displaying all data"),$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})}),$rootScope.alldata=function(val){if("month"==val){console.log("show month data");var date=new Date,y=date.getFullYear(),m=date.getMonth(),firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay),array.getData(firstDay,myScope)}else if(val){console.log("show month data",myScope.start);var date=new Date(val),y=date.getFullYear(val),m=date.getMonth(val);console.log("filtering on month",m);var firstDay=new Date(myScope.start);new Date(myScope.end);firstDay=moment(firstDay)._d,array.getData(firstDay,myScope)}else console.log("show all data"),array.getData("",myScope)},$rootScope.dynamic_filter=function(filter_key,filter_value){array.filter_x(filter_key,filter_value,myScope)}},array},exports.get_table_data_nomusem=function($rootScope,data_table_reload){var myScope,array={};return array.filter_x=function(filter_key,filter_value,$scope){$scope&&(myScope=$scope);var query={type:"#",exact:!1};query[filter_key]=filter_value,$scope.extraQuery&&_.extend(query,$scope.extraQuery),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})})},array.getData=function(filterdate,$scope){if(console.log("getData"),console.log("filterdate",filterdate),$scope&&(myScope=$scope),filterdate){console.log("all dates after",filterdate),console.log(filterdate);var filter_month=moment().month();console.log("filter_month",filter_month),filterdate=moment(filterdate)._d}else{var filter_month=moment().month();filterdate=moment(new Date).subtract({years:1}),filterdate=moment(filterdate)._d,console.log("all dates after",filterdate)}var query={type:"#",date_value:moment(filterdate).format("YYYY-MM-DD"),exact:!1,end_value:moment($scope.end).format("YYYY-MM-DD")};$scope.extraQuery&&_.extend(query,$scope.extraQuery),console.log("query",query),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){if(filterdate){moment(row.date_value).month();moment(row.date_value)._d>=moment(filterdate)._d&&""!=row.museum_id&&$scope._rows.push(row)}else console.log("displaying all data"),$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})}),$rootScope.alldata=function(val){if("month"==val){console.log("show month data");var date=new Date,y=date.getFullYear(),m=date.getMonth(),firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay),array.getData(firstDay,myScope)}else if(val){console.log("show month data",myScope.start);var date=new Date(val),y=date.getFullYear(val),m=date.getMonth(val);console.log("filtering on month",m);var firstDay=new Date(myScope.start);new Date(myScope.end);firstDay=moment(firstDay)._d,array.getData(firstDay,myScope)}else console.log("show all data"),array.getData("",myScope)},$rootScope.dynamic_filter=function(filter_key,filter_value){array.filter_x(filter_key,filter_value,myScope)}},array},exports.get_table_data=function($rootScope,data_table_reload){var myScope,array={};return array.filter_x=function(filter_key,filter_value,$scope){$scope&&(myScope=$scope);var query={museum_id:"#",exact:!1};query[filter_key]=filter_value,$scope.extraQuery&&_.extend(query,$scope.extraQuery),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})})},array.getData=function(filterdate,$scope){if(console.log("getData"),console.log("filterdate",filterdate),$scope&&(myScope=$scope),filterdate){console.log("all dates after",filterdate),console.log(filterdate);var filter_month=moment().month();console.log("filter_month",filter_month),filterdate=moment(filterdate)._d}else{var filter_month=moment().month();filterdate=moment(new Date).subtract({years:1}),filterdate=moment(filterdate)._d,console.log("all dates after",filterdate)}var query={museum_id:"#",date_value:moment(filterdate).format("YYYY-MM-DD"),exact:!1,end_value:moment($scope.end).format("YYYY-MM-DD")};$scope.extraQuery&&_.extend(query,$scope.extraQuery),console.log("query",query),$rootScope.featured_collection.query(query,function(team){$scope.rows=[],$scope._rows=[],console.log("filtering "+team.length+" results"),_.each(team,function(row){if(filterdate){moment(row.date_value).month();moment(row.date_value)._d>=moment(filterdate)._d&&""!=row.museum_id&&$scope._rows.push(row)}else console.log("displaying all data"),$scope._rows.push(row)}),$scope.gridOptions.data.length=0,angular.forEach($scope._rows,function(row){$scope.gridOptions.data.push(row)}),$scope.$watch(function(){return data_table_reload.getDate()},function(value){})}),$rootScope.alldata=function(val){if("month"==val){console.log("show month data");var date=new Date,y=date.getFullYear(),m=date.getMonth(),firstDay=new Date(y,m,1);new Date(y,m+1,0);firstDay=moment(firstDay),array.getData(firstDay,myScope)}else if(val){console.log("show month data",myScope.start);var date=new Date(val),y=date.getFullYear(val),m=date.getMonth(val);console.log("filtering on month",m);var firstDay=new Date(myScope.start);new Date(myScope.end);firstDay=moment(firstDay)._d,array.getData(firstDay,myScope)}else console.log("show all data"),array.getData("",myScope)},$rootScope.dynamic_filter=function(filter_key,filter_value){array.filter_x(filter_key,filter_value,myScope)}},array},exports.grid_ui_settings=function(AuthService){var array={};return array.monthly=function(columns,scope){return scope.isloggedin=!1,AuthService.isLoggedIn().then(function(user){scope.isloggedin=!0}),{columnDefs:columns,enableFiltering:!0,enableCellEdit:!0,cellEditableCondition:scope.canEdit,enableGridMenu:!0,enableSelectAll:!0,enableCellSelection:!1,enableCellEditOnFocus:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){scope.gridApi=gridApi,gridApi.edit.on.afterCellEdit(scope,function(rowEntity,colDef,newValue,oldValue){1!=scope.isloggedin&&alert("you'll need to log in to make these changes");var update=[],key1=colDef.field,obj1={};obj1[key1]=newValue,update.push(obj1);var key2="logger_user_name",obj2={};obj2[key2]=scope.user.username,update.push(obj2);var key3="date_logged",obj3={};obj3[key3]=new Date;var key4="requested_by",obj4={};obj4[key4]=rowEntity.requested_by,update.push(obj3),setupArray=_.extend(obj1,obj2),setupArray=_.extend(setupArray,obj3),setupArray=_.extend(setupArray,obj4);var query={id:rowEntity._id};scope.featured_collection.update(query,setupArray,function(err,affected,resp){scope.changed++})})}}},array},exports.weekly_data_table_columns=function(){var array={};return array.build=function(scope,start_date,end_date){var columns=[];for(start=moment(start_date).year(),end=moment(end_date).year(),year=start;year<=end;year++)for(week=0;week<moment().isoWeeksInYear();week++)axisDate=moment().day("Monday").year(year),axisDate._d>=moment(start_date)&&axisDate._d<=moment(end_date)&&(console.log(moment(start_date)),columns.push({field:axisDate.week(week).format("DD/MM/YY"),name:axisDate.week(week).format("DD/MM/YY"),width:"80"}));return columns},array},exports.yearly_data_table_columns=function(){var array={};return array.build=function(scope,start_date,end_date){var columns=[];for(start=moment(start_date).year(),end=moment(end_date).year(),year=start;year<=end;year++){var financial_yesr_text=["last","this"];_.each(financial_yesr_text,function(financial_yer_text){var financial_year_display="";financial_year_display="this"==financial_yer_text?year+"-"+(year+1).toString().substring(2):year-1+"-"+year.toString().substring(2),columns.push({field:financial_year_display,name:financial_year_display,width:"80"}),scope.filter_pie.push({value:financial_year_display,name:financial_year_display})})}return columns},array},exports.vertical_monthly_data_table_columns=function(){var array={};return array.build=function(scope,start_date,end_date){var columns=[];for(start=moment(start_date).year(),end=moment(end_date).year(),year=start;year<=end;year++)_.each(scope.data_columns,function(column_name){columns.push({field:column_name,width:"80"})});return columns},array},exports.monthly_data_table_columns_retail=function(){var array={};return array.build=function(scope,start_date,end_date){var columns=[];const monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];start=moment(start_date).year(),end=moment(end_date).year(),start_month=moment(start_date).month(),end_month=moment(end_date).month();var firstrun=!0;for(year=start;year<=end;year++)month_num=0,_.each(moment.monthsShort(),function(month){month_num++,4==month_num&&columns.push({cellFilter:"valueFilter:row.entity",field:"Total "+year,width:"100",cellClass:function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity[col.colDef.field]){if("function"==typeof row.entity[col.colDef.field].indexOf&&row.entity[col.colDef.field].indexOf("-")!=-1)return"red";if(row.entity&&row.entity.csstype)return row.entity.csstype}}}),console.log("start_month",start_month),console.log("monthNames.indexOf(month)",monthNames.indexOf(month)),console.log(year==end&&month_num>monthNames.indexOf(month)),1==firstrun&&month!=monthNames[start_month]||year==end&&month_num>start_month||(columns.push({cellFilter:"valueFilter_retail:row.entity",field:month+" "+year,name:month+" "+year.toString().substring(2),width:"100",cellClass:function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity[col.colDef.field]&&"function"==typeof row.entity[col.colDef.field].indexOf&&row.entity[col.colDef.field].indexOf("-")!=-1)return"red";if(row.entity){if(row.entity.csstype)return row.entity.csstype}else if(row.entity.stat&&"retail"==row.entity.typex)return"bold";return row.entity.xtype&&"donations"==row.entity.xtype?"bold":void 0}}),scope.filter_pie.push({value:month+" "+year,name:month+" "+year}),firstrun=!1)});return columns},array},exports.yearly_percentage_difference=function(){var array={};return array.build=function(scope){_.each(scope._rows,function(row,i){var new_row={};if(new_row.museum="% difference",new_row.typex="retail",new_row.xtype="currency",new_row.cssclass="summary_row",new_row.csstype="summary_row",console.log("new_row",row),"Total"==row.museum||"Income - total"==row.museum){for(var key in row)_.each(scope._rows,function(rowX){for(var keyX in rowX)"Last year"==rowX.museum&&key==keyX&&row[key]>0&&rowX[keyX]>0&&(percantage=(row[key]/rowX[keyX]*100-100).toFixed(2)+"%",new_row[key]=percantage,console.log("new_row",new_row))});scope._rows.push(new_row)}})},array},exports.yearly_totals=function(){var array={};return array.build=function(scope){_.each(scope._rows,function(row,i){if("Running total"!=row.museum&&"Last Year"!=row.museum&&"Yearly Total"!=row.stat){start=moment(scope.start_date).year()-2,end=moment(scope.end_date).year()+1,start_month=moment(scope.start_date).month(),end_month=moment(scope.end_date).month();for(year=start;year<=end;year++){month_num=0;_.each(moment.monthsShort(),function(month){month_num++,row[month+" "+year]&&(month_num<4&&(scope._rows[i]["Total "+parseInt(year)]||(scope._rows[i]["Total "+parseInt(year)]=0),row[month+" "+parseInt(year)]&&(scope._rows[i]["Total "+(parseInt(year)-1)]+=parseInt(row[month+" "+parseInt(year)]))),4==month_num&&(scope._rows[i]["Total "+parseInt(year)]||(scope._rows[i]["Total "+parseInt(year)]=0),row[month+" "+parseInt(year)]&&(scope._rows[i]["Total "+parseInt(year)]=parseInt(row[month+" "+parseInt(year)]))),month_num>4&&(scope._rows[i]["Total "+parseInt(year)]||(scope._rows[i]["Total "+parseInt(year)]=0),row[month+" "+parseInt(year)]&&(scope._rows[i]["Total "+parseInt(year)]+=parseInt(row[month+" "+parseInt(year)]))))}),row.stat==row.museum+" Net sales"&&(top=scope._rows[i]["Total "+(parseInt(year)-1)]),"last year"==row.stat&&(bottom=scope._rows[i]["Total "+(parseInt(year)-1)]),"% last year"==row.stat&&(scope._rows[i]["Total "+(parseInt(year)-1)]=(top/bottom*100-100).toFixed(2)+"%",console.log("top="+top),console.log("bottom="+bottom))}}})},array},exports.monthly_data_table_columns=function(){var array={};return array.build=function(scope,start_date,end_date){var columns=[];const monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];start=moment(start_date).year(),end=moment(end_date).year(),start_month=moment(start_date).month(),end_month=moment(end_date).month();var firstrun=!0;for(year=start;year<=end;year++)month_num=0,_.each(moment.monthsShort(),function(month){month_num++,4==month_num&&columns.push({cellFilter:"valueFilter:row.entity",field:"Total "+year,width:"100",cellClass:function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity[col.colDef.field]){if("function"==typeof row.entity[col.colDef.field].indexOf&&row.entity[col.colDef.field].indexOf("-")!=-1)return"red";if(row.entity&&row.entity.csstype)return row.entity.csstype}}}),1==firstrun&&month!=monthNames[start_month]||year==end&&month_num>start_month||(columns.push({cellFilter:"valueFilter:row.entity",field:month+" "+year,name:month+" "+year.toString().substring(2),width:"100",cellClass:function(grid,row,col,rowRenderIndex,colRenderIndex){if(row.entity[col.colDef.field]){if("function"==typeof row.entity[col.colDef.field].indexOf&&row.entity[col.colDef.field].indexOf("-")!=-1)return"red";if(row.entity&&row.entity.csstype)return row.entity.csstype}}}),scope.filter_pie.push({value:month+" "+year,name:month+" "+year}),firstrun=!1)});return columns},array},exports.make_a_line_chart=function(){var line={};return line.build=function(scope,columnDefs,data_values,label_values){var statistics_to_plot=[];"string"!=typeof scope.selected_chart_stats?(console.log("statistics_to_plot",statistics_to_plot),statistics_to_plot=scope.selected_chart_stats):statistics_to_plot.push(scope.selected_chart_stats),scope.series_a=[];var line_data=scope._rows;scope.data_rows.length>0&&(console.log("go line_data"),line_data=scope.data_rows),scope.line_series=[];var axis_decider;_.each(statistics_to_plot,function(label_value){axis_decider=0,scope.line_labels=[],_.each(line_data,function(row){scope.selected_museums&&scope.selected_museums.indexOf(row[data_values])==-1||_.each(columnDefs,function(column){scope.line_labels.indexOf(column.name)==-1&&scope.line_labels.push(column.name),line_chart_series_labels=row[data_values]+" "+label_value,scope.line_series.indexOf(line_chart_series_labels)==-1&&(line_data[line_chart_series_labels]=[],scope.line_series.push(line_chart_series_labels)),console.log("axis_decider",axis_decider),row.stat==label_value&&(axis_decider<=row[column.field]&&(axis_decider=row[column.field]),line_data[line_chart_series_labels].push(row[column.field]))})}),axis_decider>scope.axis_threshhold?(line_data[line_chart_series_labels].yAxisID="A",console.log("A")):(console.log("B"),line_data[line_chart_series_labels].yAxisID="B")}),scope.line_data=[],_.each(scope.line_series,function(data_set){scope.line_data.push(line_data[data_set])}),scope.datasetOverride=[{yAxisID:"A"},{yAxisID:"B"}],scope.line_options={scales:{yAxes:[{id:"A",type:"linear",position:"left"},{id:"B",type:"linear",position:"right"}]},legend:{display:!0},tooltips:{enabled:!0},scaleFontColor:"#8a6666",fillColor:"#E7EDF0",strokeColor:"#A9C4D2"},scope.colors=["#023fa5","#7d87b9","#bec1d4","#d6bcc0","#bb7784","#8e063b","#4a6fe3","#8595e1","#b5bbe3","#e6afb9","#e07b91","#d33f6a","#11c638","#8dd593","#c6dec7","#ead3c6","#f0b98d","#ef9708","#0fcfc0","#9cded6","#d5eae7","#f3e1eb","#f6c4e1","#f79cd4"]},line},exports.make_a_pie=function($rootScope){var pie={};return pie.build=function(scope,data_values,label_values){console.log("go"),scope.series_a=[],scope.pie_data=[],scope.pie_labels=[];var line_data=scope._rows;scope.data_rows.length>0&&(console.log("go line_data"),line_data=scope.data_rows),_.each(line_data,function(row){row[data_values]>0&&(scope.series_a.push(row[data_values]),scope.pie_labels.indexOf(row[label_values])==-1&&(scope.pie_labels.push(row[label_values]),scope.pie_data.push(scope.series_a)))}),scope.labels=scope.pie_labels,scope.data=scope.series_a,scope.options={legend:{display:!0},tooltips:{enabled:!0}},scope.colors=["#023fa5","#7d87b9","#bec1d4","#d6bcc0","#bb7784","#8e063b","#4a6fe3","#8595e1","#b5bbe3","#e6afb9","#e07b91","#d33f6a","#11c638","#8dd593","#c6dec7","#ead3c6","#f0b98d","#ef9708","#0fcfc0","#9cded6","#d5eae7","#f3e1eb","#f6c4e1","#f79cd4"]},pie},exports.date_calc=function($http){var date_calc={},secondDate=(new Date(2008,1,12),new Date);return date_calc.diffDays=function(firstDate){var firstDate=new Date(firstDate);return secondDate.getMonth()-firstDate.getMonth()+12*(secondDate.getFullYear()-firstDate.getFullYear())},date_calc},exports.trello=function($http){var trello={};return trello.auth=function(){var authenticationSuccess=function(){console.log("sucessful authentication");Trello.token();window.location.replace(decodeURIComponent(window.location.hash)),console.log("Successful authentication")},authenticationFailure=function(){alert("Failed authentication")};Trello.authorize({type:"redirect",name:"Bristol Culture Trello Monitor",scope:{read:"true",write:"true"},expiration:"never",success:authenticationSuccess,error:authenticationFailure})},trello},exports.get_trello_board=function(Team,Tallys,date_calc,$http,$rootScope){console.log("get_trello_board");var trello=[];return trello.get_data=function(listx){return Trello.get("lists/"+listx.id+"/cards",function(cards){var list=[];list._cards=[],tally=0,card_count=0,angular.forEach(cards,function(card,index){card_count++,card_to_print={name:card.name,tint:1-date_calc.diffDays(card.dateLastActivity)/10,age:date_calc.diffDays(card.dateLastActivity).toString(),dateLastActivity:card.dateLastActivity},tally+=date_calc.diffDays(card.dateLastActivity),list._cards.push(card_to_print)}),list.average=(tally/card_count).toFixed(2),list.tint=list.average/100,list.card_count=card_count,list.points=(card_count/(list.average/1+1)).toFixed(2),Team.query({},function(_team){_.each(_team,function(row){if(row.name==listx.title){var tally=new Tallys({name:listx.title,date:new Date,points:list.points});tally.$save();var team=Team.get({id:row._id});team.name=list.title,team.score=list.points,team.card_count=list.card_count,team.bonus="",teampenalty=list.average,$id=row._id,Team.update({id:$id},team),$rootScope.message="update"}})}),console.log("end of service")}).then(function(response){return response})},trello},exports.detect_dragging=function($rootScope){var detect_dragging=[];$rootScope.isDragging=!1;var currentPos=[];return detect_dragging.drag_handler=function(){$("md-content").on("mousedown",function(evt){currentPos=[evt.pageX,evt.pageY],$("md-content").on("mousemove",function handler(evt){currentPos=[evt.pageX,evt.pageY],$("#content-scroller").off("mousemove",handler)}),$("md-content").on("mouseup",function handler(evt){evt.pageX+evt.pageY==currentPos[0]+currentPos[1]?(console.log("clicking"),$rootScope.isDragging=!1):($rootScope.isDragging=!0,console.log("dragging")),$("md-content").off("mouseup",handler)})})},detect_dragging},exports.screen_saver_loop=function($rootScope,$location,$interval,Team){function switchview(i){var videoElement=$("iframe").contents().find("video").get(0);if(!audioplayer)var audioplayer="";audioplayer.paused;(videoElement&&!videoElement.paused||audioplayer)&&1!=audioplayer.paused?console.log("video playing..cancel"):($rootScope.updateInterval,console.log(i),i>=screensaver.length&&(i=0,$rootScope.i=0),$location.path(currentView[$rootScope.i]),$rootScope.i++)}var sharedService={},team_list=[],support_list=[],roadmap_list=[],list=[];list.title="BMAG DIGITAL SUPPORT",list.id="56051e0244bb2e4efc9e6e99",support_list.push(list);var list=[];list.title="MSHED DIGITAL SUPPORT",list.id="562667caadda958dad274f22",support_list.push(list);var list=[];list.title="ZAHID",list.id="5257d4e719e0ee3b5800009c",team_list.push(list);var list=[];list.title="DARREN",list.id="55cdc7672fff3ffc946f6e94",team_list.push(list);var list=[];list.title="TOM",list.id="563234399bfcf125dc06f03b",team_list.push(list);var list=[];list.title="LACEY",list.id="57f3b32311fbe4f9966de748",team_list.push(list);var list=[];list.title="FAY",list.id="53344421ba92789d64cf8f99",team_list.push(list);var list=[];list.title="MARK",list.id="5790fb082acddb2d98c04826",team_list.push(list);var list=[];list.title="DAVID",list.id="52c3f521160978433b073a9b",team_list.push(list);var list=[];list.title="Q3",list.id="5763ca5d82c12dc42e874e0a",roadmap_list.push(list);var list=[];list.title="Q4",list.id="5763ca6c8981e9d4c9da0e23",roadmap_list.push(list),$rootScope.team=team_list,$rootScope.support=support_list,$rootScope.roadmap=roadmap_list;var currentView=["/a/team","/a/support","/a/roadmap","/board"];$rootScope.i=0;return sharedService.start_screen_saver=function(){$interval.cancel($rootScope.timer),"/screen_saver_images"!=$location.path()&&($rootScope.screensaver_on=!0,$rootScope.timer=$interval(function(){switchview($rootScope.i)},3e5))},sharedService.screensaverOff=function(){$rootScope.screensaver_on=!1,$interval.cancel($rootScope.timer),console.log("screensaver off")},sharedService}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/services/app-services.js","/services")},{b55mWE:4,buffer:3}],198:[function(require,module,exports){(function(process,global,Buffer,__argument0,__argument1,__argument2,__argument3,__filename,__dirname){require("http-status");exports.Monthly_products_published=function($resource){return $resource("/shopify_product/monthly",{},{openGates:{method:"GET",isArray:!0}})},exports.Customers_giftaid=function($resource){return $resource("/customergiftaid",{},{getData:{method:"GET",isArray:!0}})},exports.Event_names=function($resource){return $resource("/events/event_names",{},{getData:{method:"GET",isArray:!0}})},exports.Monthly_products_sold_online=function($resource){return $resource("/shopify_transactions/monthly",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_learning=function($resource){return $resource("/learning/total/:session_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_operations=function($resource){return $resource("/operations/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_operations=function($resource){return $resource("/operations/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_visits=function($resource){return $resource("/kpi_aggregate/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_venue_hire=function($resource){return $resource("/venue_hire/total/:booking_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_visits=function($resource){return $resource("/kpi_aggregate/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_venue_hire=function($resource){return $resource("/venue_hire/all/:booking_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_visits=function($resource){return $resource("/kpi_aggregate/week",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_venue_hire=function($resource){return $resource("/venue_hire/week/:booking_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_events=function($resource){return $resource("/events/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_kpi_events=function($resource){return $resource("/kpi_events/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_events=function($resource){return $resource("/events/all/:event_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_standard_kpi_events=function($resource){return $resource("/kpi_events/ally/:team_id",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_kpi_events=function($resource){return $resource("/kpi_events/allx/:team_id",{},{openGates:{method:"GET",isArray:!0}})},exports.Target_audience_event_count=function($resource){return $resource("/events/priority_groups",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_community_groups=function($resource){return $resource("/events/community_groups",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_welcomedesk=function($resource){return $resource("/welcomedesk/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_welcomedesk=function($resource){return $resource("/welcomedesk/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_welcomedesk=function($resource){return $resource("/welcomedesk/weekly",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_exhibitions_pwyt=function($resource){return $resource("/exhibitions_pwyt/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_teg=function($resource){return $resource("/gallery_visits/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Exhibitions_teg=function($resource){return $resource("/gallery_visits/exhibition",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_teg=function($resource){return $resource("/gallery_visits/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_teg=function($resource){return $resource("/gallery_visits/week",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_retail_sales=function($resource){return $resource("/retail_sales/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_retail_sales=function($resource){return $resource("/retail_sales/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_retail_sales=function($resource){return $resource("/retail_sales/week",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_all_giftaid=function($resource){return $resource("/allgiftaid/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_giftaid=function($resource){return $resource("/giftaid/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_donations_treasure=function($resource){return $resource("/treasure/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_treasure=function($resource){return $resource("/treasure/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Monthly_donations_donors=function($resource){return $resource("/majordonor/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_donors=function($resource){return $resource("/majordonor/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"
},"delete":{method:"DELETE"}})},exports.Monthly_donations_online=function($resource){return $resource("/online/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_online=function($resource){return $resource("/online/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Monthly_donations_general=function($resource){return $resource("/donations_general/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_general=function($resource){return $resource("/donations_general/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Monthly_donations_trusts=function($resource){return $resource("/trusts/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_trusts=function($resource){return $resource("/trusts/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Monthly_donations_directdebit=function($resource){return $resource("/directdebit/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Raw_donations_directdebit=function($resource){return $resource("/directdebit/:id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Yearly_donations_other=function($resource){return $resource("/donations-other/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_donations_other=function($resource){return $resource("/donations-other/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_donations_boxes=function($resource){return $resource("/donations-box/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_donations_kiosk=function($resource){return $resource("/donations-kiosk/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Daily_donations_kiosk=function($resource){return $resource("/donations-kiosk/day",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_donations=function($resource){return $resource("/donations/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_donations=function($resource){return $resource("/donations/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_patron=function($resource){return $resource("/patron/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_patron=function($resource){return $resource("/patron/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_corporate=function($resource){return $resource("/corporate/total",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_corporate=function($resource){return $resource("/corporate/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_site_permissions=function($resource){return $resource("/site-permissions/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Weekly_donations=function($resource){return $resource("/donations/weekly",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_learning=function($resource){return $resource("/learning/all/:session_type",{},{openGates:{method:"GET",isArray:!0}})},exports.Age_learning=function($resource){return $resource("/learning/age",{},{openGates:{method:"GET",isArray:!0}})},exports.Yearly_bookings=function($resource){return $resource("/bookings/year",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_bookings=function($resource){return $resource("/bookings/all",{},{openGates:{method:"GET",isArray:!0}})},exports.Monthly_turnstiles=function($resource){return $resource("/turnstiles_logging/all",{},{openGates:{method:"GET",isArray:!0}})},exports.turnstile_app=function($resource){return $resource("/open_turnstile",{},{openGates:{method:"GET",isArray:!0}})},exports.Shopify_monthly_report=function($resource){return $resource("/shopify_monthy_products/:shop_id/:year/:month",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Bristol_music_top_40=function($resource){return $resource("/top_40/:id/:museum_id/:date_value/:on_site_off_site/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_kpi_events=function($resource){return $resource("/kpi_events/:id/:team_id/:kpi_type/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_events=function($resource){return $resource("/events/:id/:museum_id/:date_value/:on_site_off_site/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.get_team_kpis=function($resource){return $resource("kpi_events",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.get_kpis=function($resource){return $resource("kpi_aggregate/kpis",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.send_confirmation_email=function($resource){return $resource("confirmation",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_welcomedesk=function($resource){return $resource("/welcomedesk/:id/:museum_id/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Posters=function($resource){return $resource("/posters/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Resources=function($resource){return $resource("/resources/:id/:name/:type/:date_value/:exact/:museum_id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Bookings=function($resource){return $resource("/bookings/:id/:group/:start_date/:end_date/:_type",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_operations=function($resource){return $resource("/operations/:id/:museum_id/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_teg=function($resource){return $resource("/gallery_visits/:id/:museum_id/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.day_turnstiles=function($resource){return $resource("/turnstiles_logging/daily",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_Bristol_music_top_40=function($resource){return $resource("/top_40/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_turnstiles=function($resource){return $resource("/turnstiles_logging/:id/:museum_id/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_visits=function($resource){return $resource("/raw_visits/:id/:museum_id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_venue_hire=function($resource){return $resource("/venue_hire/:id/:museum_id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_giftaid=function($resource){return $resource("/giftaid/:id/:museum_id/:date_value/:exact",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Retail_sales=function($resource){return $resource("/retail_sales/:id/:museum_id/:date_value/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_exhibitions_pwyt=function($resource){return $resource("/exhibitions_pwyt/:id/:museum_id/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_donations=function($resource){return $resource("/donations/:id/:museum_id/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_site_permissions=function($resource){return $resource("/site-permissions/:id/:type/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_donations_other=function($resource){return $resource("/donations-other/:id/:museum_id/:date_value/:type/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_donations_kiosk=function($resource){return $resource("/donations-kiosk/:id/:museum_id/:date_value/:type/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_nominate=function($resource){return $resource("/nominate/:id/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_feedback=function($resource){return $resource("/feedback/:id/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_corporate=function($resource){return $resource("/corporate/:id/:type/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_patron=function($resource){return $resource("/patron/:id/:type/:date_value/:donation_box_no/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Raw_learning=function($resource){return $resource("/learning/:id/:museum_id/:date_value/:session_type/:age_group/:exact/:end_value",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.check_com_port=function($resource){return $resource("/check_com_port/test",null,{get:{method:"GET",isArray:!0},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.check_ticket_database=function($resource){return $resource("/check_ticket_database/test",null,{get:{method:"GET",isArray:!0},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.check_ticket_file=function($resource){return $resource("/check_ticket_file/test",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET"},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.shopify_app_test=function($resource){return $resource("/shopify_product_status_app/test",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET"},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.shopify_app=function($resource){return $resource("/shopify_product_status_app",{},{getData:{method:"GET",isArray:!0}})},exports.AuthService=function($http){var currentUser;return{login:function(){},logout:function(){},isLoggedIn:function(){return $http.get("/user_data")},currentUser:function(){$http.get("/user_data").then(function(result){currentUser=result})}}},exports.Top_40_tally=function($resource){return $resource("/top_40/tally/:exhibition_id",null,{update:{method:"PUT"}})},exports.Tallys=function($resource){return $resource("/tallys/:id",null,{update:{method:"PUT"}})},exports.Timeline=function($resource){return $resource("/timeline/:id",null,{update:{method:"PUT"}})},exports.delete_leave_by_id=function(Team,$rootScope){var delete_leave_by_id={};return delete_leave_by_id._delete=function(leave_id){ids_to_delete=[],ids_to_delete.push(leave_id),Team.query({},function(team){_.each(team,function(_team,i){console.log("before",team[i].leave_taken),new_leave=[],new_ids=[],_.each(team[i].leave_taken,function(leave_me,index){ids_to_delete.indexOf(leave_me._id)==-1&&new_ids.indexOf(leave_me._id)==-1&&(new_leave.push(leave_me),new_ids.push(leave_me._id))}),team[i].leave_taken=new_leave,console.log("after",team[i].leave_taken),Team.update({id:_team._id},team[i]),$rootScope.me_Data=team[i]})})},delete_leave_by_id},exports.Community_groups=function($resource){return $resource("/events/community_groups",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Tech_support=function($resource){return $resource("/tech_support/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.log_messages=function($resource){return $resource("/logging_messages/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Leave=function($resource){return $resource("/leave/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Shopify_aggregate=function($resource){return $resource("/shopify_aggregate/:id",null,{get:{method:"GET"}})},exports.Timeline_data=function($resource){return $resource("/timeline_data_settings/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Timeline=function($resource){return $resource("/timeline/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Emu_events=function($http){var getData=function(){return console.log("getting events"),$http.get("/assets/data/all_events.JSON").then(function(response){return response.data.events})};return{getData:getData}},exports.Team=function($resource){return $resource("/team/:id",null,{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"},"delete":{method:"DELETE"}})},exports.Todos=function($resource){return $resource("/todos/:id",null,{update:{method:"PUT"}})},exports.CustomerService=function($filter){var service={},countrylist=[{id:1,country:"The Wurzels",state:"Alaska"},{id:2,country:"Body Harvest",state:"Hierarchy of Grief"},{id:3,country:"Babyhead",state:"Babyhead song 1"},{id:3,country:"Babyhead",state:"Babyhead song 2"}],statelist=[{id:1,country:"The Wurzels",state:"Alaska"},{id:2,country:"Body Harvest",state:"Hierarchy of Grief"},{id:3,country:"Babyhead",state:"Babyhead song 1"},{id:3,country:"Babyhead",state:"Babyhead song 2"}],citylist=[{Id:1,city:"Anchorage",stateId:1},{Id:2,city:"Fairbanks",stateId:1}];return service.getCountry=function(){return uniquelist=[],countries=[],_.each(countrylist,function(country){countries.indexOf(country.country)==-1&&(countries.push(country.country),uniquelist.push(country),console.log("cheese",countries))}),uniquelist},service.getCountryState=function(country){var states=$filter("filter")(statelist,{country:country});return states},service.getStateCity=function(stateId){var items=$filter("filter")(citylist,{stateId:stateId});return items},service}}).call(this,require("b55mWE"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/services/data-services.js","/services")},{b55mWE:4,buffer:3,"http-status":5}]},{},[196]);